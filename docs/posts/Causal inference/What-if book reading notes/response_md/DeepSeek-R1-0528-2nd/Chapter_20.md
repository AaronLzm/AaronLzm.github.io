---
title: Chapter_20
category: Causal inference
tags: [DeepSeek-R1-0528-2nd,response_md]

---
<think>
我们正在处理《因果推断：What If》第20章的内容。本章标题为“TREATMENT-CONFOUNDER FEEDBACK”。根据提供的文本，我们将按照章节结构逐步总结，提炼技术重点和细节要点。

 本章结构：
 20.1 The elements of treatment-confounder feedback
 20.2 The bias of traditional methods
 20.3 Why traditional methods fail
 20.4 Why traditional methods cannot be fixed
 20.5 Adjusting for past treatment

 此外，还有两个技术点（Fine Point 20.1和Technical Point 20.1）以及多个图表（图20.1至20.10），但文本中未提供图像内容，因此我们将基于文本描述总结图中信息。

 注意：所有总结必须严格基于原文，不添加主观推测。

 开始总结：
</think>
### 第20章 治疗-混杂因素反馈

#### 20.1 治疗-混杂因素反馈的要素
**技术重点（Technical Points）**：
- **核心理论**：治疗-混杂因素反馈指时间依赖性混杂因素$L_k$既影响后续治疗$A_k$，又受先前治疗$A_{k-1}$影响的循环结构（$A_{k-1} \to L_k \to A_k$）。这种反馈导致传统调整方法（如分层、回归）产生偏倚。
- **关键概念**：
  - 时间依赖性混杂：$L_k$是随时间变化的混杂因素，需调整以识别因果效应。
  - 反馈循环：通过离散时间的有向无环图（DAG）表示（如Figure 20.1），其中时间被离散化为区间（如月/天）。
  - 无反馈混杂：Figure 20.2展示无反馈的时间依赖性混杂（$L_k$不受$A_{k-1}$影响）。
- **应用场景**：在HIV治疗研究中，CD4细胞计数$L_k$受前月治疗$A_{k-1}$影响，同时影响当月治疗$A_k$的决策。

**细节要点（Fine Points）**：
- **图示说明**：Figure 20.3简化了反馈结构（两时间点），假设$A_0$边际随机化、$A_1$依$L_1$条件随机化，且无治疗效应（sharp null成立）。
- **反馈表示**：非循环图通过时间离散化表示反馈循环（Fine Point 20.1），实际应用中时间间隔粒度需匹配数据采集频率（如月度）。

---

#### 20.2 传统方法的偏倚
**技术重点（Technical Points）**：
- **核心问题**：当存在治疗-混杂反馈时，传统方法（分层、回归、匹配）无法无偏估计因果效应，即使满足序贯可交换性。
- **关键公式**：在Figure 20.3的零效应场景下，真实因果效应为$E[Y^{a_0=1,a_1=1}] - E[Y^{a_0=0,a_1=0}] = 0$，但传统方法估计值非零。
- **应用场景**：序贯随机试验（如Table 20.1的HIV数据），其中$L_1$$是唯一混杂因素。

**细节要点（Fine Points）**：
- **数据示例**：Table 20.1显示32,000名HIV患者数据，$A_0$随机分配，$A_1$依$L_1$随机化。分层分析中，"始终治疗" vs "永不治疗"的效应估计为-8（应为0），证明偏倚存在。
- **g-零定理**：若sharp null成立，则$Y \perp\!\!\!\perp A_0 \mid L_0$且$Y \perp\!\!\!\perp A_1 \mid A_0, L_1$（Technical Point 20.1）。

---

#### 20.3 传统方法失败的原因
**技术重点（Technical Points）**：
- **核心机制**：对受先前治疗影响的混杂因素$L_1$分层时，$L_1$成为碰撞点（collider），打开非因果路径（如$A_0 \to L_1 \leftarrow U_1 \to Y$），引入选择偏倚。
- **关键概念**：
  - 碰撞点偏倚：调整$L_1$在反馈场景中诱导$A_0$与未测量变量$U_1$的关联（Figure 20.5）。
  - 偏倚方向：消除$A_1$混杂的代价是引入$A_0$的选择偏倚。
- **应用场景**：观察性研究中（Figure 20.6），若混杂因素与先前治疗共享未测量原因$W_0$，同样导致偏倚。

**细节要点（Fine Points）**：
- **非零效应扩展**：即使存在真实治疗效应（Figure 20.7），调整$L_1$仍会引入非因果关联（Fine Point 20.2）。
- **混杂因素位置**：$L_1$可在治疗-结果的因果路径上（如$A_0 \to L_1 \to Y$），但传统方法仍偏倚，而g-方法可处理。

---

#### 20.4 传统方法为何无法修正
**技术重点（Technical Points）**：
- **核心局限**：参数化结局回归（如线性模型$E[Y|\bar{A},L_1] = \theta_0 + \theta_1 \text{cum}(\bar{A}) + \theta_2 L_1$）因依赖$L_1$分层，无法消除反馈导致的偏倚。
- **关键概念**：高维数据中，静态策略数量（$2^K$）远超样本量，需模型简化，但模型误设和分层本质共同导致失败。
- **应用场景**：累积治疗（如$\text{cum}(\bar{A}) = A_0 + A_1$）的因果效应估计中，$\theta_1 \times 2$仍被$L_1$诱导的关联污染。

**细节要点（Fine Points）**：
- **计算挑战**：当$K=100$时，静态策略数量达$2^{100}$，远超可行样本量。
- **方法对比**：g-方法可同时无偏估计所有治疗组分$A_k$的联合效应，传统方法则不能。

---

#### 20.5 调整既往治疗
**技术重点（Technical Points）**：
- **核心要求**：序贯可交换性需同时调整治疗史$\bar{A}_{k-1}$和混杂因素$L_k$（如Figure 20.8-20.10），因$A_0$可能直接影响$A_1$或成为混杂因素。
- **关键概念**：
  - 短期效应估计：时间固定治疗$A_1$的效应需调整$A_0$，否则在反馈或$A_0→Y$路径下产生偏倚。
  - 新用户设计：限制分析于无既往治疗者以避免偏倚。
- **测量误差影响**：若$A_0$存在随机误测$A_0^*$，则调整$A_0^*$和$L_1$仍无法阻断$A_1$与$Y$的混杂路径，导致零效应下出现偏倚（Robins, 1987）。

**细节要点（Fine Points）**：
- **图示扩展**：Figure 20.8-20.9添加$A_0 \to A_1$箭头，显示调整$L_1$仍开放路径（如$A_1 \leftarrow A_0 \to L_1 \leftarrow U_1 \to Y$）。
- **实践建议**：正确调整既往治疗可避免对新用户设计的依赖，但误测会放大偏倚。

---

### 章节逻辑关联
- **与前一章关联**：本章基于第19章的序贯可交换性理论，聚焦其成立时传统方法在反馈场景下的失效机制。
- **全书主题关联**：治疗-混杂反馈是时间依赖性治疗因果推断的核心挑战，引出g-方法的必要性（后续章节基础）。