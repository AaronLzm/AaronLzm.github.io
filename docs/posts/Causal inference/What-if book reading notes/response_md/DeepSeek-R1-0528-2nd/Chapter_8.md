---
title: Chapter_8
category: Causal inference
tags: [DeepSeek-R1-0528-2nd,response_md]

---
<think>
我们正在处理《因果推断：What If》第8章“选择偏倚”的内容。本章内容较多，我们将按照章节结构逐步总结。由于无法解析图片内容，我们将基于文本描述和上下文来总结图表信息。

 第8章主要讨论选择偏倚的定义、结构、示例、与混杂的区别、调整方法等。我们将按子章节进行总结。

 首先，第8章开头通过一个随机实验的例子引入选择偏倚的概念：即使没有混杂偏倚，由于选择过程（如仅分析同意参与研究的行人）可能导致关联不代表因果效应。

 然后，8.1节介绍选择偏倚的结构，使用因果图（DAG）表示。图8.1描述了一个常见的选择偏倚结构：处理A和结果Y的共同效应C（如出生前死亡），当研究限制在C=0（存活到出生）时，会打开路径A→C←Y，导致A和Y之间出现非因果关联。

 8.2节列举了选择偏倚的多个例子，包括：失访偏倚、缺失数据偏倚、健康工人偏倚、自选择偏倚、研究前处理影响选择等。

 8.3节比较选择偏倚和混杂，指出两者都导致处理组和对照组不可交换，但结构不同：混杂由共同原因引起，选择偏倚由共同效应（碰撞点）的条件化引起。

 8.4节通过一个芥末摄入的试验例子说明选择偏倚和删失（censoring）的关系，并引入新的反事实目标：在无删失情况下的因果效应（即同时干预处理A和删失C）。

 8.5节介绍如何用逆概率加权（IP weighting）调整选择偏倚，通过构建伪总体（pseudo-population）来模拟无人删失的情况。

 8.6节讨论在特定条件下（如乘性生存模型），选择共同效应可能不会导致偏倚。

 此外，还有两个技术点（Technical Point）和两个精细点（Fine Point）提供额外细节。

 由于内容较长，我们将分节总结。注意：图片内容无法解析，我们将根据文本描述总结图中信息。数学公式用LaTeX表示。

 开始总结：
</think>
### 第8章 选择偏倚

#### 8.1 选择偏倚的结构  
**技术重点（Technical Points）**：  
- **核心理论**：选择偏倚源于分析中个体选择过程导致的非因果关联，与混杂偏倚不同，它并非由处理（A）和结果（Y）的共同原因引起，而是由条件化处理与结果的共同效应（碰撞点，collider）导致。  
- **关键公式**：  
  - 条件化共同效应C时，关联风险比 ≠ 因果风险比：  
    $\text{Pr}[Y=1|A=1,C=0] / \text{Pr}[Y=1|A=0,C=0] \neq \text{Pr}[Y^{a=1}=1] / \text{Pr}[Y^{a=0}=1]$  
  - 未条件化C时，关联风险比 = 因果风险比：  
    $\text{Pr}[Y=1|A=1] / \text{Pr}[Y=1|A=0] = \text{Pr}[Y^{a=1}=1] / \text{Pr}[Y^{a=0}=1]$  
- **重要概念**：  
  - **碰撞点（Collider）**：变量C是A和Y的共同效应（如出生前死亡），条件化C会打开非因果路径（如$A \rightarrow C \leftarrow Y$），诱导虚假关联。  
  - **零效应下偏倚**：即使处理对结果无因果效应（$A \not\rightarrow Y$），选择偏倚仍存在。  

**细节要点（Fine Points）**：  
- **因果图示例**：  
  - 图8.1：叶酸补充（A）与心脏畸形（Y）研究，限制于存活胎儿（C=0），C作为A和Y的共同效应诱导偏倚。  
  - 图8.2：添加变量S（父母悲伤），条件化S（S=0）同样打开路径$A \rightarrow C \leftarrow Y$。  
- **背景说明**：Pearl (1995) 和 Spirtes et al. (2000) 首次用因果图描述选择偏倚结构。  

---

#### 8.2 选择偏倚的示例  
**技术重点（Technical Points）**：  
- **广义定义**：选择偏倚是条件化两个变量的共同效应导致的偏倚，其中一个变量与处理相关，另一个与结果相关（Hernán et al., 2004）。  
- **常见类型**：  
  - 失访偏倚（Differential loss to follow-up）  
  - 缺失数据偏倚（Missing data bias）  
  - 健康工人偏倚（Healthy worker bias）  
  - 自选择偏倚（Self-selection bias）  
  - 研究前处理影响选择（Selection affected by pre-study treatment）  

**细节要点（Fine Points）**：  
- **案例细节**：  
  - **健康工人偏倚**：估计职业化学暴露（A）对死亡率（Y）的影响时，研究在岗工人（C=0），但健康状态（U）同时影响死亡和在岗状态（图8.3-8.6）。  
  - **病例对照研究偏倚**（精细点8.1）：  
    - 图8.1用于表示雌激素治疗（A）与冠心病（Y）的病例对照研究。  
    - 过度抽样髋骨折患者作为对照（因A降低髋骨折风险），导致条件化选择（C=0）时A与Y的比值比被高估。  
- **跨学科术语差异**：  
  - 统计学称“可忽略处理分配”，社会科学称“可观测选择”，计量经济学称“外生性”。  

---

#### 8.3 选择偏倚与混杂  
**技术重点（Technical Points）**：  
- **结构差异**：  
  - **混杂**：由处理与结果的共同原因引起。  
  - **选择偏倚**：由条件化处理与结果的共同效应引起。  
- **关键区别**：  
  - 随机化可消除混杂，但无法防止随机化后发生的选择偏倚（如失访）。  
  - 随机试验中，治疗前选择（如仅纳入志愿者）不会导致偏倚，因处理分配在同意参与（C=0）后进行。  

**细节要点（Fine Points）**：  
- **消防员研究示例**（图8.7）：  
  - 研究限制于消防员（C=0），父母社会经济地位（L）影响成为消防员和心脏病（Y），但体力活动（A）与Y无因果效应。  
  - 条件化C导致A与Y的关联风险比 ≠ 1（选择偏倚），需调整L以恢复可比性。  
- **术语争议**：流行病学家常将需调整的变量统称为“混杂因子”，无论偏倚源于共同原因或共同效应。  

---

#### 8.4 选择偏倚与删失  
**技术重点（Technical Points）**：  
- **因果对比修正**：删失（C）存在时，目标参数定义为“若所有人未删失”的因果效应：  
  - 因果风险比：$E[Y^{a=1,c=0}] / E[Y^{a=0,c=0}]$  
  - 因果风险差：$E[Y^{a=1,c=0}] - E[Y^{a=0,c=0}]$  
- **删失作为处理**：调整选择偏倚需满足针对C的可交换性、正概率、一致性条件。  

**细节要点（Fine Points）**：  
- **芥末摄入试验示例**：  
  - 60人随机分配至芥末组（A=1）或对照组（A=0），理论风险比=1。  
  - 删失（C=1）更常见于心脏病患者（L=1）和芥末组，未删失亚组风险比=0.89（选择偏倚）。  
  - 因果图（图8.3）：U（动脉粥样硬化）是C和Y的共同原因，L可阻断后门路径$C \leftarrow L \leftarrow U \rightarrow Y$。  

---

#### 8.5 如何调整选择偏倚  
**技术重点（Technical Points）**：  
- **IP加权法**：  
  - 权重 $W^C = 1 / \text{Pr}[C=0|L,A]$，赋予未删失个体（C=0）。  
  - 构建伪总体（pseudo-population）模拟无人删失的场景。  
- **可识别条件**：  
  1. **可交换性**：给定A和L，删失者与未删失者的结果均值相等（需L阻断所有C与Y的后门路径）。  
  2. **正概率**：$\text{Pr}[C=0|L,A] > 0$（对C=1无要求）。  
  3. **一致性**：干预（废除删失）需明确定义（竞争事件中不适用）。  

**细节要点（Fine Points）**：  
- **分层法的局限性**：  
  - 图8.3/8.5中，条件化L可调整偏倚；但图8.4/8.6中，条件化L（碰撞点）会打开新路径（如$A \rightarrow L \leftarrow U \rightarrow Y$），导致偏倚。  
- **竞争事件问题**：若删失是竞争事件（如其他死因），IP加权可能不适用，因无法概念化“移除所有其他死因”的干预。  

---

#### 8.6 无偏倚的选择  
**技术重点（Technical Points）**：  
- **乘性生存模型**（Technical Point 8.2）：  
  - 当 $\text{Pr}[Y=0|E=e,A=a] = g(e)h(a)$ 时，A与E在Y=0层条件独立。  
  - 图8.13中，通过添加未测变量（$Y_A, Y_E, Y_O$）扩展DAG，解释生存者（Y=0）中手术（A）与单倍型（E）的独立性。  
- **关键结论**：条件化碰撞点不一定导致偏倚，若关联仅限于特定层（如Y=1）。  

**细节要点（Fine Points）**：  
- **偏倚方向与强度**（精细点8.2）：  
  - 方向取决于A和E导致Y的机制（“或”机制诱导负关联，“与”机制诱导正关联）。  
  - 强度取决于碰撞点与处理/结果的关联强度（Greenland, 2003）。  
- **DAG局限性**：标准DAG无法区分“或/与”机制，需充分因果结构（VanderWeele & Robins, 2007c）。  

---  
**逻辑连贯性**：本章延续第7章混杂偏倚的讨论，强调选择偏倚是另一导致不可交换性的结构，两者均可在零效应下出现偏倚。全章通过因果图统一框架，逐步展示调整方法（如IP加权），为后续时间依变处理（Part III）奠定基础。