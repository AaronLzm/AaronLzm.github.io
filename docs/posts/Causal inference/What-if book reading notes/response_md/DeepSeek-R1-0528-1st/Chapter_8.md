---
date: 2025-09-17 11:19:05
title: Chapter_8
category: Causal inference
tags: [DeepSeek-R1-0528-1st,response_md]

---
<think>
我们正在处理《因果推断：What If》第8章“选择偏倚”的内容。本章详细讨论了选择偏倚的定义、结构、示例、与混杂的区别、调整方法以及特殊情况。以下将严格按照章节结构提炼技术重点和细节要点，并确保不遗漏任何重要细节。数学公式将使用LaTeX格式。

### 第8章：选择偏倚 (Selection Bias)

#### 8.1 选择偏倚的结构 (The structure of selection bias)
- **技术重点**：选择偏倚是由于分析中个体选择过程导致的关联，而非治疗和结果的共同原因（混杂）。它可以在随机实验和观察性研究中出现。
- **细节要点**：
  - 选择偏倚在零效应（null effect）下仍可发生，即即使治疗对结果无因果效应，选择过程也能产生关联。
  - 用因果图表示：图8.1中，治疗A和结果Y的共同效应C（如出生前死亡）被条件化（如研究仅限存活婴儿），导致路径A→C←Y被打开，产生虚假关联。
  - 图8.2扩展了图8.1，增加变量S（父母悲伤），条件化S（仅研究不悲伤的父母）同样打开路径A→C←Y。
  - 数学表达：条件化C时，关联风险比Pr[Y=1|A=1,C=0]/Pr[Y=1|A=0,C=0]不等于因果风险比Pr[Y^{a=1}=1]/Pr[Y^{a=0}=1]。
  - 若不条件化C，则仅存路径A→Y，关联风险比等于因果风险比。

#### 8.2 选择偏倚的示例 (Examples of selection bias)
- **技术重点**：选择偏倚的常见场景包括差异失访、数据缺失、健康工人偏倚、自选择偏倚等。
- **细节要点**：
  - **差异失访（Differential loss to follow-up）**：如图8.3-8.6，由于失访（C）与治疗A和结果Y相关，条件化C导致偏倚。也称为信息性删失（informative censoring）。
  - **数据缺失偏倚（Missing data bias, nonresponse bias）**：结果Y的缺失（C=1）导致分析限于完整数据个体（C=0）时产生偏倚。
  - **健康工人偏倚（Healthy worker bias）**：研究限于在职工人（C=0），但健康状态U影响在职和死亡Y，且治疗A（职业暴露）影响在职状态，导致条件化C时产生偏倚。
  - **自选择偏倚（Self-selection bias, volunteer bias）**：研究限于志愿者（C=0），但参与意愿与治疗A和结果Y相关（如吸烟A、心脏病Y、家族史U）。
  - **研究前治疗影响选择（Selection affected by treatment received before study entry）**：治疗A发生在研究前，且影响入组选择C（如研究招募50岁个体，但终生暴露A影响入组概率）。
  - **病例对照研究中的选择偏倚（Fine Point 8.1）**：图8.1可表示病例对照研究中的偏倚。例如，研究雌激素A对冠心病Y的效应，但对照选择偏好髋骨折女性，而A影响髋骨折，导致条件化选择C时产生偏倚。

#### 8.3 选择偏倚与混杂 (Selection bias and confounding)
- **技术重点**：选择偏倚和混杂是导致处理组和未处理组不可交换性的两种不同结构。
- **细节要点**：
  - **混杂（Confounding）**：由于治疗A和结果Y的共同原因导致。
  - **选择偏倚（Selection bias）**：由于条件化治疗A和结果Y（或其原因）的共同效应导致。
  - 两者均可在零效应下导致偏倚。
  - 关键区别：随机化可避免混杂，但不能避免随机化后发生的选择偏倚（如失访）。随机化前选择（如试验仅纳入志愿者）不会导致选择偏倚，因为随机化在同意参与（C=0）后进行。
  - 示例（图8.7）：研究限于消防员（C=0），估计体力活动A对心脏病Y的效应。父母社会经济地位L影响成为消防员和心脏病，但A和Y无共同原因（无混杂）。然而，条件化C（成为消防员）导致选择偏倚，需调整L以恢复可交换性。

#### 8.4 选择偏倚与删失 (Selection bias and censoring)
- **技术重点**：删失（censoring）是选择偏倚的常见原因，可通过反概率加权（IP weighting）调整。
- **细节要点**：
  - 示例：芥末摄入A对死亡Y的随机试验，删失C（失访）与心脏病L和A相关。观察到的风险比（未删失个体）为0.89，但真实因果风险比为1。
  - 因果对比修正：定义反事实结果Y^{a,c=0}（若接受治疗a且未删失），目标估计Pr[Y^{a=1,c=0}=1] vs Pr[Y^{a=0,c=0}=1]。
  - 将删失C视为另一种治疗，需满足可交换性、正值性和一致性条件。

#### 8.5 如何调整选择偏倚 (How to adjust for selection bias)
- **技术重点**：IP加权可调整选择偏倚，通过权重W^C = 1 / Pr[C=0|L,A]创建伪人群。
- **细节要点**：
  - **IP加权步骤**：对未删失个体（C=0）赋予权重W^C，使其代表相同L和A值的删失个体（C=1）。
  - **示例应用**：芥末试验中，按L和A计算Pr[C=0|L,A]，加权后伪人群的风险比恢复为1。
  - **可识别条件**：
    1. **可交换性**：给定A和L，删失个体和未删失个体的结果均值相同（需L阻断所有C和Y的后门路径）。
    2. **正值性**：所有A和L组合下Pr[C=0|L,A] > 0（对C=1不要求）。
    3. **一致性**：干预定义明确（如删失为失访时可行，但为竞争风险时可能不适用）。
  - **与分层比较**：在特定结构（图8.3, 8.5）中，分层（条件L）可调整偏倚；但在其他结构（图8.4, 8.6）中，分层会引入新偏倚（因L是碰撞子）。

#### 8.6 无偏倚的选择 (Selection without bias)
- **技术重点**：条件化共同效应不一定总是导致选择偏倚，存在特殊情况（乘法生存模型）。
- **细节要点**：
  - 图8.12：手术A和单倍型E独立，但条件化死亡Y（共同效应）时，在Y=1层诱导关联，在Y=0层可能独立。
  - 图8.13：扩展结构，引入死因特异性变量（肿瘤死亡Y_A、心梗死亡Y_E、其他死因Y_O）。当A和E通过独立机制影响生存时，条件化生存（Y=0）等价于Y_A=Y_E=Y_O=0，阻断路径，A和E在Y=0层独立（乘法生存模型）。
  - 若机制不独立（图8.14-8.16），则Y=0层也可能关联。
  - **Fine Point 8.2**：选择偏倚的方向和大小取决于A和E的交互机制（“或”机制导致负关联，“与”机制导致正关联），且偏倚大小需足够大才影响结论。

### 结论
- 选择偏倚源于分析中选择个体的过程，条件化治疗和结果（或其原因）的共同效应（碰撞子）导致。
- 常见于差异失访、数据缺失、健康工人偏倚等场景。
- 与混杂不同，随机化不能防止随机化后选择偏倚。
- 调整方法：IP加权（需可交换性、正值性、一致性），但在竞争风险场景需谨慎。
- 特殊结构下（乘法生存模型），条件化共同效应可能无偏倚。
- 实践中需考虑偏倚方向和大小。

### 数学公式
- 关联风险比：$\frac{\Pr[Y=1|A=1,C=0]}{\Pr[Y=1|A=0,C=0]}$
- 因果风险比：$\frac{\Pr[Y^{a=1}=1]}{\Pr[Y^{a=0}=1]}$
- IP权重：$W^C = \frac{1}{\Pr[C=0|L,A]}$
- 乘法生存模型：$\Pr[Y=0|E=e,A=a] = g(e)h(a)$

本章内容完整覆盖，无主观臆断，严格基于文本。
</think>
### 第8章：选择偏倚（Selection Bias）总结

#### **8.1 选择偏倚的结构**
- **技术重点**：  
  - 选择偏倚是由于分析中个体选择过程导致的非因果关联，与混杂不同，**非因治疗（A）与结果（Y）的共同原因**引起，而是因**条件化共同效应（碰撞子，collider）** 导致。  
  - 在零效应（null effect）下仍可发生（即即使 $A$ 对 $Y$ 无因果效应，选择过程仍可产生关联）。  
  - 因果图表示（图8.1-8.6）：  
    - 图8.1：条件化共同效应 $C$（如胎儿死亡）打开路径 $A \rightarrow C \leftarrow Y$，导致 $A$ 与 $Y$ 的虚假关联。  
    - 图8.2：条件化 $C$ 的下游变量 $S$（如父母悲伤）同样打开路径 $A \rightarrow C \leftarrow Y$。  
    - 图8.3-8.6：扩展结构（如 $U$ 为未测混杂，$L$ 为中介），条件化删失 $C$ 打开路径（如 $A \rightarrow C \leftarrow L \leftarrow U \rightarrow Y$）。  
  - 数学表达：  
    - 条件化 $C$ 时，关联风险比 $\frac{\Pr[Y=1|A=1,C=0]}{\Pr[Y=1|A=0,C=0]} \neq$ 因果风险比 $\frac{\Pr[Y^{a=1}=1]}{\Pr[Y^{a=0}=1]}$。  
    - 未条件化 $C$ 时，关联风险比等于因果风险比。

#### **8.2 选择偏倚的示例**
- **技术重点**：  
  - 选择偏倚的常见场景及因果图对应：  
    | **类型**                | **机制**                                                                 | **因果图**    |  
    |-------------------------|--------------------------------------------------------------------------|---------------|  
    | 差异失访                | 失访（$C$）与 $A$ 和 $Y$ 相关（如HIV研究中治疗副作用导致退出）           | 图8.3-8.6     |  
    | 数据缺失/无应答         | 结果 $Y$ 缺失时限制分析（$C=0$）引入偏倚                                | 图8.3-8.6     |  
    | 健康工人偏倚            | 研究限于在职者（$C=0$），健康状态 $U$ 关联 $A$（暴露）与 $Y$（死亡）     | 图8.3-8.6     |  
    | 自选择偏倚              | 志愿者（$C=0$）与 $A$（吸烟）、$Y$（心脏病）相关                        | 图8.3-8.6     |  
    | 研究前治疗影响选择      | 治疗 $A$（如终生暴露）影响入组选择 $C$                                  | 图8.3-8.6     |  
    | 病例对照研究偏倚（精点8.1） | 对照选择依赖 $A$ 的结果（如雌激素 $A$ 影响髋骨折，进而影响选择 $C$） | 图8.1         |  
  - **关键细节**：  
    - 随机试验中，随机化后发生的选择（如失访）可导致偏倚，但随机化前选择（如志愿者入组）不会（因随机化在 $C=0$ 后进行）。

#### **8.3 选择偏倚与混杂的区别**
- **技术重点**：  
  - **混杂**：由 $A$ 和 $Y$ 的**共同原因**引起（如 $L \rightarrow A$ 且 $L \rightarrow Y$）。  
  - **选择偏倚**：由条件化 $A$ 和 $Y$（或其原因）的**共同效应**引起（如条件化碰撞子 $C$）。  
  - **关键区别**：  
    - 随机化可消除混杂，但**不能消除随机化后选择偏倚**（图8.3-8.4为随机试验仍可发生）。  
    - 示例（图8.7）：消防员研究（$C=0$）中，$A$（体力活动）与 $Y$（心脏病）无共同原因（无混杂），但条件化 $C$ 导致选择偏倚，需调整 $L$（社会经济地位）。  
  - **术语差异**：  
    - 统计学/计量经济学中“选择偏倚”常包含混杂，但结构上二者不同。

#### **8.4 选择偏倚与删失**
- **技术重点**：  
  - 删失（Censoring）作为选择偏倚的特例：  
    - 示例：芥末摄入 $A$ 的随机试验中，删失 $C$（失访）与心脏病 $L$ 和 $A$ 相关，导致观察风险比（0.89）≠ 真实因果风险比（1）。  
  - **修正因果对比**：  
    - 定义反事实结果 $Y^{a,c=0}$（若接受治疗 $a$ 且未删失）。  
    - 目标估计：$\frac{\Pr[Y^{a=1,c=0}=1]}{\Pr[Y^{a=0,c=0}=1]}$ 或 $E[Y^{a=1,c=0}] - E[Y^{a=0,c=0}]$。  
  - **关键洞见**：将删失 $C$ 视为另一“治疗”，需调整其混杂。

#### **8.5 选择偏倚的调整方法**
- **技术重点**：**反概率加权（IP weighting）**  
  - **步骤**：  
    1. 计算权重 $W^C = \frac{1}{\Pr[C=0|L,A]}$。  
    2. 对未删失个体（$C=0$）赋权，使其代表相同 $L,A$ 的删失个体（$C=1$）。  
  - **示例**：芥末试验中，IP加权后伪人群风险比恢复为1（图8.10-8.11）。  
  - **可识别条件**：  
    | **条件**       | **要求**                                                                 |  
    |----------------|------------------------------------------------------------------------|  
    | 可交换性       | 给定 $A,L$，删失与未删失个体的 $Y$ 均值相等（需 $L$ 阻断所有 $C$ 到 $Y$ 的后门路径） |  
    | 正值性         | $\Pr[C=0|L,A] > 0$（对 $C=1$ 不要求）                                 |  
    | 一致性         | 干预明确（如删失为失访时可行，竞争风险时可能不适用）                   |  
  - **与分层法的比较**：  
    - 分层法在特定结构（图8.3, 8.5）有效，但在其他结构（图8.4, 8.6）因 $L$ 为碰撞子引入新偏倚。

#### **8.6 无偏倚的选择**
- **技术重点**：  
  - **乘法生存模型**（图8.13）：当 $A$ 和 $E$ 通过独立机制影响生存时（如 $A$ 影响肿瘤死亡 $Y_A$，$E$ 影响心梗死亡 $Y_E$），条件化生存（$Y=0$）**不诱导 $A$ 与 $E$ 的偏倚**（因路径被非碰撞子阻断）。  
  - **例外情况**（图8.14-8.16）：若机制不独立（如共同原因或交互），则条件化 $Y$ 仍导致偏倚。  
- **精点8.2：选择偏倚的方向与大小**：  
  - 方向取决于 $A$ 和 $E$ 的交互机制（“或”机制导致负关联，“与”机制导致正关联）。  
  - 大小取决于碰撞子与 $A$、$Y$ 的关联强度，小偏倚可忽略。

---

### **结论**
1. **选择偏倚本质**：源于条件化治疗 $A$ 和结果 $Y$（或其原因）的**共同效应**（碰撞子），在随机实验和观察性研究中均可发生。  
2. **与混杂的区别**：混杂由共同原因引起，随机化可消除；选择偏倚需专门方法（如IP加权）。  
3. **调整方法**：IP加权通过权重 $W^C = \frac{1}{\Pr[C=0|L,A]}$ 校正，需满足可交换性、正值性、一致性。  
4. **特殊情形**：乘法生存模型下，条件化生存（$Y=0$）可能无偏倚。  
5. **实践意义**：需评估偏倚方向和大小，尤其在存在删失或复杂选择机制时。