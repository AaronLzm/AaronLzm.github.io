---
date: 2025-09-17 11:19:05
title: Chapter_20
category: Causal inference
tags: [DeepSeek-R1-0528,response_md]

---
<think>
我们正在处理《因果推断：What If》第20章的内容。该章标题为“TREATMENT-CONFOUNDER FEEDBACK”。根据提供的文本，我们将按照章节结构逐步总结，提炼技术重点和细节要点。

 第20章主要讨论时间依从性治疗中的处理-混杂因素反馈问题。上一章介绍了序贯可交换性（sequential exchangeability）作为识别时变处理因果效应的关键条件。本章指出，即使序贯可交换性成立，当存在处理-混杂因素反馈时，传统的混杂调整方法（如分层、回归、匹配）可能引入偏倚。

 章节结构：
 20.1 处理-混杂因素反馈的要素
 20.2 传统方法的偏倚
 20.3 传统方法为何失败
 20.4 为何传统方法无法修正
 20.5 调整过去的处理

 由于文本内容较长，我们将分节处理。首先处理20.1节。

 注意：由于无法查看图片，我们将基于文本描述和上下文来总结图片内容。文本中提到了多个因果图（Figure 20.1至20.10），我们将根据描述解释其含义。

 开始总结：
</think>
### Chapter 20: TREATMENT-CONFOUNDER FEEDBACK  
**逻辑关联性**：本章延续第19章对时变治疗（time-varying treatments）的讨论，聚焦序贯可交换性（sequential exchangeability）成立时，传统混杂调整方法在处理-混杂因素反馈（treatment-confounder feedback）场景下的失效机制。

---

#### 20.1 The elements of treatment-confounder feedback  
**技术重点（Technical Points）**：  
- **核心理论**：  
  - 处理-混杂因素反馈指时变混杂因素（time-varying confounder）既影响后续治疗分配，又受先前治疗影响的循环结构（如HIV研究中，CD4细胞计数$L_k$影响治疗$A_k$，而治疗$A_{k-1}$又影响$L_k$）。  
  - 该反馈在因果图中通过离散时间展开表示（如路径$A_{k-1} \to L_k \to A_k \to L_{k+1}$），时间离散化（discretization）是实践中的通用方法。  
- **关键概念**：  
  - **时间依从性混杂（Time-varying confounding）**：混杂因素$L_k$随测量时间$k$变化，需满足序贯可交换性以识别因果效应。  
  - **无反馈的混杂**：图20.2显示，若混杂因素$L_k$不受先前治疗影响（无$A_{k-1} \to L_k$），则仅存在时间依从性混杂，无反馈循环。  

**细节要点（Fine Points）**：  
- **因果图简化**：图20.3简化HIV试验场景（两时间点），忽略基线变量$L_0$、未测量变量$U_0$、治疗间直接效应（$A_0 \to A_1$），并假设尖锐零假设（sharp null hypothesis）成立（治疗无因果效应）。  
- **反馈的识别问题**：即使序贯可交换性成立，传统方法调整混杂$L_1$仍会引入偏倚（bias），导致效应估计无效（invalid）。  

---

#### 20.2 The bias of traditional methods  
**技术重点（Technical Points）**：  
- **核心问题**：  
  - 当存在处理-混杂因素反馈时，传统方法（分层、回归、匹配）无法无偏估计治疗策略的因果效应，即使序贯可交换性成立。  
  - **g-方法（g-methods）**：可正确处理反馈场景下的时变混杂。  
- **关键公式**：  
  - 因果效应目标：比较静态策略“始终治疗”($a_0=1,a_1=1$) vs. “从不治疗”($a_0=0,a_1=0$)的期望差异：  
    $$E[Y^{a_0=1,a_1=1}] - E[Y^{a_0=0,a_1=0}]$$  
  - 在尖锐零假设下，真实效应为0（图20.3无路径$A_0 \to Y$或$A_1 \to Y$）。  

**细节要点（Fine Points）**：  
- **模拟试验数据**：表20.1展示32,000名HIV患者的假想序贯随机试验数据（$A_0$随机分配，$A_1$依$L_1$分配）。  
  - 确认条件效应为零：$A_1$在$A_0$和$L_1$各层中无效应（如$E[Y|A_0=0,L_1=0,A_1=1] - E[Y|A_0=0,L_1=0,A_1=0] = 0$）。  
- **传统方法失效**：  
  1. **未调整混杂**：比较联合治疗$(A_0=1,A_1=1)$ vs. $(A_0=0,A_1=0)$，得偏倚效应-13.3（错误结论）。  
  2. **分层调整混杂**：在$L_1$层内比较，仍得偏倚效应-8（各层一致），无法加权得正确值0。  

---

#### 20.3 Why traditional methods fail  
**技术重点（Technical Points）**：  
- **偏倚机制**：  
  - 分层调整混杂$L_1$（如CD4计数）时，因$L_1$是碰撞子（collider，图20.5路径$A_0 \to L_1 \leftarrow U_1 \to Y$），打开非因果路径$A_0 \to Y$，引入选择偏倚（selection bias）。  
  - 在观测性研究中（图20.6），混杂因素$L_1$与先前治疗共享未测量原因$W_0$，同样导致偏倚。  
- **普遍性**：  
  - 偏倚与治疗是否存在真实效应无关（图20.7），且随时间点增加而放大。  

**细节要点（Fine Points）**：  
- **混杂与因果路径**：  
  - 即使混杂因素$L_1$位于治疗$A_0$到结局$Y$的因果路径上（如$A_0 \to L_1 \to Y$），传统分层仍偏倚总体效应（Fine Point 20.2）。  
  - g-方法可避免此问题。  

---

#### 20.4 Why traditional methods cannot be fixed  
**技术重点（Technical Points）**：  
- **回归建模的局限**：  
  - 高维数据中，参数化结果回归（如$E[Y|\bar{A},L_1] = \theta_0 + \theta_1 \text{cum}(\bar{A}) + \theta_2 L_1$）因条件于$L_1$而继承分层偏倚，导致$\theta_1 \neq 0$（真实效应为0时）。  
- **根本问题**：  
  - 传统方法无法同时无偏估计治疗组分$A_k$的联合效应（joint effect）。  

**细节要点（Fine Points）**：  
- **维度灾难**：当治疗时点$K$较大（如$K=100$），静态策略数达$2^{100}$，远超样本量，需依赖模型假设（如累积治疗线性效应），但模型误设（misspecification）增加额外风险。  

---

#### 20.5 Adjusting for past treatment  
**技术重点（Technical Points）**：  
- **调整必要性**：  
  - 若过去治疗直接影响后续治疗（图20.8-20.9），需同时调整治疗史$\bar{A}_{k-1}$和混杂$L_k$以阻断后门路径（如$A_1 \leftarrow A_0 \to L_1 \leftarrow U_1 \to Y$）。  
  - 序贯可交换性要求条件于治疗史（treatment history）。  
- **测量误差的偏倚**：  
  - 过去治疗$A_0$的误测（如$A_0^*$替代$A_0$）在零假设下仍导致偏倚，因其作为后续治疗$A_1$的混杂因素（即使$A_0$无因果效应）。  

**细节要点（Fine Points）**：  
- **新用户设计（New-user designs）**：限制分析基线未治疗者，避免调整过去治疗的需求，但无法完全解决误测问题。  
- **偏倚方向**：随机误测可能使效应估计远离零（bias away from null）。  

---  
**章节关联性**：本章为后续引入g-方法（第21章）奠定基础，强调传统方法在时变治疗因果推断中的根本局限，尤其处理-混杂因素反馈场景下需专用方法。所有结论严格基于原文，未明确处（如图片细节）已标注。