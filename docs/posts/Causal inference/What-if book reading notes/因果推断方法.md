---
title: 因果推断方法
category: Causal inference
tags: [What-if book reading notes,Causal inference]

---
根据《Causal Inference: What If》（Hernán & Robins, 2020）的内容框架，**IPW（逆概率加权）仅是书中介绍的多种因果推断方法之一，并非全书核心依赖的方法**。该书系统性地整合了因果推断的理论体系，覆盖了从基础概念到高级模型的完整路径。以下从方法论结构和内容重点展开分析：

---

### 📚 一、全书方法论框架：三部分渐进式体系
1. **第一部分：无模型的因果推断（非参数辨识）**  
   聚焦基础概念，如潜在结果框架（Potential Outcomes）、因果效应定义、随机实验与观察性研究的差异，以及混杂偏倚（Confounding）的识别。这一部分**未涉及模型依赖**，强调通过设计（如随机化）解决因果问题。

2. **第二部分：基于模型的因果推断（参数化估计）**  
   此处引入多种建模方法，包括：
   - **IPW（逆概率加权）与边缘结构模型（MSM）**：用于处理观察性数据中的混杂，通过权重调整模拟随机化。
   - **标准化与G公式（G-Computation）**：直接建模结果变量，避免IPW对倾向得分模型的依赖。
   - **工具变量（IV）**：解决未观测混杂问题（如孟德尔随机化）。
   - **倾向得分匹配（PSM）与结构方程模型（SEM）**：用于降维和平衡协变量。

3. **第三部分：复杂纵向数据因果推断**  
   扩展至时变处理（Time-varying Treatments）和动态策略，引入：
   - **G-估算（G-Estimation）与结构嵌套模型**：处理时间依赖性混杂。
   - **边缘结构模型（MSM）的扩展**：结合IPW但需迭代加权。

---

### ⚖️ 二、IPW的定位：重要但非主导
- **作用场景**：IPW主要在**观察性研究**中用于校正选择偏差，通过倾向得分（如Logistic回归预测处理分配概率）构建权重。
- **局限性与替代方案**：  
  - 书中强调IPW对倾向得分模型误设敏感，且极端权重可能导致估计不稳定。  
  - **G公式、标准化、结局回归（Outcome Regression）** 被作为替代方案提出，尤其当模型假设更易满足时。
- **与其他方法的协同**：例如在MSM中，IPW与参数模型结合处理时变混杂。

---

### 🔧 三、其他核心方法占比与创新点
1. **前沿方法整合**  
   - **机器学习因果推断**（第7部分）：元学习器（T-Learner/X-Learner）、因果森林、动态处理优化。
   - **生存分析中的因果问题**：处理删失数据和时变效应。

2. **关键模型对比**  
   | **方法**          | **适用场景**                | **优势**                          | **章节**   |
   |-------------------|---------------------------|----------------------------------|------------|
   | IPW               | 横截面观察性数据           | 直观模拟随机化                   | 第4、5章   |
   | G公式             | 时变处理/动态策略          | 避免倾向得分模型依赖             | 第5、19章  |
   | 工具变量（IV）    | 未观测混杂                | 利用自然实验设计                 | 第16章     |
   | 结构嵌套模型      | 纵向数据/时变混杂         | 直接估计效应参数                 | 第21章     |

3. **基础性贡献**  
   - **反事实框架的严谨定义**：明确个体因果效应与平均因果效应的识别条件。
   - **偏差分解**：详尽分析混杂偏倚、选择偏倚、测量偏倚的机制与解决方案。

---

### 💎 四、结论：IPW是工具之一，但体系全面多元
该书**以“问题驱动”而非“方法驱动”**，IPW仅是解决特定偏倚问题的工具之一。其核心价值在于：
1. **方法论多样性**：覆盖从非参数设计到复杂模型，强调“因果问题决定方法选择”。
2. **假设的严谨性**：任何方法的应用均需满足可识别性条件（如可交换性、一致性、正值性）。
3. **实践导向**：提供Stata/R/Python代码实现（如[作者官网](https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/)），强化方法的应用验证。

> 💡 若需深入实操，可参考书中第4章（IPW）、第5章（G公式与标准化）、第16章（工具变量）的案例，或访问作者提供的[代码仓库](https://gitee.com/arlionn/Robins)。