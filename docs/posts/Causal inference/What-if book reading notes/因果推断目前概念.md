---
date: 2025-09-17 11:19:05
title: 因果推断目前概念
category: Causal inference
tags: [What-if book reading notes,Causal inference]

---
以下是对因果推断领域所有23个核心概念的系统性介绍，严格遵循您提供的框架：

---

### **1. 因果效应 (Causal Effect)**
- **定义**  
  因果效应指干预（如药物治疗）对结局（如生存率）的**净影响**，需通过比较同一对象在干预与未干预下的潜在结局（Potential Outcomes）来定义。例如：个体服药后生存时间 \(Y^{a=1}\) 与未服药生存时间 \(Y^{a=0}\) 的差值 \(Y^{a=1} - Y^{a=0}\)。

- **随机实验 (Randomized Experiments)**  
  通过随机分配干预（如抛硬币分组），确保干预组与对照组除干预外**特征可比**。黄金标准方法，可消除混淆偏差（如年龄对疗效的影响）。

- **观察性研究 (Observational Studies)**  
  基于自然状态下的观测数据（如电子病历），需用统计方法（如倾向评分）**模拟随机化**，但受未测量混杂因素威胁（如未记录的吸烟史）。

---

### **2. 因果效应的修饰和交互**
- **效应修饰 (Effect Modification)**  
  干预效应因第三变量（修饰因子）而异。例如：药物对男性效果（风险差 +10%） vs 女性（-5%），需按性别分层报告效应。

- **交互作用 (Interaction)**  
  两个干预**共同作用时效应非相加**。如药物A单独降低死亡率5%，药物B降低3%，但联用降低15%（协同作用）。

- **因果效应的图像表示**  
  使用**有向无环图 (DAG)** 可视化变量间因果关系（箭头表示影响路径），辅助识别混杂因子（如年龄同时影响用药和康复）。

---

### **3. 因果推断的干扰和偏差**
- **干扰因子 (Confounding)**  
  混杂因子（如年龄）同时影响干预与结局，导致虚假关联。解决方案：调整/分层分析（如按年龄分组比较药效）。

- **选择偏差 (Selection bias)**  
  样本选择与干预/结局相关。例如：仅纳入幸存者研究药物效果（忽略死亡病例），导致高估疗效。

- **测量偏差 (Measurement bias)**  
  变量测量误差（如血压计不准）扭曲效应估计。若误差与干预相关（如干预组更频繁测量），偏差更严重。

---

### **4. 因果推断的模型和随机性**
- **随机变异性 (Random variability)**  
  由抽样误差引起的效应估计波动，用**置信区间**量化（如95% CI: 2%~8% 表示真实效应有95%概率在此区间）。

- **为何使用模型**  
  模型（如线性回归）可同时调整多个混杂因子，解决分层分析维度爆炸问题（如年龄×性别×病史的组合过多）。

- **逆概率加权 (IPW) 与边缘结构模型 (MSM)**  
  - **IPW**：为每个个体赋予权重 \(W = 1/P(A|L)\)（\(A\)=干预, \(L\)=混杂因子），构建“伪总体”消除混杂。  
  - **MSM**：基于IPW的模型，直接估计**群体平均因果效应**（如全人群服药 vs 不服药的死亡率差）。

---

### **5. 因果推断的公式和模型**
- **标准化与参数G公式**  
  - **标准化**：按混杂因子分层计算效应，再加权平均（如按年龄组计算药效后，以人口年龄分布加权）。  
  - **G公式**：通过模型预测反事实结局（如拟合 \(E[Y|A,L]\)），模拟不同干预策略下的结局（“如果所有人服药，死亡率会是多少？”）。

- **G-估算与结构嵌套模型**  
  - **G-估算**：估计结构嵌套模型参数，直接建模**效应异质性**（如药效如何随年龄变化）。  
  - **结构嵌套模型**：定义条件因果效应（如 \(E[Y^a - Y^{0}|L]\)），适用于时变干预（如随时间调整剂量）。

- **结局回归与倾向性评分**  
  - **结局回归**：直接建模 \(Y \sim A + L\)（结局~干预+混杂因子），依赖模型设定正确。  
  - **倾向性评分**：用 \(P(A=1|L)\)（如Logistic回归预测服药概率）匹配/分层/加权，使组间混杂均衡。

---

### **6. 因果推断的生存分析和变量**
- **工具变量 (Instrumental Variables, IV)**  
  利用与干预相关但不直接影响结局的变量（如地理距离医院），解决**未测量混杂**。需满足：  
  ① 相关性：IV→干预  
  ② 排他性：IV→结局仅通过干预  
  ③ 独立性：IV与混杂无关  

- **生存分析中的因果推断**  
  处理**删失数据**（如失访）和**时间依赖性混杂**（如住院期间用药变化）。使用**结构Cox模型**或**G公式**估计干预对生存时间的影响。

- **变量选择**  
  优先纳入**因果充分集**（基于DAG的最小混杂集），避免调整无关变量（可能引入偏差）或遗漏关键混杂。

---

### **7. 使用机器学习进行因果推断**
- **元学习器 (Meta-learner)**  
  组合ML模型估计因果量：  
  - **S-Learner**：单一模型 \(Y \sim A + L\)，预测反事实  
  - **T-Learner**：干预组/对照组分别建模  
  - **X-Learner**：用对照组模型矫正干预组预测  

- **因果推断树 (Causal Tree)**  
  递归分割数据，最大化**组间效应差异**（如年龄>60岁组药效显著更强）。用于识别效应修饰亚组。

- **价值优化方法 (Value Optimization)**  
  结合强化学习与因果推断，学习**最优决策策略**（如给特定患者开药A而非药B）。通过Q-learning或策略梯度最大化长期结局。

---

> **关键点总结**：因果推断的核心是**反事实推理**（若不干预会怎样？），需区分关联与因果。传统方法（IPW/G公式）依赖强假设（无未测混杂），机器学习提供灵活建模但需谨慎验证。实际应用中，DAG指导变量选择，敏感性分析评估未测混杂影响。