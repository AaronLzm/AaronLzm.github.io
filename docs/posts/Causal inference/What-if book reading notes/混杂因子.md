---
title: 混杂因子
category: Causal inference
tags: [What-if book reading notes,Causal inference]

---
混杂因子（Confounder）是因果推断的核心概念，其判定**高度依赖专家知识**，但也需结合数据验证。以下是系统解析：

---

### **混杂因子的本质**
指同时影响**暴露（干预）**和**结局**的变量，若不调整会导致虚假因果关联。  
**示例**：  
- 研究「咖啡饮用（暴露）→ 心脏病（结局）」时，**年龄**是混杂因子：  
  - 年龄↑ → 咖啡饮用↑（老年人更常喝咖啡）  
  - 年龄↑ → 心脏病风险↑  
  - 若不调整年龄，会高估咖啡对心脏病的危害。

---

### **判定混杂因子的三标准**  
需同时满足：  
1. **与暴露相关**（如年龄与咖啡饮用相关）  
2. **与结局相关**（如年龄与心脏病相关）  
3. **不在因果路径上**（年龄不是咖啡→心脏病的中间环节）  

> ✅ 经典混杂因子：吸烟（影响肺癌和职业暴露）、BMI（影响饮食干预和糖尿病结局）  
> ❌ **非混杂因子**：  
> - **中介变量**（如咖啡因血药浓度在咖啡→心脏病路径上）  
> - **碰撞点**（调整“幸存者”会扭曲吸烟与癌症的关系）  

---

### **为什么需要专家知识？**  
1. **构建因果图（DAG）**：  
   - 依赖领域知识绘制变量间因果关系（如确定“社会经济地位”是否影响药物分配和康复）  
   - *数据无法自动生成DAG*：相关性≠因果方向（例如教育水平和收入谁因谁果？）  

2. **避免错误调整**：  
   - 调整**中介变量**（如治疗过程中的血压变化）会掩盖真实效应  
   - 调整**碰撞点**（如仅研究存活患者）会引入偏倚  

3. **识别未测量混杂**：  
   - 专家可指出潜在混杂（如基因、环境因素），推动数据收集  
   - *示例*：早期关于“激素治疗降低心脏病风险”的研究，未考虑混杂因子**就医行为**（定期就医者更可能服药且更健康）  

---

### **数据驱动的辅助方法**  
虽需专家主导，但数据可提供验证：  
1. **平衡性检验**：  
   - 调整混杂因子后，暴露组与对照组基线特征应平衡（如标准化均差SMD<0.1）  
2. **敏感性分析**：  
   - 量化未测混杂需多强才能推翻结论（如E-value分析）  
3. **工具变量（IV）**：  
   - 当混杂未测量时，用IV估计因果效应（如用医生处方偏好作为用药的工具变量）  

---

### **操作建议：如何确定混杂因子？**  
| **步骤**          | **具体操作**                                                                 |
|-------------------|-----------------------------------------------------------------------------|
| **1. 领域知识梳理** | 与临床/领域专家讨论，列出所有可能影响暴露和结局的变量（如文献中的常见混杂因子） |
| **2. 绘制DAG**     | 用软件（如Dagitty）构建因果图，识别最小充分调整集（避免过度调整）            |
| **3. 数据验证**    | 检验变量是否与暴露和结局相关（如回归分析、卡方检验）                          |
| **4. 调整后评估**  | 比较调整前后的效应估计值：若变化>10%或方向改变，提示存在混杂                 |

---

### **典型案例解析**  
**研究问题**：维生素D补充（暴露）能否降低癌症死亡率（结局）？  
- **潜在混杂**：紫外线暴露（影响维生素D合成和癌症风险）、年龄、饮食、地理区域...  
- **专家作用**：  
  - 指出“紫外线暴露”是关键混杂（需测量或用纬度代理）  
  - 排除“癌症分期”（是治疗中介，非混杂）  
- **错误调整后果**：若调整癌症分期，会低估维生素D的真实效果  

> **关键结论**：混杂因子判定是**科学（数据）与艺术（领域知识）的结合**。没有专家知识易犯两类错误：  
> - 遗漏混杂 → 高估/低估效应  
> - 过度调整 → 掩盖真实因果机制