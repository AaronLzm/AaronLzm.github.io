import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as n,a as l,f as s,w as a,r as p,b as g,g as r,d as t}from"./app-D3XHLyGs.js";const h={};function u(c,o){const i=p("think");return g(),n("div",null,[l(i,null,{default:a(()=>[...o[0]||(o[0]=[r(" 我们正在处理《因果推断：What If》第18章“变量选择与高维数据”的内容。本章讨论了在因果推断中如何选择调整变量的问题，强调了因果推断与预测分析在变量选择上的不同标准，并介绍了高维数据下的因果推断方法。 ",-1),t("p",null,[r("首先，我们需要按照章节结构提炼技术重点和细节要点。本章包含以下子章节："),t("br"),r(" 18.1 变量选择的不同目标"),t("br"),r(" 18.2 导致或放大偏差的变量"),t("br"),r(" 18.3 因果推断与机器学习"),t("br"),r(" 18.4 双重稳健的机器学习估计量"),t("br"),r(" 18.5 变量选择是一个难题")],-1),t("p",null,[r("此外，还有两个精细点（Fine Points）："),t("br"),r(" 精细点18.1：回归模型的变量选择程序"),t("br"),r(" 精细点18.2：过拟合与交叉验证")],-1),t("p",null,[r("以及两个技术点（Technical Points）："),t("br"),r(" 技术点18.1：增强IP加权分样本和交叉拟合估计量"),t("br"),r(" 技术点18.2：分样本和交叉拟合估计量的统计性质")],-1),t("p",null,"我们将逐一总结每个部分，注意保留技术术语的英文表述，同时使用中文总结。对于数学公式，使用LaTeX格式。",-1),t("p",null,"由于图像内容无法直接获取，我们将根据文本描述和上下文理解图像所代表的因果图，并在总结中引用这些图的描述。",-1),t("p",null,"开始总结：",-1)])]),_:1}),o[1]||(o[1]=s(' ### 第18章：变量选择与高维数据 **核心问题**：因果推断中调整变量 \\(L\\) 的选择标准与预测分析不同，需避免引入偏差并确保条件可交换性。 <hr><h4 id="_18-1-变量选择的不同目标" tabindex="-1"><a class="header-anchor" href="#_18-1-变量选择的不同目标"><span><strong>18.1 变量选择的不同目标</strong></span></a></h4><ul><li><strong>因果推断 vs. 预测分析</strong>： <ul><li><strong>因果推断</strong>：需调整混杂因子 (L) 以实现条件可交换性（(Y^a \\perp !!! \\perp A \\mid L)）。未调整混杂时，关联度量（association measure）无法解释为因果效应。</li><li><strong>预测分析</strong>：仅需最大化预测准确性（如预测戒烟 (A) 与体重增加 (Y) 的关联），无需考虑混杂或因果解释。 <blockquote><p>例：预测模型包含协变量（戒烟、基线体重、收入），但不区分是否为混杂因子。</p></blockquote></li><li><strong>关键区别</strong>：混杂（confounding）是因果概念，不适用于纯关联性估计。</li></ul></li></ul><hr><h4 id="_18-2-导致或放大偏差的变量" tabindex="-1"><a class="header-anchor" href="#_18-2-导致或放大偏差的变量"><span><strong>18.2 导致或放大偏差的变量</strong></span></a></h4><p>调整某些变量可能引入偏差，即使样本无限且无约束：</p><ol><li><p><strong>偏差来源分类</strong>：</p><ul><li><strong>碰撞子（Collider）调整</strong>： <ul><li>图18.1中调整 (L)（碰撞子）会打开路径 (A \\rightarrow L \\leftarrow U \\rightarrow Y)，导致选择偏差（selection bias）。</li><li>零效应下（(A) 不影响 (Y)），调整 (L) 仍产生非零关联（偏差）。</li></ul></li><li><strong>中介变量（Mediator）调整</strong>： <ul><li>图18.4中调整中介 (L)（如 (A \\rightarrow L \\rightarrow Y)）会阻断间接路径，导致过度调整（overadjustment），高估直接效应但低估总效应。</li></ul></li><li><strong>工具变量（Instrument）调整</strong>： <ul><li>图18.7中调整工具变量 (Z) 可能放大未测混杂 (U) 的偏差（Z-bias），但可能减少偏差（不确定性高）。</li></ul></li></ul></li><li><p><strong>时间顺序的局限性</strong>：</p><ul><li>即使变量在治疗 (A) 后测量（post-treatment），仍可能为混杂（图18.5：(L) 阻断后门路径 (A \\leftarrow U \\rightarrow L \\rightarrow Y)）。</li><li><strong>核心挑战</strong>：数据无法区分碰撞子、混杂或中介，需依赖领域知识排除偏差诱导变量。</li></ul></li><li><p><strong>预处理变量的风险</strong>：</p><ul><li><strong>M-偏差</strong>：图18.6中调整预处理碰撞子 (L) 引入偏差。</li><li><strong>偏差放大（Bias Amplification）</strong>：调整工具变量 (Z) 可能放大未测混杂 (U) 的影响（线性模型下必然发生）。</li></ul></li></ol><blockquote><p><strong>结论</strong>：避免调整所有可用变量 (X)；需结合因果图排除偏差诱导变量。</p></blockquote><hr><h4 id="_18-3-因果推断与机器学习" tabindex="-1"><a class="header-anchor" href="#_18-3-因果推断与机器学习"><span><strong>18.3 因果推断与机器学习</strong></span></a></h4><p><strong>假设</strong>：已通过领域知识确保 (X) 包含所有混杂 (L) 且无偏差诱导变量，满足可忽略性（ignorability）和正值性（positivity）。</p><ul><li><strong>高维挑战</strong>： <ul><li>传统参数模型（如GLM）在 (X) 维数高时必然误设（misspecified）。</li><li>机器学习（ML）方法（如Lasso、随机森林、深度学习）可灵活估计条件期望： <ul><li>倾向得分 (\\pi(X) = \\Pr(A=1 \\mid X))</li><li>结果回归 (b(X) = E[Y \\mid A=1, X])</li></ul></li><li>ML优势：通过交叉验证优化预测，但需与双重稳健估计结合。</li></ul></li></ul><hr><h4 id="_18-4-双重稳健机器学习估计量" tabindex="-1"><a class="header-anchor" href="#_18-4-双重稳健机器学习估计量"><span><strong>18.4 双重稳健机器学习估计量</strong></span></a></h4><p><strong>目标</strong>：估计 (\\psi = E[Y^{a=1}])，需满足偏差 (\\ll 1/\\sqrt{n}) 以确保Wald置信区间有效。</p><ul><li><p><strong>双重稳健估计量（AIPW）</strong>：<br> [<br> \\hat{\\psi} = \\frac{1}{n} \\sum_{i=1}^n \\left[ \\hat{b}(X_i) + \\frac{A_i}{\\hat{\\pi}(X_i)} (Y_i - \\hat{b}(X_i)) \\right]<br> ]</p><ul><li><strong>优势</strong>：偏差取决于乘积误差 (\\left( \\frac{1}{\\hat{\\pi}(X)} - \\frac{1}{\\pi(X)} \\right) \\times ( \\hat{b}(X) - b(X) ))，可降至 (O(n^{-1/2}))。</li></ul></li><li><p><strong>样本分割（Sample Splitting）与交叉拟合（Cross-fitting）</strong>：</p><ol><li>将样本随机分为训练集（训练 (\\hat{b}(X)), (\\hat{\\pi}(X))）和估计集（计算 (\\hat{\\psi}))。</li><li>交换角色重复估计，取平均得交叉拟合估计量 (\\hat{\\psi}_{\\text{cross-fit}})。</li><li><strong>统计性质</strong>： <ul><li>条件于训练数据，估计量渐近正态。</li><li>若 (\\hat{b}(X)) 和 (\\hat{\\pi}(X)) 收敛速率满足 (\\alpha + \\epsilon &gt; 1/2)，则偏差为 (o(n^{-1/2}))。</li></ul></li></ol></li></ul><blockquote><p><strong>优势</strong>：结合ML的灵活性与双重稳健性，实现有效推断。</p></blockquote><hr><h4 id="_18-5-变量选择的根本难题" tabindex="-1"><a class="header-anchor" href="#_18-5-变量选择的根本难题"><span><strong>18.5 变量选择的根本难题</strong></span></a></h4><p><strong>双重稳健ML的局限</strong>：</p><ol><li><strong>领域知识不足</strong>：无法确保排除所有偏差诱导变量。</li><li><strong>计算成本</strong>：时变处理或生存分析中实现复杂。</li><li><strong>方差-偏差权衡</strong>： <ul><li>强关联协变量导致 (\\pi(X) \\approx 0/1)，估计方差增大。</li><li>基于数据剔除变量会破坏置信区间有效性。</li></ul></li></ol><p><strong>实践建议</strong>：</p><ul><li>进行多重敏感性分析（multiple sensitivity analyses），比较不同方法结果的一致性。</li><li>若结果冲突，需探究原因（如未测混杂或模型误设）。</li></ul><hr><h3 id="结论" tabindex="-1"><a class="header-anchor" href="#结论"><span>结论**</span></a></h3><ul><li><strong>变量选择核心</strong>：依赖因果结构知识，而非纯统计标准。</li><li><strong>高维数据解法</strong>：双重稳健估计 + ML + 样本分割/交叉拟合，可在一定条件下实现有效推断。</li><li><strong>开放问题</strong>：方差-偏差权衡、时变处理扩展及领域知识整合仍需方法论创新。</li></ul>',27))])}const b=e(h,[["render",u]]),_=JSON.parse(`{"path":"/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/Chapter_18.html","title":"Chapter_18","lang":"en-US","frontmatter":{"title":"Chapter_18","category":"Causal inference","tags":["DeepSeek-R1-0528-1st","response_md"],"description":"### 第18章：变量选择与高维数据 **核心问题**：因果推断中调整变量 \\\\(L\\\\) 的选择标准与预测分析不同，需避免引入偏差并确保条件可交换性。 18.1 变量选择的不同目标 因果推断 vs. 预测分析： 因果推断：需调整混杂因子 (L) 以实现条件可交换性（(Y^a \\\\perp !!! \\\\perp A \\\\mid L)）。未调整混杂时，关联度量（a...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Chapter_18\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-09-17T03:19:05.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Aaron L\\",\\"url\\":\\"https://aaronlzm.github.io\\",\\"email\\":\\"lzm_aaron@outlook.com\\"}]}"],["meta",{"property":"og:url","content":"https://aaronlzm.github.io/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/Chapter_18.html"}],["meta",{"property":"og:site_name","content":"Aaron's Blog"}],["meta",{"property":"og:title","content":"Chapter_18"}],["meta",{"property":"og:description","content":"### 第18章：变量选择与高维数据 **核心问题**：因果推断中调整变量 \\\\(L\\\\) 的选择标准与预测分析不同，需避免引入偏差并确保条件可交换性。 18.1 变量选择的不同目标 因果推断 vs. 预测分析： 因果推断：需调整混杂因子 (L) 以实现条件可交换性（(Y^a \\\\perp !!! \\\\perp A \\\\mid L)）。未调整混杂时，关联度量（a..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-09-17T03:19:05.000Z"}],["meta",{"property":"article:tag","content":"response_md"}],["meta",{"property":"article:tag","content":"DeepSeek-R1-0528-1st"}],["meta",{"property":"article:modified_time","content":"2025-09-17T03:19:05.000Z"}]]},"git":{"createdTime":1758079145000,"updatedTime":1758079145000,"contributors":[{"name":"lizhimou","username":"lizhimou","email":"lizhimou@bytedance.com","commits":1,"url":"https://github.com/lizhimou"}]},"readingTime":{"minutes":5.17,"words":1552},"filePathRelative":"posts/Causal inference/What-if book reading notes/response_md/DeepSeek-R1-0528-1st/Chapter_18.md","excerpt":"\\n### 第18章：变量选择与高维数据  \\n**核心问题**：因果推断中调整变量 \\\\(L\\\\) 的选择标准与预测分析不同，需避免引入偏差并确保条件可交换性。\\n<hr>\\n<h4><strong>18.1 变量选择的不同目标</strong></h4>\\n<ul>\\n<li><strong>因果推断 vs. 预测分析</strong>：\\n<ul>\\n<li><strong>因果推断</strong>：需调整混杂因子 (L) 以实现条件可交换性（(Y^a \\\\perp !!! \\\\perp A \\\\mid L)）。未调整混杂时，关联度量（association measure）无法解释为因果效应。</li>\\n<li><strong>预测分析</strong>：仅需最大化预测准确性（如预测戒烟 (A) 与体重增加 (Y) 的关联），无需考虑混杂或因果解释。\\n<blockquote>\\n<p>例：预测模型包含协变量（戒烟、基线体重、收入），但不区分是否为混杂因子。</p>\\n</blockquote>\\n</li>\\n<li><strong>关键区别</strong>：混杂（confounding）是因果概念，不适用于纯关联性估计。</li>\\n</ul>\\n</li>\\n</ul>","autoDesc":true}`);export{b as comp,_ as data};
