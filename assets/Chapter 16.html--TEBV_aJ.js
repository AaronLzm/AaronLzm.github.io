import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as i,f as o,d as t,g as r,b as e}from"./app-CHcUs86b.js";const l={};function s(g,n){return e(),i("div",null,[...n[0]||(n[0]=[o('<h3 id="chapter-16-instrumental-variable-estimation" tabindex="-1"><a class="header-anchor" href="#chapter-16-instrumental-variable-estimation"><span>Chapter 16: Instrumental Variable Estimation</span></a></h3><p><strong>核心目标</strong>：在存在未测量混杂时估计因果效应，通过工具变量（IV）绕过传统调整方法的需求。</p><hr><h4 id="_16-1-工具变量的三个条件" tabindex="-1"><a class="header-anchor" href="#_16-1-工具变量的三个条件"><span><strong>16.1 工具变量的三个条件</strong></span></a></h4><p>一个变量 ( Z ) 成为有效工具需满足：</p><ol><li><strong>关联性 (Relevance)</strong>:<br> ( Z ) 与处理 ( A ) 相关：<br> [<br> \\Pr[A=1|Z=1] - \\Pr[A=1|Z=0] \\neq 0 \\quad \\text{(或更一般形式 } Z \\not\\perp A\\text{)}<br> ]</li><li><strong>排他性约束 (Exclusion Restriction)</strong>:<br> ( Z ) 仅通过 ( A ) 影响结果 ( Y )，无直接路径：<br> [<br> Y_i^{z,a} = Y_i^{z&#39;,a} = Y_i^a \\quad \\text{(个体层)} \\quad \\text{或} \\quad E[Y^{z,a}] = E[Y^{z&#39;,a}] \\quad \\text{(群体层)}<br> ]</li><li><strong>可交换性 (Exchangeability)</strong>:<br> ( Z ) 与 ( Y ) 无共同原因（无混杂）：<br> [<br> Y^{a,z} \\perp Z \\quad \\text{(或更严格的联合可交换性)}<br> ]</li></ol><blockquote><p><strong>关键结论</strong>：</p><ul><li>仅条件 (i) 可经验验证（如 RCT 中 ( Z ) 为随机分配）。</li><li>条件 (ii) 和 (iii) <strong>不可验证</strong>，需依赖领域知识假设成立（如双盲试验）。</li></ul></blockquote><hr><h4 id="_16-2-标准-iv-估计量" tabindex="-1"><a class="header-anchor" href="#_16-2-标准-iv-估计量"><span><strong>16.2 标准 IV 估计量</strong></span></a></h4><p>当 ( Z ) 为二值工具变量时，<strong>因果效应估计量</strong>为：<br> [<br> \\text{IV Estimand} = \\frac{E[Y|Z=1] - E[Y|Z=0]}{E[A|Z=1] - E[A|Z=0]}<br> ]<br><strong>计算方法</strong>：</p><ol><li><strong>两阶段最小二乘法 (2SLS)</strong>: <ul><li>第一阶段：拟合 ( A ) 对 ( Z ) 的回归： ( E[A|Z] = \\alpha_0 + \\alpha_1 Z )</li><li>第二阶段：拟合 ( Y ) 对预测值 ( \\hat{A} ) 的回归： ( E[Y|\\hat{A}] = \\beta_0 + \\beta_1 \\hat{A} )</li><li>估计值 ( \\hat{\\beta}_1 ) 等于 IV 估计量。</li></ul></li><li><strong>结构均值模型 (Structural Mean Models)</strong>: <ul><li>加性模型： ( E[Y - Y^{a=0} | A, Z] = A (\\beta_0 + \\beta_1 Z) )</li><li>乘性模型： ( E[Y|A,Z] = E[Y^{a=0}|A,Z] \\exp[A(\\beta_0 + \\beta_1 Z)] )</li></ul></li></ol><blockquote><p><strong>示例</strong>（戒烟对体重的影响）：</p><ul><li>工具 ( Z )：香烟价格 &gt; $1.50（二值）</li><li>估计值： ( \\hat{\\beta}_1 = 2.4 \\text{kg} ) （95% CI: -36.5, 41.3）</li></ul></blockquote><hr><h4 id="_16-3-第四识别条件-同质性-homogeneity" tabindex="-1"><a class="header-anchor" href="#_16-3-第四识别条件-同质性-homogeneity"><span><strong>16.3 第四识别条件：同质性 (Homogeneity)</strong></span></a></h4><p>仅工具变量三个条件<strong>不足</strong>以识别平均因果效应 ( E[Y^{a=1}] - E[Y^{a=0}] )，需额外条件：</p>',15),t("ol",null,[t("li",null,[t("strong",null,"常数效应假设"),r("：所有个体因果效应相同（强假设，通常不成立）。")]),t("li",null,[t("strong",null,"处理效应在 ( Z ) 水平同质"),r("："),t("br"),r(" ["),t("br"),r(" E[Y^{a=1} - Y^{a=0} | Z=1, A=a] = E[Y^{a=1} - Y^{a=0} | Z=0, A=a] \\quad (a=0,1)"),t("br"),r(" ]")]),t("li",null,[t("strong",null,"无混杂效应修饰"),r("："),t("br"),r(" ["),t("br"),r(" E[Y^{a=1} | U] - E[Y^{a=0} | U] = \\text{常数} \\quad \\text{(或与 } t(U) \\text{ 不相关)}"),t("br"),r(" ]"),t("br"),t("strong",null,"一般同质性条件"),r("："),t("br"),r(" ["),t("br"),r(" \\text{Cov}\\left( e(U), t(U) \\right) = 0, \\quad \\text{其中 } e(U) = E[Y"),t("sup",{a:"0"},"{a=1}-Y"),r("|U], \\ t(U) = E[A|Z=1,U] - E[A|Z=0,U]"),t("br"),r(" ]")])],-1),o('<hr><h4 id="_16-4-替代第四条件-单调性-monotonicity" tabindex="-1"><a class="header-anchor" href="#_16-4-替代第四条件-单调性-monotonicity"><span><strong>16.4 替代第四条件：单调性 (Monotonicity)</strong></span></a></h4><p>若同质性不成立，可用单调性替代：</p><ul><li><strong>定义</strong>：无反抗者（Defiers），即 ( A^{z=1} \\geq A^{z=0} ) 对所有个体成立。</li><li><strong>估计目标</strong>：顺从者（Compliers）的平均因果效应（CACE/LATE）：<br> [<br> E[Y^{a=1} - Y^{a=0} | A^{z=1}=1, A^{z=0}=0] = \\frac{E[Y|Z=1] - E[Y|Z=0]}{E[A|Z=1] - E[A|Z=0]}<br> ]</li></ul><blockquote><p><strong>局限</strong>：</p><ol><li><strong>可解释性</strong>：顺从者群体未观测且随工具变化。</li><li><strong>单调性合理性</strong>：观察性研究中可能违反（如医生偏好存在多维决策）。</li><li><strong>替代工具问题</strong>：若 ( Z ) 非因果工具（如代理变量），CACE 解释无效。</li></ol></blockquote><hr><h4 id="_16-5-工具变量条件再讨论" tabindex="-1"><a class="header-anchor" href="#_16-5-工具变量条件再讨论"><span><strong>16.5 工具变量条件再讨论</strong></span></a></h4><h5 id="弱工具变量问题-weak-instruments" tabindex="-1"><a class="header-anchor" href="#弱工具变量问题-weak-instruments"><span><strong>弱工具变量问题 (Weak Instruments)</strong></span></a></h5><ul><li><strong>定义</strong>： <ul><li>实质性弱： ( |E[A|Z=1] - E[A|Z=0]| ) 过小（如 &lt; 10%）。</li><li>统计性弱：一阶段回归 F 统计量 &lt; 10。</li></ul></li><li><strong>后果</strong>： <ol><li>估计置信区间宽。</li><li><strong>放大偏误</strong>：条件 (ii)-(iii) 的微小违反被分母放大（偏误 × ( 1/\\text{分母} )）。</li><li>有限样本偏误（即使工具有效）。</li></ol></li></ul><h5 id="条件-ii-iii-的违反" tabindex="-1"><a class="header-anchor" href="#条件-ii-iii-的违反"><span><strong>条件 (ii)-(iii) 的违反</strong></span></a></h5><ul><li><strong>直接效应违反 (图 16.8)</strong>：工具 ( Z ) 存在直达 ( Y ) 的路径（如 ( A ) 被粗化时）。</li><li><strong>混杂违反 (图 16.10)</strong>：( Z ) 与 ( Y ) 存在共同原因（观察性研究常见）。</li><li><strong>选择偏误</strong>：分析时排除某些 ( A ) 的取值可能引入偏误。</li></ul><h5 id="缓解策略" tabindex="-1"><a class="header-anchor" href="#缓解策略"><span><strong>缓解策略</strong>：</span></a></h5><ul><li>调整已测协变量 ( V )（分层或纳入模型）。</li><li>检查 ( V ) 在 ( Z ) 水平的平衡性（但无法保证未测混杂平衡）。</li></ul><hr><h4 id="_16-6-iv-估计-vs-其他方法" tabindex="-1"><a class="header-anchor" href="#_16-6-iv-估计-vs-其他方法"><span><strong>16.6 IV 估计 vs. 其他方法</strong></span></a></h4><table><thead><tr><th><strong>特征</strong></th><th><strong>IV 估计</strong></th><th><strong>IP 加权/标准化</strong></th></tr></thead><tbody><tr><td><strong>核心假设</strong></td><td>工具变量条件 + 同质/单调性</td><td>给定 ( V ) 后处理组可交换</td></tr><tr><td><strong>未测混杂处理</strong></td><td>可绕过</td><td>需完全测量混杂</td></tr><tr><td><strong>偏误敏感性</strong></td><td><strong>高</strong>（弱工具或小违反导致大偏误）</td><td>低（小违反导致小偏误）</td></tr><tr><td><strong>适用场景</strong></td><td>二元处理、强工具、单调性合理</td><td>时间依存处理、多阶段策略</td></tr></tbody></table><blockquote><p><strong>关键洞见</strong>：</p><ul><li>IV 的附加价值在于<strong>假设三角验证</strong>（与其他方法假设不同）。</li><li>但 IV 置信区间通常较宽，且偏误方向反直觉。</li></ul></blockquote><hr><h3 id="technical-points-结论" tabindex="-1"><a class="header-anchor" href="#technical-points-结论"><span>Technical Points 结论</span></a></h3><ul><li><strong>TP 16.1</strong>：工具条件 (ii) 和 (iii) 的严格定义依赖反事实独立性（如 ( Y^{a,z} \\perp Z )）。</li><li><strong>TP 16.2</strong>：工具变量可缩小区分因果效应的<strong>自然界限</strong>（Natural Bounds）。</li><li><strong>TP 16.3</strong>：标准 IV 估计量等价于加性结构均值模型在 ( \\beta_1=0 ) 时的参数。</li><li><strong>TP 16.4</strong>：乘性结构均值模型导出不同的 IV 估计量（风险比尺度）。</li><li><strong>TP 16.5</strong>：一般同质性条件 ( \\text{Cov}(e(U), t(U))=0 ) 是 IV 估计无偏的充分条件。</li><li><strong>TP 16.6</strong>：带协变量的结构均值模型可通过 G 估计扩展至时变处理。</li><li><strong>TP 16.7</strong>：单调性下 IV 估计量识别顺从者效应（需 ( Z ) 为因果工具）。</li></ul><hr><h3 id="fine-points-结论" tabindex="-1"><a class="header-anchor" href="#fine-points-结论"><span>Fine Points 结论</span></a></h3><ul><li><strong>FP 16.1</strong>：观察性研究中常见工具类型： <ul><li><strong>遗传变异</strong>（如孟德尔随机化）。</li><li><strong>医生偏好</strong>（如最后处方代理）。</li><li><strong>可及性</strong>（如距离、时间、价格）。</li></ul></li><li><strong>FP 16.2</strong>：弱工具定义（实质性与统计性）及其三重问题。</li><li><strong>FP 16.3</strong>：断点回归设计（RDD）作为 IV 替代： <ul><li><strong>核心假设</strong>：在分配阈值 ( L=c ) 处，( E[Y^a|L] ) 连续。</li><li><strong>估计</strong>：阈值两侧局部平均因果效应（如年龄 65±ε 人群）。</li><li><strong>类型</strong>： <ul><li>清晰断点（处理概率 0→1）。</li><li>模糊断点（处理概率跳跃 &lt;1，需单调性识别顺从者效应）。</li></ul></li></ul></li></ul><hr><h3 id="关键总结" tabindex="-1"><a class="header-anchor" href="#关键总结"><span>关键总结</span></a></h3><ol><li><strong>IV 估计依赖强假设</strong>：三个工具条件 + 第四条件（同质/单调）。</li><li><strong>实践挑战</strong>： <ul><li>条件 (ii)-(iii) 不可验证，需领域知识论证。</li><li>弱工具导致估计不稳定且放大偏误。</li><li>单调性下仅识别顺从者效应（可能缺乏外推性）。</li></ul></li><li><strong>适用性</strong>：IV 最适合二元处理、强工具、且存在明确自然实验的场景（如 RCT 未依从）。</li></ol><blockquote><p><strong>透明性要求</strong>：报告工具强度（F 统计量）、第四条件合理性、敏感性分析。</p></blockquote>',27)])])}const d=a(l,[["render",s]]),c=JSON.parse(`{"path":"/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%2016/Chapter%2016.html","title":"Chapter 16","lang":"en-US","frontmatter":{"title":"Chapter 16","category":"Causal inference","tags":["Chapter 16","What-if book reading notes"],"description":"Chapter 16: Instrumental Variable Estimation 核心目标：在存在未测量混杂时估计因果效应，通过工具变量（IV）绕过传统调整方法的需求。 16.1 工具变量的三个条件 一个变量 ( Z ) 成为有效工具需满足： 关联性 (Relevance): ( Z ) 与处理 ( A ) 相关： [ \\\\Pr[A=1|Z=1]...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Chapter 16\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-09-17T03:19:05.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Aaron L\\",\\"url\\":\\"https://aaronlzm.github.io\\",\\"email\\":\\"lzm_aaron@outlook.com\\"}]}"],["meta",{"property":"og:url","content":"https://aaronlzm.github.io/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%2016/Chapter%2016.html"}],["meta",{"property":"og:site_name","content":"Aaron's Blog"}],["meta",{"property":"og:title","content":"Chapter 16"}],["meta",{"property":"og:description","content":"Chapter 16: Instrumental Variable Estimation 核心目标：在存在未测量混杂时估计因果效应，通过工具变量（IV）绕过传统调整方法的需求。 16.1 工具变量的三个条件 一个变量 ( Z ) 成为有效工具需满足： 关联性 (Relevance): ( Z ) 与处理 ( A ) 相关： [ \\\\Pr[A=1|Z=1]..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-09-17T03:19:05.000Z"}],["meta",{"property":"article:tag","content":"What-if book reading notes"}],["meta",{"property":"article:tag","content":"Chapter 16"}],["meta",{"property":"article:modified_time","content":"2025-09-17T03:19:05.000Z"}]]},"git":{"createdTime":1758079145000,"updatedTime":1758079145000,"contributors":[{"name":"lizhimou","username":"lizhimou","email":"lizhimou@bytedance.com","commits":1,"url":"https://github.com/lizhimou"}]},"readingTime":{"minutes":5.48,"words":1645},"filePathRelative":"posts/Causal inference/What-if book reading notes/Chapter 16/Chapter 16.md","excerpt":"<h3>Chapter 16: Instrumental Variable Estimation</h3>\\n<p><strong>核心目标</strong>：在存在未测量混杂时估计因果效应，通过工具变量（IV）绕过传统调整方法的需求。</p>\\n<hr>\\n<h4><strong>16.1 工具变量的三个条件</strong></h4>\\n<p>一个变量 ( Z ) 成为有效工具需满足：</p>\\n<ol>\\n<li><strong>关联性 (Relevance)</strong>:<br>\\n( Z ) 与处理 ( A ) 相关：<br>\\n[<br>\\n\\\\Pr[A=1|Z=1] - \\\\Pr[A=1|Z=0] \\\\neq 0 \\\\quad \\\\text{(或更一般形式 } Z \\\\not\\\\perp A\\\\text{)}<br>\\n]</li>\\n<li><strong>排他性约束 (Exclusion Restriction)</strong>:<br>\\n( Z ) 仅通过 ( A ) 影响结果 ( Y )，无直接路径：<br>\\n[<br>\\nY_i^{z,a} = Y_i^{z',a} = Y_i^a \\\\quad \\\\text{(个体层)} \\\\quad \\\\text{或} \\\\quad E[Y^{z,a}] = E[Y^{z',a}] \\\\quad \\\\text{(群体层)}<br>\\n]</li>\\n<li><strong>可交换性 (Exchangeability)</strong>:<br>\\n( Z ) 与 ( Y ) 无共同原因（无混杂）：<br>\\n[<br>\\nY^{a,z} \\\\perp Z \\\\quad \\\\text{(或更严格的联合可交换性)}<br>\\n]</li>\\n</ol>","autoDesc":true}`);export{d as comp,c as data};
