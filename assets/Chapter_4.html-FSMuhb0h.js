import{_ as m}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as e,a as l,f as p,w as i,r,b as o,g as a,d as s}from"./app-DTT-b9WU.js";const c={};function h(g,n){const t=r("think");return o(),e("div",null,[l(t,null,{default:i(()=>[...n[0]||(n[0]=[a(' We are summarizing Chapter 4: "Effect Modification" from the provided text. The chapter has several sections: 4.1 Heterogeneity of treatment effects, 4.2 Stratification to identify effect modification, 4.3 Why care about effect modification, 4.4 Stratification as a form of adjustment, 4.5 Matching as another form of adjustment, 4.6 Effect modification and adjustment methods. We also have Fine Points and Technical Points that provide additional details. ',-1),s("p",null,"We will structure the summary by sections and subsections, extracting technical points and fine points as needed.",-1),s("p",null,"Note: The text includes tables and examples. We will summarize the key points from the text, including definitions, formulas, and examples.",-1),s("p",null,"Steps:",-1),s("ol",null,[s("li",null,"Identify the chapter and sections."),s("li",null,[a("For each section, extract: "),s("ul",null,[s("li",null,"Technical Points: core theories, key formulas, important concepts."),s("li",null,"Fine Points: details, examples, additional explanations.")])]),s("li",null,"Use the required format: Markdown, with LaTeX for formulas, and use the section headings as given.")],-1),s("p",null,"Important: We must base everything on the provided text and avoid adding any content.",-1),s("p",null,"Let's break down the chapter:",-1),s("p",null,"Chapter 4: Effect Modification",-1),s("p",null,"4.1 Heterogeneity of treatment effects",-1),s("ul",null,[s("li",null,"Introduces the idea that average causal effects can vary across subgroups (defined by variable V)."),s("li",null,"Example: Heart transplant effect on death differs between men and women (from Table 4.1)."),s("li",null,"Definition: V is an effect modifier if the average causal effect of A on Y varies across levels of V."),s("li",null,"Effect modification depends on the effect measure (e.g., risk difference, risk ratio)."),s("li",null,"Qualitative effect modification: when effects are in opposite directions in different subgroups.")],-1),s("p",null,"4.2 Stratification to identify effect modification",-1),s("ul",null,[s("li",null,"Stratified analysis: compute effect in each stratum of V."),s("li",null,"In ideal randomized experiments (marginal or conditional), we can use observed data to compute causal effects in strata."),s("li",null,"Example: Using Table 4.2 to compute effect of transplant on death in Greeks and Romans (with adjustment for L via standardization or IP weighting).")],-1),s("p",null,"4.3 Why care about effect modification",-1),s("ul",null,[s("li",null,[a("Reasons:"),s("br"),a(" a) The average causal effect depends on the population's mix of effect modifiers (transportability)."),s("br"),a(" b) Helps identify subgroups that benefit most (especially on additive scale)."),s("br"),a(" c) May provide insights into biological or social mechanisms.")]),s("li",null,"Distinction between effect modification and interaction (the latter is causal and discussed in next chapter).")],-1),s("p",null,"4.4 Stratification as a form of adjustment",-1),s("ul",null,[s("li",null,"Stratification can be used for adjustment (for L) and for identifying effect modification (by V)."),s("li",null,"Contrast with standardization and IP weighting: stratification gives conditional effects (in strata of L) while standardization and IP weighting can give marginal effects."),s("li",null,"When using stratification for adjustment requires considering all variables L for exchangeability.")],-1),s("p",null,"4.5 Matching as another form of adjustment",-1),s("ul",null,[s("li",null,"Matching: create a subset where L has same distribution in treated and untreated."),s("li",null,"Example: matched pairs based on L."),s("li",null,"Matching can be used to estimate effects in specific subgroups (e.g., effect in the untreated).")],-1),s("p",null,"4.6 Effect modification and adjustment methods",-1),s("ul",null,[s("li",null,"Different methods (standardization, IP weighting, stratification, matching) estimate different types of effects (marginal vs. conditional in subsets)."),s("li",null,"Example with Table 4.3: different effect measures (risk ratios) from different methods due to effect modification.")],-1),s("p",null,"We also have Fine Points and Technical Points:",-1),s("p",null,"Fine Point 4.1: Effect in the treated",-1),s("ul",null,[s("li",null,"Defines the average causal effect in the treated and in the untreated.")],-1),s("p",null,"Fine Point 4.2: Transportability",-1),s("ul",null,[s("li",null,"Discusses when causal effects can be transported to other populations.")],-1),s("p",null,"Fine Point 4.3: Collapsibility and the odds ratio",-1),s("ul",null,[s("li",null,"Explains that the odds ratio is noncollapsible (population odds ratio may not be a weighted average of stratum-specific odds ratios).")],-1),s("p",null,"Technical Point 4.1: Computing the effect in the treated",-1),s("ul",null,[s("li",null,"Formulas for computing the effect in the treated via standardization and IP weighting.")],-1),s("p",null,"Technical Point 4.2: Pooling of stratum-specific effect measures",-1),s("ul",null,[s("li",null,"Discusses pooling methods (e.g., Mantel-Haenszel) and when they are appropriate.")],-1),s("p",null,"Technical Point 4.3: Relation between marginal and conditional causal risk ratios",-1),s("ul",null,[s("li",null,"Mathematical relation for the risk ratio.")],-1),s("p",null,"We will now write the summary in the required format.",-1)])]),_:1}),n[1]||(n[1]=p(' ### Chapter 4: Effect Modification <h4 id="_4-1-heterogeneity-of-treatment-effects" tabindex="-1"><a class="header-anchor" href="#_4-1-heterogeneity-of-treatment-effects"><span>4.1 Heterogeneity of treatment effects</span></a></h4><p><strong>技术重点（Technical Points）</strong>:</p><ul><li><strong>核心理论</strong>: 因果效应在总体中可能为零，但在子群体中非零（如性别分层）。效应修饰（effect modification）指处理效应随变量 (V) 水平变化而变化的现象。</li><li><strong>关键公式</strong>: <ul><li>因果风险差（Additive scale）:<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>E</mi><mo stretchy="false">[</mo><msup><mi>Y</mi><mrow><mi>a</mi><mo>=</mo><mn>1</mn></mrow></msup><mo>−</mo><msup><mi>Y</mi><mrow><mi>a</mi><mo>=</mo><mn>0</mn></mrow></msup><mi mathvariant="normal">∣</mi><mi>V</mi><mo>=</mo><mi>v</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">E[Y^{a=1} - Y^{a=0} | V = v] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span></span></span></span></span></p></li><li>因果风险比（Multiplicative scale）:<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi>E</mi><mo stretchy="false">[</mo><msup><mi>Y</mi><mrow><mi>a</mi><mo>=</mo><mn>1</mn></mrow></msup><mi mathvariant="normal">∣</mi><mi>V</mi><mo>=</mo><mi>v</mi><mo stretchy="false">]</mo></mrow><mrow><mi>E</mi><mo stretchy="false">[</mo><msup><mi>Y</mi><mrow><mi>a</mi><mo>=</mo><mn>0</mn></mrow></msup><mi mathvariant="normal">∣</mi><mi>V</mi><mo>=</mo><mi>v</mi><mo stretchy="false">]</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\\frac{E[Y^{a=1} | V = v]}{E[Y^{a=0} | V = v]} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4271em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p></li></ul></li><li><strong>重要概念</strong>: <ul><li>定性效应修饰（Qualitative effect modification）: 子群体效应方向相反（如女性有害，男性有益）。</li><li>效应修饰依赖于效应尺度（如风险差或风险比）。</li></ul></li><li><strong>应用场景</strong>: 评估处理（如心脏移植）在子群体（如性别分组）中的异质性效应。</li></ul><p><strong>细节要点（Fine Points）</strong>:</p><ul><li>表4.1示例: 心脏移植在女性中风险差为0.2（有害），男性中为-0.2（有益），总体效应为零（因效应抵消）。</li><li>非定性效应修饰示例: 当风险差相同（0.1）但风险比不同（1.1 vs. 2.0）时，存在乘性而非加性效应修饰。</li><li>术语: &quot;效应修饰&quot;强调依赖效应尺度，故建议用&quot;效应测量修饰&quot;（effect-measure modification）)。</li></ul><h4 id="_4-2-stratification-to-identify-effect-modification" tabindex="-1"><a class="header-anchor" href="#_4-2-stratification-to-identify-effect-modification"><span>4.2 Stratification to identify effect modification</span></a></h4><p><strong>技术重点（Technical Points）</strong>:</p><ul><li><strong>核心理论</strong>: 分层分析是识别效应修饰的标准方法，需在 (V) 的每一层内计算因果效应。</li><li><strong>关键公式</strong>: 分层因果风险差:<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>Pr</mi><mo>⁡</mo><mo stretchy="false">[</mo><msup><mi>Y</mi><mrow><mi>a</mi><mo>=</mo><mn>1</mn></mrow></msup><mo>=</mo><mn>1</mn><mi mathvariant="normal">∣</mi><mi>V</mi><mo>=</mo><mi>v</mi><mo stretchy="false">]</mo><mo>−</mo><mi>Pr</mi><mo>⁡</mo><mo stretchy="false">[</mo><msup><mi>Y</mi><mrow><mi>a</mi><mo>=</mo><mn>0</mn></mrow></msup><mo>=</mo><mn>1</mn><mi mathvariant="normal">∣</mi><mi>V</mi><mo>=</mo><mi>v</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\\Pr[Y^{a=1} = 1 | V = v] - \\Pr[Y^{a=0} = 1 | V = v] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mop">Pr</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1∣</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mop">Pr</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1∣</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span></span></span></span></span></p></li><li><strong>重要概念</strong>: <ul><li>理想随机试验中，观测关联等于因果效应（无需反事实数据）。</li><li>条件随机化实验需标准化或IP加权调整混杂 (L)。</li></ul></li><li><strong>应用场景</strong>: 国籍（(V)）修饰心脏移植（(A)）对死亡（(Y)）的效应（希腊人风险比=1，罗马人风险比=2）。</li></ul><p><strong>细节要点（Fine Points）</strong>:</p><ul><li>表4.2示例: 罗马人数据中，通过标准化调整 (L) 后，国籍修饰移植效应（风险差0.3）。</li><li>区分: 国籍可能是&quot;代理效应修饰因子&quot;（如反映手术质量差异），而非&quot;因果效应修饰因子&quot;。</li></ul><h4 id="_4-3-why-care-about-effect-modification" tabindex="-1"><a class="header-anchor" href="#_4-3-why-care-about-effect-modification"><span>4.3 Why care about effect modification</span></a></h4><p><strong>技术重点（Technical Points）</strong>:</p><ul><li><strong>核心理论</strong>: 因果效应依赖群体中效应修饰因子的分布，无普适&quot;平均因果效应&quot;。</li><li><strong>重要概念</strong>: <ul><li>可移植性（Transportability）: 效应修饰因子分布不同的群体间效应不可直接外推。</li><li>决策应用: 加性尺度效应修饰识别最受益亚组（如仅治疗有益子群体）。</li></ul></li><li><strong>应用场景</strong>: 政策制定（如全国性干预 vs. 目标亚组干预）。</li></ul><p><strong>细节要点（Fine Points）</strong>:</p><ul><li>定性效应修饰示例: 女性比例增加时，总体效应从零变为有害。</li><li>报告建议: 优先报告反事实风险（(\\Pr[Y^a | V=v])）而非仅效应量（如风险比）。</li></ul><h4 id="_4-4-stratification-as-a-form-of-adjustment" tabindex="-1"><a class="header-anchor" href="#_4-4-stratification-as-a-form-of-adjustment"><span>4.4 Stratification as a form of adjustment</span></a></h4><p><strong>技术重点（Technical Points）</strong>:</p><ul><li><strong>核心理论</strong>: 分层可作为调整混杂 (L) 的方法，但输出条件效应（各 (L) 层内），非边际效应。</li><li><strong>重要概念</strong>: <ul><li>与标准化/IP加权对比: 后者可计算边际效应，前者强制评估 (L) 的效应修饰。</li><li>正性要求（Positivity）: 层内需同时存在处理组和对照组。</li></ul></li><li><strong>应用场景</strong>: 限制分析（Restriction）用于正性违反正的亚组。</li></ul><p><strong>细节要点（Fine Points）</strong>:</p><ul><li>实践误区: 流行病学家常误将&quot;分层&quot;等同于&quot;调整&quot;。</li><li>局限性: 分层无法处理时变处理或存在中介时的混杂。</li></ul><h4 id="_4-5-matching-as-another-form-of-adjustment" tabindex="-1"><a class="header-anchor" href="#_4-5-matching-as-another-form-of-adjustment"><span>4.5 Matching as another form of adjustment</span></a></h4><p><strong>技术重点（Technical Points）</strong>:</p><ul><li><strong>核心理论</strong>: 匹配通过构建处理组/对照组 (L) 分布相似的子集实现交换性。</li><li><strong>重要概念</strong>: <ul><li>匹配类型: 个体匹配（individual matching）或频率匹配（frequency matching）。</li><li>效应估计: 通常计算&quot;未治疗者效应&quot;或&quot;治疗者效应&quot;。</li></ul></li><li><strong>应用场景</strong>: 队列研究中平衡混杂因子（如心脏移植示例按病情 (L) 匹配）。</li></ul><p><strong>细节要点（Fine Points）</strong>:</p><ul><li>匹配后群体: 效应修饰因子分布可能不同于原始群体。</li><li>病例对照设计: 需额外调整匹配因子以实现条件交换性。</li></ul><h4 id="_4-6-effect-modification-and-adjustment-methods" tabindex="-1"><a class="header-anchor" href="#_4-6-effect-modification-and-adjustment-methods"><span>4.6 Effect modification and adjustment methods</span></a></h4><p><strong>技术重点（Technical Points）</strong>:</p><ul><li><strong>核心理论</strong>: 不同方法估计不同效应： <ul><li>标准化/IP加权 → 边际效应。</li><li>分层/匹配 → 条件效应（特定亚组）。</li></ul></li><li><strong>关键公式</strong>: 表4.3示例中不同方法的风险比: <ul><li>标准化: 0.8（总体）</li><li>分层: (L=0) 层2.0, (L=1) 层0.5</li><li>匹配: 未治疗者1.0</li></ul></li><li><strong>重要概念</strong>: 非塌陷性（Noncollapsibility）: 比值比（odds ratio）在层内可能大于总体（见Fine Point 4.3）。</li></ul><p><strong>细节要点（Fine Points）</strong>:</p><ul><li>表4.4示例: 高海拔（(A)）对抑郁（(Y)）的因果比值比总体为5.4，但男女层内均为6（非塌陷性）。</li><li>实践意义: 明确目标群体（如总体或亚组）可避免方法间结果差异的误解。</li></ul><hr><h3 id="fine-points-technical-points" tabindex="-1"><a class="header-anchor" href="#fine-points-technical-points"><span>Fine Points &amp; Technical Points</span></a></h3><h4 id="fine-point-4-1-effect-in-the-treated" tabindex="-1"><a class="header-anchor" href="#fine-point-4-1-effect-in-the-treated"><span>Fine Point 4.1: Effect in the treated</span></a></h4><ul><li><strong>技术重点</strong>: <ul><li>定义: 治疗者效应为 (\\Pr[Y=1|A=1] \\neq \\Pr[Y^{a=0}=1|A=1])。</li><li>标准化公式:<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>E</mi><mo stretchy="false">[</mo><msup><mi>Y</mi><mi>a</mi></msup><mi mathvariant="normal">∣</mi><mi>A</mi><mo>=</mo><msup><mi>a</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">]</mo><mo>=</mo><munder><mo>∑</mo><mi>l</mi></munder><mi>E</mi><mo stretchy="false">[</mo><mi>Y</mi><mi mathvariant="normal">∣</mi><mi>A</mi><mo>=</mo><mi>a</mi><mo separator="true">,</mo><mi>L</mi><mo>=</mo><mi>l</mi><mo stretchy="false">]</mo><mi>Pr</mi><mo>⁡</mo><mo stretchy="false">[</mo><mi>L</mi><mo>=</mo><mi>l</mi><mi mathvariant="normal">∣</mi><mi>A</mi><mo>=</mo><msup><mi>a</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">E[Y^a | A=a&#39;] = \\sum_l E[Y|A=a,L=l] \\Pr[L=l|A=a&#39;] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3521em;vertical-align:-1.3021em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord">∣</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">Pr</span><span class="mopen">[</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord">∣</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span></p></li></ul></li></ul><h4 id="fine-point-4-2-transportability" tabindex="-1"><a class="header-anchor" href="#fine-point-4-2-transportability"><span>Fine Point 4.2: Transportability</span></a></h4><ul><li><strong>技术重点</strong>: <ul><li>可移植性依赖: 效应修饰因子分布、治疗版本、干扰模式的一致性。</li><li>改进方法: 用研究群体层效应重构目标群体效应（权重为层比例）。</li></ul></li></ul><h4 id="fine-point-4-3-collapsibility-and-the-odds-ratio" tabindex="-1"><a class="header-anchor" href="#fine-point-4-3-collapsibility-and-the-odds-ratio"><span>Fine Point 4.3: Collapsibility and the odds ratio</span></a></h4><ul><li><strong>技术重点</strong>: <ul><li>非塌陷性: 比值比在层内可大于总体（如层内6.0 vs. 总体5.4）。</li><li>例外: 稀有结局（&lt;10%）时比值比近似风险比且可塌陷。</li></ul></li></ul><h4 id="technical-point-4-1-computing-the-effect-in-the-treated" tabindex="-1"><a class="header-anchor" href="#technical-point-4-1-computing-the-effect-in-the-treated"><span>Technical Point 4.1: Computing the effect in the treated</span></a></h4><ul><li><strong>公式</strong>: <ul><li>IP加权:<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>E</mi><mo stretchy="false">[</mo><msup><mi>Y</mi><mi>a</mi></msup><mi mathvariant="normal">∣</mi><mi>A</mi><mo>=</mo><msup><mi>a</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">]</mo><mo>=</mo><mfrac><mrow><mi>E</mi><mrow><mo fence="true">[</mo><mfrac><mrow><mi>I</mi><mo stretchy="false">(</mo><mi>A</mi><mo>=</mo><mi>a</mi><mo stretchy="false">)</mo><mi>Y</mi></mrow><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>A</mi><mi mathvariant="normal">∣</mi><mi>L</mi><mo stretchy="false">)</mo></mrow></mfrac><mi>Pr</mi><mo>⁡</mo><mo stretchy="false">[</mo><mi>A</mi><mo>=</mo><msup><mi>a</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi mathvariant="normal">∣</mi><mi>L</mi><mo stretchy="false">]</mo><mo fence="true">]</mo></mrow></mrow><mrow><mi>E</mi><mrow><mo fence="true">[</mo><mfrac><mrow><mi>I</mi><mo stretchy="false">(</mo><mi>A</mi><mo>=</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>A</mi><mi mathvariant="normal">∣</mi><mi>L</mi><mo stretchy="false">)</mo></mrow></mfrac><mi>Pr</mi><mo>⁡</mo><mo stretchy="false">[</mo><mi>A</mi><mo>=</mo><msup><mi>a</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi mathvariant="normal">∣</mi><mi>L</mi><mo stretchy="false">]</mo><mo fence="true">]</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">E[Y^a | A=a&#39;] = \\frac{E\\left[ \\frac{I(A=a)Y}{f(A|L)} \\Pr[A=a&#39;|L] \\right]}{E\\left[ \\frac{I(A=a)}{f(A|L)} \\Pr[A=a&#39;|L] \\right]} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.88em;vertical-align:-1.69em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.19em;"><span style="top:-2.11em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">[</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">A</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">L</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">A</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight">a</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">Pr</span><span class="mopen">[</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6779em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal">L</span><span class="mclose">]</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">]</span></span></span></span></span><span style="top:-3.38em;"><span class="pstrut" style="height:3.15em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-4.19em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">[</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">A</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">L</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">A</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight">a</span><span class="mclose mtight">)</span><span class="mord mathnormal mtight" style="margin-right:0.22222em;">Y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">Pr</span><span class="mopen">[</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal">L</span><span class="mclose">]</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">]</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p></li></ul></li></ul><h4 id="technical-point-4-2-pooling-of-stratum-specific-effect-measures" tabindex="-1"><a class="header-anchor" href="#technical-point-4-2-pooling-of-stratum-specific-effect-measures"><span>Technical Point 4.2: Pooling of stratum-specific effect measures</span></a></h4><ul><li><strong>核心理论</strong>: 若无效应修饰，合并层效应（如Mantel-Haenszel）可提高估计精度。</li></ul><h4 id="technical-point-4-3-relation-between-marginal-and-conditional-risk-ratios" tabindex="-1"><a class="header-anchor" href="#technical-point-4-3-relation-between-marginal-and-conditional-risk-ratios"><span>Technical Point 4.3: Relation between marginal and conditional risk ratios</span></a></h4><ul><li><strong>公式</strong>: <ul><li>边际风险比与条件风险比关系:<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi>Pr</mi><mo>⁡</mo><mo stretchy="false">[</mo><msup><mi>Y</mi><mrow><mi>a</mi><mo>=</mo><mn>1</mn></mrow></msup><mo>=</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><mrow><mi>Pr</mi><mo>⁡</mo><mo stretchy="false">[</mo><msup><mi>Y</mi><mrow><mi>a</mi><mo>=</mo><mn>0</mn></mrow></msup><mo>=</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></mfrac><mo>=</mo><munder><mo>∑</mo><mi>l</mi></munder><mrow><mo fence="true">(</mo><mfrac><mrow><mi>Pr</mi><mo>⁡</mo><mo stretchy="false">[</mo><msup><mi>Y</mi><mrow><mi>a</mi><mo>=</mo><mn>1</mn></mrow></msup><mo>=</mo><mn>1</mn><mi mathvariant="normal">∣</mi><mi>L</mi><mo>=</mo><mi>l</mi><mo stretchy="false">]</mo></mrow><mrow><mi>Pr</mi><mo>⁡</mo><mo stretchy="false">[</mo><msup><mi>Y</mi><mrow><mi>a</mi><mo>=</mo><mn>0</mn></mrow></msup><mo>=</mo><mn>1</mn><mi mathvariant="normal">∣</mi><mi>L</mi><mo>=</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></mfrac><mo fence="true">)</mo></mrow><mi>w</mi><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\\frac{\\Pr[Y^{a=1}=1]}{\\Pr[Y^{a=0}=1]} = \\sum_l \\left( \\frac{\\Pr[Y^{a=1}=1|L=l]}{\\Pr[Y^{a=0}=1|L=l]} \\right) w(l) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4271em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">Pr</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">Pr</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.7932em;vertical-align:-1.3021em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">Pr</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1∣</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">]</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">Pr</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1∣</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">)</span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>w</mi><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>Pr</mi><mo>⁡</mo><mo stretchy="false">[</mo><msup><mi>Y</mi><mrow><mi>a</mi><mo>=</mo><mn>0</mn></mrow></msup><mo>=</mo><mn>1</mn><mi mathvariant="normal">∣</mi><mi>L</mi><mo>=</mo><mi>l</mi><mo stretchy="false">]</mo><mi>Pr</mi><mo>⁡</mo><mo stretchy="false">[</mo><mi>L</mi><mo>=</mo><mi>l</mi><mo stretchy="false">]</mo></mrow><mrow><mi>Pr</mi><mo>⁡</mo><mo stretchy="false">[</mo><msup><mi>Y</mi><mrow><mi>a</mi><mo>=</mo><mn>0</mn></mrow></msup><mo>=</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">w(l) = \\frac{\\Pr[Y^{a=0}=1|L=l] \\Pr[L=l]}{\\Pr[Y^{a=0}=1]} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4271em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">Pr</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">Pr</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1∣</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">Pr</span><span class="mopen">[</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p></li></ul></li></ul><hr><p><strong>逻辑连贯性</strong>: 本章扩展前三章单群体因果效应至子群体分析，强调效应修饰概念，为第五章&quot;交互作用&quot;铺垫。所有方法（标准化、IP加权、分层、匹配）均需交换性和正性，但目标效应（边际/条件）决定方法选择。</p>',47))])}const y=m(c,[["render",h]]),f=JSON.parse(`{"path":"/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_4.html","title":"Chapter_4","lang":"en-US","frontmatter":{"title":"Chapter_4","category":"Causal inference","tags":["DeepSeek-R1-0528","response_md"],"description":"### Chapter 4: Effect Modification 4.1 Heterogeneity of treatment effects 技术重点（Technical Points）: 核心理论: 因果效应在总体中可能为零，但在子群体中非零（如性别分层）。效应修饰（effect modification）指处理效应随变量 (V) 水平变化而变...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Chapter_4\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-09-17T03:19:05.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Aaron L\\",\\"url\\":\\"https://aaronlzm.github.io\\",\\"email\\":\\"lzm_aaron@outlook.com\\"}]}"],["meta",{"property":"og:url","content":"https://aaronlzm.github.io/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_4.html"}],["meta",{"property":"og:site_name","content":"Aaron's Blog"}],["meta",{"property":"og:title","content":"Chapter_4"}],["meta",{"property":"og:description","content":"### Chapter 4: Effect Modification 4.1 Heterogeneity of treatment effects 技术重点（Technical Points）: 核心理论: 因果效应在总体中可能为零，但在子群体中非零（如性别分层）。效应修饰（effect modification）指处理效应随变量 (V) 水平变化而变..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-09-17T03:19:05.000Z"}],["meta",{"property":"article:tag","content":"response_md"}],["meta",{"property":"article:tag","content":"DeepSeek-R1-0528"}],["meta",{"property":"article:modified_time","content":"2025-09-17T03:19:05.000Z"}]]},"git":{"createdTime":1758079145000,"updatedTime":1758079145000,"contributors":[{"name":"lizhimou","username":"lizhimou","email":"lizhimou@bytedance.com","commits":1,"url":"https://github.com/lizhimou"}]},"readingTime":{"minutes":7.63,"words":2288},"filePathRelative":"posts/Causal inference/What-if book reading notes/response_md/DeepSeek-R1-0528/Chapter_4.md","excerpt":"\\n### Chapter 4: Effect Modification\\n<h4>4.1 Heterogeneity of treatment effects</h4>\\n<p><strong>技术重点（Technical Points）</strong>:</p>\\n<ul>\\n<li><strong>核心理论</strong>: 因果效应在总体中可能为零，但在子群体中非零（如性别分层）。效应修饰（effect modification）指处理效应随变量 (V) 水平变化而变化的现象。</li>\\n<li><strong>关键公式</strong>:\\n<ul>\\n<li>因果风险差（Additive scale）:<p v-pre=\\"\\" class=\\"katex-block\\"><span class=\\"katex-display\\"><span class=\\"katex\\"><span class=\\"katex-mathml\\"><math xmlns=\\"http://www.w3.org/1998/Math/MathML\\" display=\\"block\\"><semantics><mrow><mi>E</mi><mo stretchy=\\"false\\">[</mo><msup><mi>Y</mi><mrow><mi>a</mi><mo>=</mo><mn>1</mn></mrow></msup><mo>−</mo><msup><mi>Y</mi><mrow><mi>a</mi><mo>=</mo><mn>0</mn></mrow></msup><mi mathvariant=\\"normal\\">∣</mi><mi>V</mi><mo>=</mo><mi>v</mi><mo stretchy=\\"false\\">]</mo></mrow><annotation encoding=\\"application/x-tex\\">E[Y^{a=1} - Y^{a=0} | V = v]\\n</annotation></semantics></math></span><span class=\\"katex-html\\" aria-hidden=\\"true\\"><span class=\\"base\\"><span class=\\"strut\\" style=\\"height:1.1141em;vertical-align:-0.25em;\\"></span><span class=\\"mord mathnormal\\" style=\\"margin-right:0.05764em;\\">E</span><span class=\\"mopen\\">[</span><span class=\\"mord\\"><span class=\\"mord mathnormal\\" style=\\"margin-right:0.22222em;\\">Y</span><span class=\\"msupsub\\"><span class=\\"vlist-t\\"><span class=\\"vlist-r\\"><span class=\\"vlist\\" style=\\"height:0.8641em;\\"><span style=\\"top:-3.113em;margin-right:0.05em;\\"><span class=\\"pstrut\\" style=\\"height:2.7em;\\"></span><span class=\\"sizing reset-size6 size3 mtight\\"><span class=\\"mord mtight\\"><span class=\\"mord mathnormal mtight\\">a</span><span class=\\"mrel mtight\\">=</span><span class=\\"mord mtight\\">1</span></span></span></span></span></span></span></span></span><span class=\\"mspace\\" style=\\"margin-right:0.2222em;\\"></span><span class=\\"mbin\\">−</span><span class=\\"mspace\\" style=\\"margin-right:0.2222em;\\"></span></span><span class=\\"base\\"><span class=\\"strut\\" style=\\"height:1.1141em;vertical-align:-0.25em;\\"></span><span class=\\"mord\\"><span class=\\"mord mathnormal\\" style=\\"margin-right:0.22222em;\\">Y</span><span class=\\"msupsub\\"><span class=\\"vlist-t\\"><span class=\\"vlist-r\\"><span class=\\"vlist\\" style=\\"height:0.8641em;\\"><span style=\\"top:-3.113em;margin-right:0.05em;\\"><span class=\\"pstrut\\" style=\\"height:2.7em;\\"></span><span class=\\"sizing reset-size6 size3 mtight\\"><span class=\\"mord mtight\\"><span class=\\"mord mathnormal mtight\\">a</span><span class=\\"mrel mtight\\">=</span><span class=\\"mord mtight\\">0</span></span></span></span></span></span></span></span></span><span class=\\"mord\\">∣</span><span class=\\"mord mathnormal\\" style=\\"margin-right:0.22222em;\\">V</span><span class=\\"mspace\\" style=\\"margin-right:0.2778em;\\"></span><span class=\\"mrel\\">=</span><span class=\\"mspace\\" style=\\"margin-right:0.2778em;\\"></span></span><span class=\\"base\\"><span class=\\"strut\\" style=\\"height:1em;vertical-align:-0.25em;\\"></span><span class=\\"mord mathnormal\\" style=\\"margin-right:0.03588em;\\">v</span><span class=\\"mclose\\">]</span></span></span></span></span></p>\\n</li>\\n<li>因果风险比（Multiplicative scale）:<p v-pre=\\"\\" class=\\"katex-block\\"><span class=\\"katex-display\\"><span class=\\"katex\\"><span class=\\"katex-mathml\\"><math xmlns=\\"http://www.w3.org/1998/Math/MathML\\" display=\\"block\\"><semantics><mrow><mfrac><mrow><mi>E</mi><mo stretchy=\\"false\\">[</mo><msup><mi>Y</mi><mrow><mi>a</mi><mo>=</mo><mn>1</mn></mrow></msup><mi mathvariant=\\"normal\\">∣</mi><mi>V</mi><mo>=</mo><mi>v</mi><mo stretchy=\\"false\\">]</mo></mrow><mrow><mi>E</mi><mo stretchy=\\"false\\">[</mo><msup><mi>Y</mi><mrow><mi>a</mi><mo>=</mo><mn>0</mn></mrow></msup><mi mathvariant=\\"normal\\">∣</mi><mi>V</mi><mo>=</mo><mi>v</mi><mo stretchy=\\"false\\">]</mo></mrow></mfrac></mrow><annotation encoding=\\"application/x-tex\\">\\\\frac{E[Y^{a=1} | V = v]}{E[Y^{a=0} | V = v]}\\n</annotation></semantics></math></span><span class=\\"katex-html\\" aria-hidden=\\"true\\"><span class=\\"base\\"><span class=\\"strut\\" style=\\"height:2.4271em;vertical-align:-0.936em;\\"></span><span class=\\"mord\\"><span class=\\"mopen nulldelimiter\\"></span><span class=\\"mfrac\\"><span class=\\"vlist-t vlist-t2\\"><span class=\\"vlist-r\\"><span class=\\"vlist\\" style=\\"height:1.4911em;\\"><span style=\\"top:-2.314em;\\"><span class=\\"pstrut\\" style=\\"height:3em;\\"></span><span class=\\"mord\\"><span class=\\"mord mathnormal\\" style=\\"margin-right:0.05764em;\\">E</span><span class=\\"mopen\\">[</span><span class=\\"mord\\"><span class=\\"mord mathnormal\\" style=\\"margin-right:0.22222em;\\">Y</span><span class=\\"msupsub\\"><span class=\\"vlist-t\\"><span class=\\"vlist-r\\"><span class=\\"vlist\\" style=\\"height:0.7401em;\\"><span style=\\"top:-2.989em;margin-right:0.05em;\\"><span class=\\"pstrut\\" style=\\"height:2.7em;\\"></span><span class=\\"sizing reset-size6 size3 mtight\\"><span class=\\"mord mtight\\"><span class=\\"mord mathnormal mtight\\">a</span><span class=\\"mrel mtight\\">=</span><span class=\\"mord mtight\\">0</span></span></span></span></span></span></span></span></span><span class=\\"mord\\">∣</span><span class=\\"mord mathnormal\\" style=\\"margin-right:0.22222em;\\">V</span><span class=\\"mspace\\" style=\\"margin-right:0.2778em;\\"></span><span class=\\"mrel\\">=</span><span class=\\"mspace\\" style=\\"margin-right:0.2778em;\\"></span><span class=\\"mord mathnormal\\" style=\\"margin-right:0.03588em;\\">v</span><span class=\\"mclose\\">]</span></span></span><span style=\\"top:-3.23em;\\"><span class=\\"pstrut\\" style=\\"height:3em;\\"></span><span class=\\"frac-line\\" style=\\"border-bottom-width:0.04em;\\"></span></span><span style=\\"top:-3.677em;\\"><span class=\\"pstrut\\" style=\\"height:3em;\\"></span><span class=\\"mord\\"><span class=\\"mord mathnormal\\" style=\\"margin-right:0.05764em;\\">E</span><span class=\\"mopen\\">[</span><span class=\\"mord\\"><span class=\\"mord mathnormal\\" style=\\"margin-right:0.22222em;\\">Y</span><span class=\\"msupsub\\"><span class=\\"vlist-t\\"><span class=\\"vlist-r\\"><span class=\\"vlist\\" style=\\"height:0.8141em;\\"><span style=\\"top:-3.063em;margin-right:0.05em;\\"><span class=\\"pstrut\\" style=\\"height:2.7em;\\"></span><span class=\\"sizing reset-size6 size3 mtight\\"><span class=\\"mord mtight\\"><span class=\\"mord mathnormal mtight\\">a</span><span class=\\"mrel mtight\\">=</span><span class=\\"mord mtight\\">1</span></span></span></span></span></span></span></span></span><span class=\\"mord\\">∣</span><span class=\\"mord mathnormal\\" style=\\"margin-right:0.22222em;\\">V</span><span class=\\"mspace\\" style=\\"margin-right:0.2778em;\\"></span><span class=\\"mrel\\">=</span><span class=\\"mspace\\" style=\\"margin-right:0.2778em;\\"></span><span class=\\"mord mathnormal\\" style=\\"margin-right:0.03588em;\\">v</span><span class=\\"mclose\\">]</span></span></span></span><span class=\\"vlist-s\\">​</span></span><span class=\\"vlist-r\\"><span class=\\"vlist\\" style=\\"height:0.936em;\\"><span></span></span></span></span></span><span class=\\"mclose nulldelimiter\\"></span></span></span></span></span></span></p>\\n</li>\\n</ul>\\n</li>\\n<li><strong>重要概念</strong>:\\n<ul>\\n<li>定性效应修饰（Qualitative effect modification）: 子群体效应方向相反（如女性有害，男性有益）。</li>\\n<li>效应修饰依赖于效应尺度（如风险差或风险比）。</li>\\n</ul>\\n</li>\\n<li><strong>应用场景</strong>: 评估处理（如心脏移植）在子群体（如性别分组）中的异质性效应。</li>\\n</ul>","autoDesc":true}`);export{y as comp,f as data};
