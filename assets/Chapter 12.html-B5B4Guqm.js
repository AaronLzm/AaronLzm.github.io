import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as l,f as o,b as r}from"./app-p5c8ryjK.js";const i={};function s(a,t){return r(),l("div",null,[...t[0]||(t[0]=[o('<p>以下是《因果推断》第12章的核心内容总结及注意事项，分步梳理关键概念与方法：</p><hr><h3 id="核心内容总结" tabindex="-1"><a class="header-anchor" href="#核心内容总结"><span><strong>核心内容总结</strong></span></a></h3><ol><li><p><strong>研究背景与目标</strong></p><ul><li><strong>因果问题</strong>：估计戒烟（A）对体重增加（Y）的平均因果效应（ACE），即 ( E[Y^{a=1}] - E[Y^{a=0}] )。</li><li><strong>数据来源</strong>：NHEFS（美国国家健康与营养调查随访研究），基线（1971-75）和随访（1982）数据，样本量1566名吸烟者。</li><li><strong>初步关联结果</strong>：戒烟组平均增重4.5kg，非戒烟组2.0kg，差值2.5kg（95% CI: 1.7~3.4），但存在混杂偏倚（如戒烟者年龄更大）。</li></ul></li><li><p><strong>IP加权（逆概率加权）原理</strong></p><ul><li><strong>目的</strong>：创建伪总体（Pseudo-population），消除治疗A与协变量L的关联，实现无混杂比较。</li><li><strong>权重计算</strong>： <ul><li><strong>非稳定权重</strong>：( W_A = 1 / f(A|L) )</li><li><strong>稳定权重</strong>：( SW_A = f(A) / f(A|L) )（更优，减少方差）</li></ul></li><li><strong>步骤</strong>： <ol><li>拟合倾向性评分模型（如Logistic回归）：估计 ( \\text{Pr}[A=1|L] )。</li><li>计算权重：戒烟者 ( SW_A = \\frac{\\text{Pr}[A=1]}{\\text{Pr}[A=1|L]} )，非戒烟者 ( SW_A = \\frac{\\text{Pr}[A=0]}{1 - \\text{Pr}[A=1|L]} )。</li><li>加权分析：拟合加权模型 ( E[Y|A] = \\theta_0 + \\theta_1 A )（最小二乘法）。</li></ol></li><li><strong>结果</strong>：ACE估计值3.4kg（95% CI: 2.4~4.5）。</li></ul></li><li><p><strong>边际结构模型（MSM）</strong></p><ul><li><strong>定义</strong>：直接建模反事实结果均值，如 ( $$E[Y^a] = \\beta_0 + \\beta_1 a $$)（饱和模型）。</li><li><strong>估计方法</strong>： <ul><li>使用IP权重创建伪总体，拟合关联模型 ( E[Y|A] = \\theta_0 + \\theta_ 1 A )（伪总体中关联=因果）。</li><li>参数 ( \\theta_1 ) 估计ACE（( \\beta_1 )）。</li></ul></li><li><strong>扩展应用</strong>： <ul><li><strong>连续处理</strong>（如吸烟量变化ΔA）： <ul><li>模型：($$ E[Y^a] = \\beta_0 + \\beta_1 a + \\beta_2 a^2 $$)（非饱和）。</li><li>需估计条件密度 ( f(A|L) )（假设正态分布，敏感性高）。</li></ul></li><li><strong>二值结局</strong>（如死亡风险）：Logistic MSM ($$ \\text{logit Pr}[D^a=1] = \\alpha_0 + \\alpha_1 a $$)。</li></ul></li></ul></li><li><p><strong>处理缺失数据（删失）</strong></p><ul><li><strong>问题</strong>：仅分析完整数据（C=0）可能引入选择偏倚（删失与A或L相关）。</li><li><strong>解决方案</strong>： <ul><li><strong>联合权重</strong>：( SW_{A,C} = SW_A \\times SW_C )，其中 ( SW_C = \\frac{\\text{Pr}[C=0|A]}{\\text{Pr}[C=0|L,A]} )。</li><li>估计 ( E[Y^{a,c=0}] )（假设无删失下的因果效应）。</li></ul></li><li><strong>结果</strong>：校正后ACE≈3.5kg（与未校正结果相似）。</li></ul></li><li><p><strong>效应修饰（Effect Modification）</strong></p><ul><li><strong>方法</strong>：在MSM中加入协变量（如性别V）： <ul><li>模型：( E[Y^a|V] = \\beta_0 + \\beta_1 a + \\beta_2 V a + \\beta_3 V )。</li><li>使用稳定权重 ( SW_A(V) = f(A|V)/f(A|L) ) 提高效率。</li></ul></li><li><strong>结果</strong>：无证据表明性别修饰戒烟效应（( \\beta_2 ) 95% CI: -2.2~1.9）。</li></ul></li></ol><hr><h3 id="关键注意事项" tabindex="-1"><a class="header-anchor" href="#关键注意事项"><span><strong>关键注意事项</strong></span></a></h3><ol><li><p><strong>倾向性评分模型</strong></p><ul><li><strong>协变量选择</strong>：必须包含所有混杂因子（影响A和Y），禁止包含中介或工具变量。</li><li><strong>模型诊断</strong>： <ul><li>检查权重均值（稳定权重应≈1）。</li><li>平衡性检验（加权后组间协变量SMD&lt;0.1）。</li></ul></li><li><strong>极端权重处理</strong>：裁剪（Trimming）或使用稳定权重减少方差。</li></ul></li><li><p><strong>非正性（Positivity）问题</strong></p><ul><li><strong>类型</strong>： <ul><li><strong>结构性</strong>：某些L下A不可能发生（需限制分析范围）。</li><li><strong>随机性</strong>：有限样本导致的零单元格（用模型平滑插值）。</li></ul></li><li><strong>影响</strong>：非正性时ACE仅适用于可观测子群体（( Q(a) = {l: \\text{Pr}[A=a|L=l]&gt;0} )）。</li></ul></li><li><p><strong>模型误设风险</strong></p><ul><li><strong>倾向性模型</strong>：误设导致偏倚（需验证平衡性）。</li><li><strong>MSM模型</strong>：非饱和模型（如连续处理）对函数形式敏感（可尝试多种分布假设）。</li><li><strong>双稳健估计</strong>：结合倾向性评分与结局模型，提高鲁棒性（第13章）。</li></ul></li><li><p><strong>删失与选择偏倚</strong></p><ul><li><strong>假设</strong>：交换性 ( Y^{a,c=0} \\perp (A,C) | L )（若L含中介变量则可能不成立）。</li><li><strong>敏感分析</strong>：评估删失机制（如比较基线特征）。</li></ul></li><li><p><strong>计算实践</strong></p><ul><li><strong>置信区间</strong>：使用稳健方差估计或自助法（Bootstrap）。</li><li><strong>软件实现</strong>：加权最小二乘法（如R的 <code>lm()</code> 加权重参数）。</li><li><strong>连续处理</strong>：避免直接IP加权（改用参数化g-formula或TMLE，第14章）。</li></ul></li></ol><hr><h3 id="案例特殊性与局限" tabindex="-1"><a class="header-anchor" href="#案例特殊性与局限"><span><strong>案例特殊性与局限</strong></span></a></h3><ul><li><strong>选择偏倚风险</strong>：仅纳入存活至1982年的个体（戒烟状态已知），可能低估效应（死亡与戒烟相关）。</li><li><strong>时变治疗简化</strong>：真实场景中戒烟为时变处理，本章简化处理（时变方法见Part III）。</li><li><strong>协变量控制</strong>：假设9个基线变量（年龄、性别等）足以调整混杂，但未测量未观测混杂因子。</li></ul><hr><h3 id="总结" tabindex="-1"><a class="header-anchor" href="#总结"><span><strong>总结</strong></span></a></h3><p>本章通过NHEFS案例演示了IP加权与MSM的完整流程：</p><ol><li><strong>定义因果问题</strong>→2. <strong>计算IP权重</strong>→3. <strong>拟合MSM</strong>→4. <strong>处理缺失数据</strong>。<br> 核心思想：<strong>利用权重模拟随机试验环境</strong>，在伪总体中估计反事实结果。实践需警惕模型误设、非正性及选择偏倚，并通过诊断确保结果可靠性。</li></ol>',14)])])}const p=n(i,[["render",s]]),u=JSON.parse(`{"path":"/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%2012/Chapter%2012.html","title":"Chapter 12","lang":"en-US","frontmatter":{"title":"Chapter 12","category":"Causal inference","tags":["Chapter 12","What-if book reading notes"],"description":"以下是《因果推断》第12章的核心内容总结及注意事项，分步梳理关键概念与方法： 核心内容总结 研究背景与目标 因果问题：估计戒烟（A）对体重增加（Y）的平均因果效应（ACE），即 ( E[Y^{a=1}] - E[Y^{a=0}] )。 数据来源：NHEFS（美国国家健康与营养调查随访研究），基线（1971-75）和随访（1982）数据，样本量1566名...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Chapter 12\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-09-17T03:19:05.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Aaron L\\",\\"url\\":\\"https://aaronlzm.github.io\\",\\"email\\":\\"lzm_aaron@outlook.com\\"}]}"],["meta",{"property":"og:url","content":"https://aaronlzm.github.io/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%2012/Chapter%2012.html"}],["meta",{"property":"og:site_name","content":"Aaron's Blog"}],["meta",{"property":"og:title","content":"Chapter 12"}],["meta",{"property":"og:description","content":"以下是《因果推断》第12章的核心内容总结及注意事项，分步梳理关键概念与方法： 核心内容总结 研究背景与目标 因果问题：估计戒烟（A）对体重增加（Y）的平均因果效应（ACE），即 ( E[Y^{a=1}] - E[Y^{a=0}] )。 数据来源：NHEFS（美国国家健康与营养调查随访研究），基线（1971-75）和随访（1982）数据，样本量1566名..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-09-17T03:19:05.000Z"}],["meta",{"property":"article:tag","content":"What-if book reading notes"}],["meta",{"property":"article:tag","content":"Chapter 12"}],["meta",{"property":"article:modified_time","content":"2025-09-17T03:19:05.000Z"}]]},"git":{"createdTime":1758079145000,"updatedTime":1758079145000,"contributors":[{"name":"lizhimou","username":"lizhimou","email":"lizhimou@bytedance.com","commits":1,"url":"https://github.com/lizhimou"}]},"readingTime":{"minutes":4.1,"words":1229},"filePathRelative":"posts/Causal inference/What-if book reading notes/Chapter 12/Chapter 12.md","excerpt":"<p>以下是《因果推断》第12章的核心内容总结及注意事项，分步梳理关键概念与方法：</p>\\n<hr>\\n<h3><strong>核心内容总结</strong></h3>\\n<ol>\\n<li>\\n<p><strong>研究背景与目标</strong></p>\\n<ul>\\n<li><strong>因果问题</strong>：估计戒烟（A）对体重增加（Y）的平均因果效应（ACE），即 ( E[Y^{a=1}] - E[Y^{a=0}] )。</li>\\n<li><strong>数据来源</strong>：NHEFS（美国国家健康与营养调查随访研究），基线（1971-75）和随访（1982）数据，样本量1566名吸烟者。</li>\\n<li><strong>初步关联结果</strong>：戒烟组平均增重4.5kg，非戒烟组2.0kg，差值2.5kg（95% CI: 1.7~3.4），但存在混杂偏倚（如戒烟者年龄更大）。</li>\\n</ul>\\n</li>\\n<li>\\n<p><strong>IP加权（逆概率加权）原理</strong></p>\\n<ul>\\n<li><strong>目的</strong>：创建伪总体（Pseudo-population），消除治疗A与协变量L的关联，实现无混杂比较。</li>\\n<li><strong>权重计算</strong>：\\n<ul>\\n<li><strong>非稳定权重</strong>：( W_A = 1 / f(A|L) )</li>\\n<li><strong>稳定权重</strong>：( SW_A = f(A) / f(A|L) )（更优，减少方差）</li>\\n</ul>\\n</li>\\n<li><strong>步骤</strong>：\\n<ol>\\n<li>拟合倾向性评分模型（如Logistic回归）：估计 ( \\\\text{Pr}[A=1|L] )。</li>\\n<li>计算权重：戒烟者 ( SW_A = \\\\frac{\\\\text{Pr}[A=1]}{\\\\text{Pr}[A=1|L]} )，非戒烟者 ( SW_A = \\\\frac{\\\\text{Pr}[A=0]}{1 - \\\\text{Pr}[A=1|L]} )。</li>\\n<li>加权分析：拟合加权模型 ( E[Y|A] = \\\\theta_0 + \\\\theta_1 A )（最小二乘法）。</li>\\n</ol>\\n</li>\\n<li><strong>结果</strong>：ACE估计值3.4kg（95% CI: 2.4~4.5）。</li>\\n</ul>\\n</li>\\n<li>\\n<p><strong>边际结构模型（MSM）</strong></p>\\n<ul>\\n<li><strong>定义</strong>：直接建模反事实结果均值，如 ( $$E[Y^a] = \\\\beta_0 + \\\\beta_1 a $$)（饱和模型）。</li>\\n<li><strong>估计方法</strong>：\\n<ul>\\n<li>使用IP权重创建伪总体，拟合关联模型 ( E[Y|A] = \\\\theta_0 + \\\\theta_ 1 A )（伪总体中关联=因果）。</li>\\n<li>参数 ( \\\\theta_1 ) 估计ACE（( \\\\beta_1 )）。</li>\\n</ul>\\n</li>\\n<li><strong>扩展应用</strong>：\\n<ul>\\n<li><strong>连续处理</strong>（如吸烟量变化ΔA）：\\n<ul>\\n<li>模型：($$ E[Y^a] = \\\\beta_0 + \\\\beta_1 a + \\\\beta_2 a^2 $$)（非饱和）。</li>\\n<li>需估计条件密度 ( f(A|L) )（假设正态分布，敏感性高）。</li>\\n</ul>\\n</li>\\n<li><strong>二值结局</strong>（如死亡风险）：Logistic MSM ($$ \\\\text{logit Pr}[D^a=1] = \\\\alpha_0 + \\\\alpha_1 a $$)。</li>\\n</ul>\\n</li>\\n</ul>\\n</li>\\n<li>\\n<p><strong>处理缺失数据（删失）</strong></p>\\n<ul>\\n<li><strong>问题</strong>：仅分析完整数据（C=0）可能引入选择偏倚（删失与A或L相关）。</li>\\n<li><strong>解决方案</strong>：\\n<ul>\\n<li><strong>联合权重</strong>：( SW_{A,C} = SW_A \\\\times SW_C )，其中 ( SW_C = \\\\frac{\\\\text{Pr}[C=0|A]}{\\\\text{Pr}[C=0|L,A]} )。</li>\\n<li>估计 ( E[Y^{a,c=0}] )（假设无删失下的因果效应）。</li>\\n</ul>\\n</li>\\n<li><strong>结果</strong>：校正后ACE≈3.5kg（与未校正结果相似）。</li>\\n</ul>\\n</li>\\n<li>\\n<p><strong>效应修饰（Effect Modification）</strong></p>\\n<ul>\\n<li><strong>方法</strong>：在MSM中加入协变量（如性别V）：\\n<ul>\\n<li>模型：( E[Y^a|V] = \\\\beta_0 + \\\\beta_1 a + \\\\beta_2 V a + \\\\beta_3 V )。</li>\\n<li>使用稳定权重 ( SW_A(V) = f(A|V)/f(A|L) ) 提高效率。</li>\\n</ul>\\n</li>\\n<li><strong>结果</strong>：无证据表明性别修饰戒烟效应（( \\\\beta_2 ) 95% CI: -2.2~1.9）。</li>\\n</ul>\\n</li>\\n</ol>","autoDesc":true}`);export{p as comp,u as data};
