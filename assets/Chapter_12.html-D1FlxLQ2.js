import{_ as l}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as p,a as e,f as i,w as m,r,b as o,g as a,d as s}from"./app-CYoxshh_.js";const c={};function g(h,n){const t=r("think");return o(),p("div",null,[e(t,null,{default:m(()=>[...n[0]||(n[0]=[a(' We are summarizing Chapter 12 of the book "Causal Inference: What If" by Hernán and Robins. The chapter is titled "IP Weighting and Marginal Structural Models". The chapter is divided into several sections. We will summarize each section in order, extracting technical points and fine points as required. ',-1),s("p",null,"The chapter uses the example of estimating the average causal effect of smoking cessation (treatment A) on weight gain (outcome Y) using data from the NHEFS (National Health and Nutrition Examination Survey Data I Epidemiologic Follow-up Study).",-1),s("p",null,"We will follow the structure of the chapter:",-1),s("p",null,[a("12.1 The causal question"),s("br"),a(" 12.2 Estimating IP weights via modeling"),s("br"),a(" 12.3 Stabilized IP weights"),s("br"),a(" 12.4 Marginal structural models"),s("br"),a(" 12.5 Effect modification and marginal structural models"),s("br"),a(" 12.6 Censoring and missing data")],-1),s("p",null,"We note that the chapter includes a Fine Point (12.1 and 12.2) and a Technical Point (12.1 and 12.2). We will summarize these as they appear.",-1),s("p",null,"Let's begin with section 12.1.",-1)])]),_:1}),n[1]||(n[1]=i(' ### Chapter 12: IP Weighting and Marginal Structural Models <h4 id="_12-1-the-causal-question" tabindex="-1"><a class="header-anchor" href="#_12-1-the-causal-question"><span>12.1 The causal question</span></a></h4><p><strong>技术重点 (Technical Points)</strong>:</p><ul><li><strong>核心理论</strong>: 因果推断的目标是估计吸烟戒烟（处理变量 (A)，1=戒烟，0=未戒烟）对体重增加（结果变量 (Y)，单位kg）的平均因果效应（ACE），定义为反事实均值之差：<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>E</mi><mo stretchy="false">[</mo><msup><mi>Y</mi><mrow><mi>a</mi><mo>=</mo><mn>1</mn></mrow></msup><mo stretchy="false">]</mo><mo>−</mo><mi>E</mi><mo stretchy="false">[</mo><msup><mi>Y</mi><mrow><mi>a</mi><mo>=</mo><mn>0</mn></mrow></msup><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">E[Y^{a=1}] - E[Y^{a=0}] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span></p> 其中 (E[Y^{a=1}]) 表示若全部人群戒烟时的平均增重，(E[Y^{a=0}]) 表示若全部人群未戒烟时的平均增重。</li><li><strong>关键公式</strong>: 观测到的关联性差异 (E[Y|A=1] - E[Y|A=0] = 2.5) kg（95% CI: 1.7, 3.4）不等于因果效应，因存在混杂（如年龄、性别等）。</li><li><strong>重要概念</strong>: <ul><li>混杂变量（Confounders）是既影响处理 (A) 又影响结果 (Y) 的变量（如年龄：戒烟者平均比非戒烟者年长4岁，且年龄独立影响体重）。</li><li>需调整的混杂变量 (L)：性别（0:男,1:女）、年龄（岁）、种族（0:白人,1:其他）、教育（5级）、吸烟强度（每日支数）、吸烟年限、日常活动量（3级）、运动量（3级）、基线体重（kg）——共9维变量。</li></ul></li><li><strong>应用场景</strong>: 使用NHEFS观测数据估计戒烟对体重增加的因果效应，需通过IP加权调整混杂。</li></ul><p><strong>细节要点 (Fine Points)</strong>:</p><ul><li><strong>案例分析</strong>: 基于1566名25-74岁吸烟者的数据（基线：1971-75年；随访：1982年）。戒烟组平均增重4.5kg，非戒烟组2.0kg。</li><li><strong>辅助信息</strong>: 表12.1显示戒烟组与非戒烟组基线特征差异（如戒烟组年龄更大、男性比例更高）。</li><li><strong>相关背景</strong>: 观测性研究中，直接比较处理组与对照组会导致偏倚，因两组基线特征不均衡（Fine Point 12.1指出可能存在选择偏倚，但本章暂忽略）。</li></ul><hr><h4 id="_12-2-estimating-ip-weights-via-modeling" tabindex="-1"><a class="header-anchor" href="#_12-2-estimating-ip-weights-via-modeling"><span>12.2 Estimating IP weights via modeling</span></a></h4><p><strong>技术重点 (Technical Points)</strong>:</p><ul><li><strong>核心理论</strong>: IP加权通过权重 (W^A = 1 / f(A|L)) 创建伪总体（pseudo-population），其中 (A) 与 (L) 独立，且 (E_{ps}[Y|A=a]) 等于实际总体的标准化均值 (\\sum_l E[Y|A=a,L=l] \\Pr[L=l])。若条件可交换性 (Y^a \\perp!!!\\perp A | L) 成立，则伪总体中关联即因果。</li><li><strong>关键公式</strong>: <ul><li>二分处理 (A) 的倾向评分：(\\Pr[A=1|L])（通过Logistic回归估计）。</li><li>饱和线性模型：(E[Y|A] = \\theta_0 + \\theta_1 A)，加权最小二乘估计（权重 (\\hat{W}^A))。</li></ul></li><li><strong>重要概念</strong>: <ul><li>高维数据下需参数化估计 (\\Pr[A=1|L])（非参数方法因&quot;维数诅咒&quot;不可行）。</li><li>使用Hajek估计量（Technical Point 12.1）提高稳定性：<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>E</mi><mo>^</mo></mover><mo stretchy="false">[</mo><msup><mi>Y</mi><mi>a</mi></msup><mo stretchy="false">]</mo><mo>=</mo><mfrac><mrow><munder><mo>∑</mo><mi>i</mi></munder><msubsup><mover accent="true"><mi>W</mi><mo>^</mo></mover><mi>i</mi><mi>A</mi></msubsup><mi>I</mi><mo stretchy="false">(</mo><msub><mi>A</mi><mi>i</mi></msub><mo>=</mo><mi>a</mi><mo stretchy="false">)</mo><msub><mi>Y</mi><mi>i</mi></msub></mrow><mrow><munder><mo>∑</mo><mi>i</mi></munder><msubsup><mover accent="true"><mi>W</mi><mo>^</mo></mover><mi>i</mi><mi>A</mi></msubsup><mi>I</mi><mo stretchy="false">(</mo><msub><mi>A</mi><mi>i</mi></msub><mo>=</mo><mi>a</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\\hat{E}[Y^a] = \\frac{\\sum_i \\hat{W}_i^A I(A_i=a) Y_i}{\\sum_i \\hat{W}_i^A I(A_i=a)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1968em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.773em;vertical-align:-1.1365em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6365em;"><span style="top:-2.1632em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8231em;"><span style="top:-2.4231em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.6897em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4413em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1365em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p></li></ul></li><li><strong>应用场景</strong>: 通过Logistic回归拟合 (\\Pr[A=1|L])（含年龄、体重等变量的线性/二次项），计算权重后拟合加权线性模型。</li></ul><p><strong>细节要点 (Fine Points)</strong>:</p><ul><li><strong>案例分析</strong>: 估计 (\\hat{\\theta}_1 = 3.4) kg（95% CI: 2.4, 4.5），即戒烟平均增重3.4kg。</li><li><strong>辅助信息</strong>: <ul><li>权重范围：1.05–16.7，均值2.00。</li><li>方差估计：使用稳健方差（保守置信区间）或自助法（bootstrapping）。</li></ul></li><li><strong>相关背景</strong>: 若 (\\Pr[A=1|L]) 模型错误指定，估计将偏倚（Technical Point 12.1讨论非正概率下的估计问题）。</li></ul><hr><h4 id="_12-3-stabilized-ip-weights" tabindex="-1"><a class="header-anchor" href="#_12-3-stabilized-ip-weights"><span>12.3 Stabilized IP weights</span></a></h4><p><strong>技术重点 (Technical Points)</strong>:</p><ul><li><strong>核心理论</strong>: 稳定化权重 (SW^A = f(A) / f(A|L)) 创建相同大小的伪总体（权重均值=1），其因果效应估计与非稳定化权重 (W^A) 一致，但置信区间更窄（尤其当加权模型非饱和时）。</li><li><strong>关键公式</strong>: <ul><li>分子 (f(A)) 通过边际概率估计（如 (\\Pr[A=1] = 403/1566))。</li><li>二分处理下，(SW^A = \\frac{\\Pr[A=1]}{\\Pr[A=1|L]})（戒烟组）或 (\\frac{\\Pr[A=0]}{1 - \\Pr[A=1|L]})（非戒烟组）。</li></ul></li><li><strong>重要概念</strong>: 稳定化权重减少权重变异性，提高统计效率。</li><li><strong>应用场景</strong>: 同12.2节，估计 (\\hat{\\theta}_1 = 3.4) kg（95% CI: 2.4, 4.5），权重范围0.33–4.30，均值1.00。</li></ul><p><strong>细节要点 (Fine Points)</strong>:</p><ul><li><strong>辅助信息</strong>: 需检查权重均值是否为1（偏离提示模型错误或非正概率）。</li><li><strong>案例分析</strong>: Fine Point 12.2讨论非正概率问题： <ul><li><strong>结构非正</strong>（Structural nonpositivity）：某些 (L) 下处理概率为0（如66岁白人女性戒烟概率为0），需限制推断范围。</li><li><strong>随机非正</strong>（Random nonpositivity）：有限样本导致的零单元（通过参数模型插值处理）。</li></ul></li></ul><hr><h4 id="_12-4-marginal-structural-models" tabindex="-1"><a class="header-anchor" href="#_12-4-marginal-structural-models"><span>12.4 Marginal structural models</span></a></h4><p><strong>技术重点 (Technical Points)</strong>:</p><ul><li><strong>核心理论</strong>: 边际结构模型（MSM）直接建模反事实均值 (E[Y^a])，如： <ul><li>二分处理：(E[Y^a] = \\beta_0 + \\beta_1 a)（饱和模型）。</li><li>连续处理（如吸烟强度变化量 (A)）：(E[Y^a] = \\beta_0 + \\beta_1 a + \\beta_2 a^2)（非饱和）。</li></ul></li><li><strong>关键公式</strong>: <ul><li>因果效应：(E[Y^{a=20}] - E[Y^{a=0}] = 20\\beta_1 + 400\\beta_2)。</li><li>估计：用稳定化权重 (SW^A) 创建伪总体，拟合关联模型 (E[Y|A] = \\theta_0 + \\theta_1 A + \\theta_2 A^2)。</li></ul></li><li><strong>重要概念</strong>: <ul><li>连续处理需估计条件密度 (f(A|L))（假设正态分布，用线性回归建模）。</li><li>MSM具有零保护性（Null preservation）：无因果效应时模型不会误设。</li></ul></li><li><strong>应用场景</strong>: <ul><li>连续处理示例：(\\hat{\\beta}_0 = 2.005, \\hat{\\beta}_1 = -0.109, \\hat{\\beta}_2 = 0.003)，吸烟强度增加20支/日的效应为1.10kg。</li><li>二分结局（如死亡风险）：Logistic MSM (\\text{logit} \\Pr[D^a=1] = \\alpha_0 + \\alpha_1 a)，估计OR=1.0（95% CI: 0.8, 1.4）。</li></ul></li></ul><p><strong>细节要点 (Fine Points)</strong>:</p><ul><li><strong>辅助信息</strong>: 连续处理的权重估计对模型敏感（需稳健方法）。</li><li><strong>相关背景</strong>: 高维连续处理下，(f(A|L)) 估计不稳定（研究前沿：Imai &amp; Ratkovic 2015）。</li></ul><hr><h4 id="_12-5-effect-modification-and-marginal-structural-models" tabindex="-1"><a class="header-anchor" href="#_12-5-effect-modification-and-marginal-structural-models"><span>12.5 Effect modification and marginal structural models</span></a></h4><p><strong>技术重点 (Technical Points)</strong>:</p><ul><li><strong>核心理论</strong>: 在MSM中加入协变量 (V)（如性别）评估效应修饰：<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>E</mi><mo stretchy="false">[</mo><msup><mi>Y</mi><mi>a</mi></msup><mi mathvariant="normal">∣</mi><mi>V</mi><mo stretchy="false">]</mo><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><mi>a</mi><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><mi>V</mi><mi>a</mi><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub><mi>V</mi></mrow><annotation encoding="application/x-tex">E[Y^a | V] = \\beta_0 + \\beta_1 a + \\beta_2 V a + \\beta_3 V </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">Va</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></span></p><ul><li>(\\beta_2 \\neq 0) 表示加法效应修饰。</li></ul></li><li><strong>关键公式</strong>: 使用稳定化权重 (SW^A(V) = f(A|V) / f(A|L)) 提高效率（缩小CI）。</li><li><strong>重要概念</strong>: <ul><li>(V) 需包含在混杂集 (L) 中以保证估计效率。</li><li>若MSM包含所有 (L)（&quot;伪MSM&quot;），则无需加权（等价于结局回归调整）。</li></ul></li><li><strong>应用场景</strong>: 性别修饰效应估计 (\\hat{\\theta}_2 = -0.15)（95% CI: -2.2, 1.9），无修饰证据。</li></ul><p><strong>细节要点 (Fine Points)</strong>:</p><ul><li><strong>辅助信息</strong>: 效应修饰与混杂调整逻辑不同：前者通过乘积项，后者通过IP加权。</li></ul><hr><h4 id="_12-6-censoring-and-missing-data" tabindex="-1"><a class="header-anchor" href="#_12-6-censoring-and-missing-data"><span>12.6 Censoring and missing data</span></a></h4><p><strong>技术重点 (Technical Points)</strong>:</p><ul><li><strong>核心理论</strong>: 若结局存在删失（(C=1) 缺失，(C=0) 观测），需使用联合处理 ((A,C)) 的IP权重 (W^{A,C} = W^A \\times W^C) 调整混杂和选择偏倚： <ul><li>(W^C = 1 / \\Pr[C=0|L,A])（非稳定化），或 (SW^C = \\Pr[C=0|A] / \\Pr[C=0|L,A])（稳定化）。</li></ul></li><li><strong>关键公式</strong>: 目标参数 (E[Y^{a,c=0}])（无人删失时的反事实均值）。</li><li><strong>重要概念</strong>: 需满足联合可交换性 (Y^{a,c=0} \\perp!!!\\perp (A,C) | L)、正概率和一致性。</li><li><strong>应用场景</strong>: 估计删失权重后，(\\hat{\\theta}_1 = 3.5) kg（95% CI: 2.5, 4.5），与未调整结果相似。</li></ul><p><strong>细节要点 (Fine Points)</strong>:</p><ul><li><strong>案例分析</strong>: 删失率：戒烟组5.8% vs. 非戒烟组3.2%；删失者基线体重更高（76.6kg vs. 70.8kg）。</li><li><strong>辅助信息</strong>: 稳定化权重 (SW^{A,C}) 范围0.35–4.09，均值1.00（Technical Point 12.2讨论稳定化权重的一般形式）。</li></ul><hr><h3 id="逻辑连贯性说明" tabindex="-1"><a class="header-anchor" href="#逻辑连贯性说明"><span>逻辑连贯性说明</span></a></h3><p>本章延续第2章IP加权基础，扩展至高维数据和连续处理场景，并引入边际结构模型（MSM）统一因果效应表达。12.6节衔接第8章选择偏倚问题，为第III部分时变处理铺垫。所有方法基于NHEFS案例，强调从非参数到参数化建模的必要性。</p>',39))])}const y=l(c,[["render",g]]),v=JSON.parse(`{"path":"/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_12.html","title":"Chapter_12","lang":"en-US","frontmatter":{"title":"Chapter_12","category":"Causal inference","tags":["DeepSeek-R1-0528","response_md"],"description":"### Chapter 12: IP Weighting and Marginal Structural Models 12.1 The causal question 技术重点 (Technical Points): 核心理论: 因果推断的目标是估计吸烟戒烟（处理变量 (A)，1=戒烟，0=未戒烟）对体重增加（结果变量 (Y)，单位kg）的平均因果效...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Chapter_12\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-09-17T03:19:05.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Aaron L\\",\\"url\\":\\"https://aaronlzm.github.io\\",\\"email\\":\\"lzm_aaron@outlook.com\\"}]}"],["meta",{"property":"og:url","content":"https://aaronlzm.github.io/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_12.html"}],["meta",{"property":"og:site_name","content":"Aaron's Blog"}],["meta",{"property":"og:title","content":"Chapter_12"}],["meta",{"property":"og:description","content":"### Chapter 12: IP Weighting and Marginal Structural Models 12.1 The causal question 技术重点 (Technical Points): 核心理论: 因果推断的目标是估计吸烟戒烟（处理变量 (A)，1=戒烟，0=未戒烟）对体重增加（结果变量 (Y)，单位kg）的平均因果效..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-09-17T03:19:05.000Z"}],["meta",{"property":"article:tag","content":"response_md"}],["meta",{"property":"article:tag","content":"DeepSeek-R1-0528"}],["meta",{"property":"article:modified_time","content":"2025-09-17T03:19:05.000Z"}]]},"git":{"createdTime":1758079145000,"updatedTime":1758079145000,"contributors":[{"name":"lizhimou","username":"lizhimou","email":"lizhimou@bytedance.com","commits":1,"url":"https://github.com/lizhimou"}]},"readingTime":{"minutes":7.01,"words":2103},"filePathRelative":"posts/Causal inference/What-if book reading notes/response_md/DeepSeek-R1-0528/Chapter_12.md","excerpt":"\\n### Chapter 12: IP Weighting and Marginal Structural Models\\n<h4>12.1 The causal question</h4>\\n<p><strong>技术重点 (Technical Points)</strong>:</p>\\n<ul>\\n<li><strong>核心理论</strong>: 因果推断的目标是估计吸烟戒烟（处理变量 (A)，1=戒烟，0=未戒烟）对体重增加（结果变量 (Y)，单位kg）的平均因果效应（ACE），定义为反事实均值之差：<p v-pre=\\"\\" class=\\"katex-block\\"><span class=\\"katex-display\\"><span class=\\"katex\\"><span class=\\"katex-mathml\\"><math xmlns=\\"http://www.w3.org/1998/Math/MathML\\" display=\\"block\\"><semantics><mrow><mi>E</mi><mo stretchy=\\"false\\">[</mo><msup><mi>Y</mi><mrow><mi>a</mi><mo>=</mo><mn>1</mn></mrow></msup><mo stretchy=\\"false\\">]</mo><mo>−</mo><mi>E</mi><mo stretchy=\\"false\\">[</mo><msup><mi>Y</mi><mrow><mi>a</mi><mo>=</mo><mn>0</mn></mrow></msup><mo stretchy=\\"false\\">]</mo></mrow><annotation encoding=\\"application/x-tex\\">E[Y^{a=1}] - E[Y^{a=0}]\\n</annotation></semantics></math></span><span class=\\"katex-html\\" aria-hidden=\\"true\\"><span class=\\"base\\"><span class=\\"strut\\" style=\\"height:1.1141em;vertical-align:-0.25em;\\"></span><span class=\\"mord mathnormal\\" style=\\"margin-right:0.05764em;\\">E</span><span class=\\"mopen\\">[</span><span class=\\"mord\\"><span class=\\"mord mathnormal\\" style=\\"margin-right:0.22222em;\\">Y</span><span class=\\"msupsub\\"><span class=\\"vlist-t\\"><span class=\\"vlist-r\\"><span class=\\"vlist\\" style=\\"height:0.8641em;\\"><span style=\\"top:-3.113em;margin-right:0.05em;\\"><span class=\\"pstrut\\" style=\\"height:2.7em;\\"></span><span class=\\"sizing reset-size6 size3 mtight\\"><span class=\\"mord mtight\\"><span class=\\"mord mathnormal mtight\\">a</span><span class=\\"mrel mtight\\">=</span><span class=\\"mord mtight\\">1</span></span></span></span></span></span></span></span></span><span class=\\"mclose\\">]</span><span class=\\"mspace\\" style=\\"margin-right:0.2222em;\\"></span><span class=\\"mbin\\">−</span><span class=\\"mspace\\" style=\\"margin-right:0.2222em;\\"></span></span><span class=\\"base\\"><span class=\\"strut\\" style=\\"height:1.1141em;vertical-align:-0.25em;\\"></span><span class=\\"mord mathnormal\\" style=\\"margin-right:0.05764em;\\">E</span><span class=\\"mopen\\">[</span><span class=\\"mord\\"><span class=\\"mord mathnormal\\" style=\\"margin-right:0.22222em;\\">Y</span><span class=\\"msupsub\\"><span class=\\"vlist-t\\"><span class=\\"vlist-r\\"><span class=\\"vlist\\" style=\\"height:0.8641em;\\"><span style=\\"top:-3.113em;margin-right:0.05em;\\"><span class=\\"pstrut\\" style=\\"height:2.7em;\\"></span><span class=\\"sizing reset-size6 size3 mtight\\"><span class=\\"mord mtight\\"><span class=\\"mord mathnormal mtight\\">a</span><span class=\\"mrel mtight\\">=</span><span class=\\"mord mtight\\">0</span></span></span></span></span></span></span></span></span><span class=\\"mclose\\">]</span></span></span></span></span></p>\\n其中 (E[Y^{a=1}]) 表示若全部人群戒烟时的平均增重，(E[Y^{a=0}]) 表示若全部人群未戒烟时的平均增重。</li>\\n<li><strong>关键公式</strong>: 观测到的关联性差异 (E[Y|A=1] - E[Y|A=0] = 2.5) kg（95% CI: 1.7, 3.4）不等于因果效应，因存在混杂（如年龄、性别等）。</li>\\n<li><strong>重要概念</strong>:\\n<ul>\\n<li>混杂变量（Confounders）是既影响处理 (A) 又影响结果 (Y) 的变量（如年龄：戒烟者平均比非戒烟者年长4岁，且年龄独立影响体重）。</li>\\n<li>需调整的混杂变量 (L)：性别（0:男,1:女）、年龄（岁）、种族（0:白人,1:其他）、教育（5级）、吸烟强度（每日支数）、吸烟年限、日常活动量（3级）、运动量（3级）、基线体重（kg）——共9维变量。</li>\\n</ul>\\n</li>\\n<li><strong>应用场景</strong>: 使用NHEFS观测数据估计戒烟对体重增加的因果效应，需通过IP加权调整混杂。</li>\\n</ul>","autoDesc":true}`);export{y as comp,v as data};
