import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as n,a as r,f as o,d as e,w as l,g as a,r as g,b as d}from"./app-BPhnXKse.js";const u={};function p(c,t){const i=g("think");return d(),n("div",null,[r(i,null,{default:l(()=>[...t[0]||(t[0]=[a(' We are summarizing Chapter 14 of the book "Causal Inference: What If" on G-estimation of Structural Nested Models. The chapter introduces g-estimation as a third method (after IP weighting and standardization) to estimate the average causal effect of smoking cessation on weight gain using the NHEFS data. ',-1),e("p",null,"The chapter is structured as follows:",-1),e("p",null,[a("14.1 The causal question revisited"),e("br"),a(" 14.2 Exchangeability revisited"),e("br"),a(" 14.3 Structural nested mean models"),e("br"),a(" 14.4 Rank preservation"),e("br"),a(" 14.5 G-estimation"),e("br"),a(" 14.6 Structural nested models with two or more parameters")],-1),e("p",null,"We will summarize each section in turn, extracting technical points and fine points as required.",-1),e("p",null,"Note: The images (Figures 14.1, 14.2, 14.3) are described in the text. We will summarize the descriptions as per the text.",-1),e("p",null,"Let's proceed step by step.",-1)])]),_:1}),t[1]||(t[1]=o(' ### Chapter 14: G-ESTIMATION OF STRUCTURAL NESTED MODELS **Link to Previous Chapters**: This chapter introduces g-estimation as a third method (alongside IP weighting and standardization from Chapters 12–13) to estimate the average causal effect of smoking cessation (\\(A\\)) on weight gain (\\(Y\\)) using the NHEFS dataset. G-methods (IP weighting, standardization, g-estimation) are designed for time-varying treatments but are applied here to a time-fixed treatment for pedagogical clarity. <hr><h4 id="_14-1-the-causal-question-revisited" tabindex="-1"><a class="header-anchor" href="#_14-1-the-causal-question-revisited"><span>14.1 The Causal Question Revisited</span></a></h4><p><strong>Technical Focus</strong>:</p><ul><li><strong>Data and Assumptions</strong>: Analysis restricted to 1,566 individuals with complete baseline (1971–75) and follow-up (1982) data on covariates (L): sex, age, race, education, smoking intensity/duration, physical activity, exercise, and alcohol use.</li><li><strong>Causal Effect Definition</strong>: The average causal effect on the difference scale is (E[Y^{a=1,c=0}] - E[Y^{a=0,c=0}]), representing the difference in mean weight if all were treated (quit smoking) versus untreated, with no censoring ((c=0)).</li><li><strong>Subgroup Effects</strong>: Interest extends to conditional effects within strata of (L) (e.g., age 45: (E[Y^{a=1,c=0}| \\text{age}=45] - E[Y^{a=0,c=0}|\\text{age}=45])). Marginal structural models (Chapter 12) or standardization (Chapter 13) can estimate subgroup effects.</li></ul><p><strong>Details</strong>:</p><ul><li><strong>Stratification Challenge</strong>: With many strata (e.g., {non-quitter, female, white, age 26, college dropout, etc.}), large datasets or model-based approaches (e.g., adding (L \\times A) product terms to marginal structural models) are needed.</li></ul><hr><h4 id="_14-2-exchangeability-revisited" tabindex="-1"><a class="header-anchor" href="#_14-2-exchangeability-revisited"><span>14.2 Exchangeability Revisited</span></a></h4><p><strong>Technical Focus</strong>:</p><ul><li><strong>Conditional Exchangeability</strong>: (Y^a \\perp!!!\\perp A | L) for (a = {0, 1}), implying equal outcome distributions under the same treatment within (L)-strata.</li><li><strong>Equivalent Definition</strong>: (\\text{Pr}[A=1|Y^{a=0}, L] = \\text{Pr}[A=1|L]).</li><li><strong>Logistic Model for G-Estimation</strong>:<br> (\\text{logit Pr}[A=1|Y^{a=0}, L] = \\alpha_0 + \\alpha_1 Y^{a=0} + \\alpha_2 L),<br> where (\\alpha_2 L = \\sum_{j=1}^p \\alpha_{2j} L_j). Under exchangeability, (\\alpha_1 = 0).</li></ul><p><strong>Details</strong>:</p><ul><li><strong>Purpose</strong>: This re-expression facilitates g-estimation by linking counterfactual outcomes to treatment assignment.</li></ul><hr><h4 id="_14-3-structural-nested-mean-models" tabindex="-1"><a class="header-anchor" href="#_14-3-structural-nested-mean-models"><span>14.3 Structural Nested Mean Models</span></a></h4><p><strong>Technical Focus</strong>:</p><ul><li><strong>Model Definition</strong>:<br> (E[Y^a - Y^{a=0} | A=a, L] = \\beta_1 a + \\beta_2 a L),<br> where (\\beta_1 + \\beta_2 L) quantifies the conditional average causal effect within ((A, L)) strata.</li><li><strong>Semiparametric Nature</strong>: Unlike parametric g-formula models, structural nested models omit intercept ((\\beta_0)) and main effects of (L) ((\\beta_3 L)), enhancing robustness.</li><li><strong>Censoring Adjustment</strong>: For censoring (C), nonstabilized IP weights (W^C = 1 / \\text{Pr}[C=0|L, A]) create a pseudo-population without censoring.</li></ul><p><strong>Key Formulas</strong>:</p><ul><li>Additive causal effect: (E[Y^a - Y^{a=0}|L] = \\beta_1 a + \\beta_2 a L).</li><li>With censoring: Model becomes (E[Y^{a,c=0} - Y^{a=0,c=0}|A=a, L] = \\beta_1 a + \\beta_2 a L).</li></ul><p><strong>Details</strong>:</p><ul><li><strong>Comparison to Other Models</strong>: <ul><li>Marginal structural models estimate population-average effects; structural nested models estimate within-(L) effects.</li><li>Semiparametric marginal structural models (leaving (E[Y^{a=0}|V]) unspecified) are equivalent to structural nested models when (V \\subset L) (See <strong>Fine Point 14.1</strong>).</li></ul></li></ul><hr><h4 id="_14-4-rank-preservation" tabindex="-1"><a class="header-anchor" href="#_14-4-rank-preservation"><span>14.4 Rank Preservation</span></a></h4><p><strong>Technical Focus</strong>:</p><ul><li><strong>Additive Rank Preservation</strong>: Assumes constant individual causal effect within (L)-strata:<br> (Y_i^a - Y_i^{a=0} = \\psi_1 a + \\psi_2 a L_i) for all (i).</li><li><strong>Implausibility</strong>: Individual treatment effects (e.g., weight gain after smoking cessation) vary biologically, making rank preservation unrealistic.</li></ul><p><strong>Details</strong>:</p><ul><li><strong>Role in G-Estimation</strong>: Rank-preserving models simplify g-estimation intuition but are not required for validity. Structural nested mean models do not assume rank preservation.</li><li><strong>Visualization</strong>: <ul><li><strong>Figure 14.1/14.2</strong>: Show rank preservation within strata (L=l) and (L=l&#39;) with constant shifts (\\psi_1 + \\psi_2 l).</li><li><strong>Figure 14.3</strong>: Illustrates non-rank-preserving scenario with variable individual shifts.</li></ul></li></ul><hr><h4 id="_14-5-g-estimation" tabindex="-1"><a class="header-anchor" href="#_14-5-g-estimation"><span>14.5 G-Estimation</span></a></h4><p><strong>Technical Focus</strong>:</p><ul><li><strong>Rank-Preserving Model</strong>: (Y^{a=0} = Y - \\psi_1 A).</li><li><strong>Procedure</strong>: <ol><li>Compute candidate counterfactuals (H(\\psi^\\dagger) = Y - \\psi^\\dagger A).</li><li>Fit logistic model: (\\text{logit Pr}[A=1|H(\\psi^\\dagger), L] = \\alpha_0 + \\alpha_1 H(\\psi^\\dagger) + \\alpha_2 L).</li><li>Find (\\psi^\\dagger) such that (\\alpha_1 = 0) (indicating (H(\\psi^\\dagger) \\perp!!!\\perp A | L)).</li></ol></li><li><strong>Estimation</strong>: <ul><li>Point estimate: (\\hat{\\psi}_1 = 3.4) kg (for smoking cessation effect).</li><li>95% CI: ([2.5, 4.5]) kg (by test inversion or bootstrapping).</li></ul></li><li><strong>Censoring Adjustment</strong>: Uncensored individuals ((C=0)) weighted by (W^C).</li></ul><p><strong>Key Insight</strong>:</p><ul><li>Validity requires correct specification of the structural mean model, not rank preservation.</li><li><strong>Sensitivity Analysis</strong>: For unmeasured confounding, test (\\alpha_1 = \\delta) (expected deviation from 0) instead of (\\alpha_1 = 0) (See <strong>Fine Point 14.2</strong>).</li></ul><hr><h4 id="_14-6-structural-nested-models-with-two-or-more-parameters" tabindex="-1"><a class="header-anchor" href="#_14-6-structural-nested-models-with-two-or-more-parameters"><span>14.6 Structural Nested Models with Two or More Parameters</span></a></h4><p><strong>Technical Focus</strong>:</p><ul><li><strong>Model with Effect Modification</strong>:<br> (E[Y^a - Y^{a=0}|A=a, L] = \\beta_1 a + \\beta_2 a V) (e.g., (V = \\text{smoking intensity})).</li><li><strong>G-Estimation</strong>: <ul><li>Define (H(\\beta^\\dagger) = Y - \\beta_1^\\dagger A - \\beta_2^\\dagger A V).</li><li>Fit logistic model: (\\text{logit Pr}[A=1|H(\\beta^\\dagger), L] = \\alpha_0 + \\alpha_1 H(\\beta^\\dagger) + \\alpha_2 H(\\beta^\\dagger)V + \\alpha_3 L).</li><li>Solve for (\\beta^\\dagger) where (\\alpha_1 = \\alpha_2 = 0).</li></ul></li><li><strong>Closed-Form Solution</strong>: For linear models, estimators exist without parameter search.</li></ul><p><strong>Results</strong>:</p><ul><li>Estimates: (\\hat{\\beta}_1 = 2.86), (\\hat{\\beta}_2 = 0.03).</li><li>Population effect: (\\beta_1 + \\frac{1}{n} \\sum_i \\sum_j \\beta_{2j} L_{ij}).</li></ul><p><strong>Details</strong>:</p><ul><li><strong>Misspecification Risk</strong>: Omitting product terms (e.g., (\\beta_2 a V)) biases estimates if effect modification exists.</li><li><strong>Null Preservation</strong>: Structural nested models preserve the null hypothesis (no effect) correctly.</li></ul><hr><h3 id="technical-points-summary" tabindex="-1"><a class="header-anchor" href="#technical-points-summary"><span>Technical Points Summary</span></a></h3>',43)),t[2]||(t[2]=e("ul",null,[e("li",null,[e("strong",null,"14.1 Multiplicative Models"),a(": For non-negative/binary outcomes, multiplicative structural nested models (e.g., (\\log \\frac{E[Y"),e("sup",{a:"0"},"a|A=a,L]}{E[Y"),a("|A=a,L]} = \\beta_1 a + \\beta_2 a L)) avoid rare-outcome restrictions.")]),e("li",null,[e("strong",null,"14.2 G-Estimation Equations"),a(": Closed-form solutions exist for linear models. Doubly robust estimators combine models for (E[A|L]) and (E[Y^{a=0}|L]).")])],-1)),t[3]||(t[3]=e("h3",{id:"figures",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#figures"},[e("span",null,"Figures")])],-1)),t[4]||(t[4]=e("ul",null,[e("li",null,[e("strong",null,"Figures 14.1–14.3"),a(": Illustrate rank preservation (constant shift within (L)-strata) vs. non-preservation (variable shifts). Descriptions align with bell-shaped distributions of (Y^{a=0}) and (Y^{a=1}).")])],-1)),t[5]||(t[5]=e("hr",null,null,-1)),t[6]||(t[6]=e("p",null,[e("strong",null,"Conclusion"),a(": G-estimation provides a flexible, semiparametric approach to estimate conditional causal effects, robust to model misspecification when combined with IP weighting for censoring. Its extension to sensitivity analyses enhances applicability in observational studies.")],-1))])}const f=s(u,[["render",p]]),b=JSON.parse(`{"path":"/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/Chapter_14.html","title":"Chapter_14","lang":"en-US","frontmatter":{"title":"Chapter_14","category":"Causal inference","tags":["DeepSeek-R1-0528-2nd","response_md"],"description":"### Chapter 14: G-ESTIMATION OF STRUCTURAL NESTED MODELS **Link to Previous Chapters**: This chapter introduces g-estimation as a third method (alongside IP weighting and standa...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Chapter_14\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-09-17T03:19:05.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Aaron L\\",\\"url\\":\\"https://aaronlzm.github.io\\",\\"email\\":\\"lzm_aaron@outlook.com\\"}]}"],["meta",{"property":"og:url","content":"https://aaronlzm.github.io/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/Chapter_14.html"}],["meta",{"property":"og:site_name","content":"Aaron's Blog"}],["meta",{"property":"og:title","content":"Chapter_14"}],["meta",{"property":"og:description","content":"### Chapter 14: G-ESTIMATION OF STRUCTURAL NESTED MODELS **Link to Previous Chapters**: This chapter introduces g-estimation as a third method (alongside IP weighting and standa..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-09-17T03:19:05.000Z"}],["meta",{"property":"article:tag","content":"response_md"}],["meta",{"property":"article:tag","content":"DeepSeek-R1-0528-2nd"}],["meta",{"property":"article:modified_time","content":"2025-09-17T03:19:05.000Z"}]]},"git":{"createdTime":1758079145000,"updatedTime":1758079145000,"contributors":[{"name":"lizhimou","username":"lizhimou","email":"lizhimou@bytedance.com","commits":1,"url":"https://github.com/lizhimou"}]},"readingTime":{"minutes":3.87,"words":1162},"filePathRelative":"posts/Causal inference/What-if book reading notes/response_md/DeepSeek-R1-0528-2nd/Chapter_14.md","excerpt":"\\n### Chapter 14: G-ESTIMATION OF STRUCTURAL NESTED MODELS  \\n**Link to Previous Chapters**: This chapter introduces g-estimation as a third method (alongside IP weighting and standardization from Chapters 12–13) to estimate the average causal effect of smoking cessation (\\\\(A\\\\)) on weight gain (\\\\(Y\\\\)) using the NHEFS dataset. G-methods (IP weighting, standardization, g-estimation) are designed for time-varying treatments but are applied here to a time-fixed treatment for pedagogical clarity.  \\n","autoDesc":true}`);export{f as comp,b as data};
