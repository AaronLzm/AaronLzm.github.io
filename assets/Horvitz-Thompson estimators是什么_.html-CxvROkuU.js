import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as t,f as n,b as p}from"./app-Dqggp2hZ.js";const e={};function l(m,s){return p(),t("div",null,[...s[0]||(s[0]=[n('<h3 id="第一步-为什么要发明这个东西-发现问题" tabindex="-1"><a class="header-anchor" href="#第一步-为什么要发明这个东西-发现问题"><span>第一步：为什么要发明这个东西？（发现问题）</span></a></h3><p>想象你要调查一个村子里所有人的<strong>总收入</strong>。</p><p><strong>情况 A（简单模式）：</strong><br> 你搞了一个大抽奖箱，把村里每个人的名字写在一样大的纸条上。你闭着眼睛随便摸出 10 个人。<br> 这时候，每个人被抽到的概率是一样的（比如都是 10%）。<br> 那你只需要把这 10 个人的钱加起来，再乘以 10，大概就是全村的钱了。这叫简单随机抽样。</p><p><strong>情况 B（地狱模式 - 也就是现实）：</strong><br> 在这个村子里，有些人特别爱社交（比如村长、土豪），天天在广场上晃悠，你一出门就能撞见他们。<br> 有些人是社恐（比如宅男、隐士），常年躲在地窖里，你很难抓到他们。</p><p>如果你还是像傻瓜一样，出门撞见谁就问谁（抽样），然后直接算平均数，会发生什么？<br><strong>结果会严重偏颇！</strong> 你会采集到一大堆“爱社交的人”的数据，而那些“社恐”的声音被你忽略了。如果土豪爱社交，你的结果就会显示这个村子富得流油，但这不代表真实情况。</p><p><strong>Horvitz-Thompson 就是为了解决“每个人被抽到的概率不一样”这个问题的。</strong></p><hr><h3 id="第二步-怎么解决-核心直觉" tabindex="-1"><a class="header-anchor" href="#第二步-怎么解决-核心直觉"><span>第二步：怎么解决？（核心直觉）</span></a></h3><p>既然我们知道抽样是不公平的，那我们在算账的时候，就要<strong>把这种不公平“怼”回去</strong>。</p><p>核心逻辑只有一句话：<br><strong>谁越难被抽中，谁的一票就越值钱；谁越容易被抽中，谁的一票就越廉价。</strong></p><ul><li><strong>容易被抽中的人（概率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span></span> 很大）：</strong> 他代表不了多少人，因为像他这样的人满大街都是，我都采到了。所以，我要<strong>降低</strong>他的权重。</li><li><strong>很难被抽中的人（概率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span></span> 很小）：</strong> 比如那个躲在地窖里的宅男，我好不容易才抓到一个。这意味着由于概率低，可能还有 99 个像他一样的宅男我没抓到。所以，这一个宅男要代表那 99 个没出现的兄弟。我要<strong>通过加倍</strong>他的权重，让他发出巨大的声音。</li></ul><p>这叫 <strong>“倒数加权” (Inverse Probability Weighting)</strong>。</p><hr><h3 id="第三步-看公式-此时它已经不吓人了" tabindex="-1"><a class="header-anchor" href="#第三步-看公式-此时它已经不吓人了"><span>第三步：看公式（此时它已经不吓人了）</span></a></h3><p>假设：</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是你抓到的第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 个人的收入。</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\\pi_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 个人被抓到的概率（Incusion Probability）。</li></ul><p>普通的加法是：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>+</mo><msub><mi>y</mi><mn>2</mn></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">y_1 + y_2 + ...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.1056em;"></span><span class="mord">...</span></span></span></span> （这是错的，因为不公平）</p><p><strong>Horvitz-Thompson 的加法是：</strong></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mover accent="true"><mi>Y</mi><mo>^</mo></mover><mrow><mi>H</mi><mi>T</mi></mrow></msub><mo>=</mo><mo>∑</mo><mfrac><msub><mi>y</mi><mi>i</mi></msub><msub><mi>π</mi><mi>i</mi></msub></mfrac></mrow><annotation encoding="application/x-tex"> \\hat{Y}_{HT} = \\sum \\frac{y_i}{\\pi_i} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0968em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.9436em;vertical-align:-0.836em;"></span><span class="mop op-symbol large-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>也就是：<strong>（第1个人的钱 ÷ 他被抽中的概率）+ （第2个人的钱 ÷ 他被抽中的概率）...</strong></p><p><strong>我们来算个账你就懂了：</strong></p><ol><li><p><strong>遇见村长：</strong><br> 村长天天在外面，被抽中概率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo>=</mo><mn>1.0</mn></mrow><annotation encoding="application/x-tex">\\pi = 1.0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1.0</span></span></span></span> (100%)。<br> 他对总量的贡献 = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mtext>村长的钱</mtext><mn>1</mn></mfrac></mrow><annotation encoding="application/x-tex">\\frac{\\text{村长的钱}}{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2173em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">村长的钱</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>。<br><em>解释：除以1，权重不变。因为他就在那，他只代表他自己。</em></p></li><li><p><strong>遇见社恐宅男：</strong><br> 宅男很难找，被抽中概率只有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo>=</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">\\pi = 0.01</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.01</span></span></span></span> (1%)。<br> 他对总量的贡献 = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mtext>宅男的钱</mtext><mn>0.01</mn></mfrac></mrow><annotation encoding="application/x-tex">\\frac{\\text{宅男的钱}}{0.01}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2173em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0.01</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">宅男的钱</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> = <strong>宅男的钱 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>×</mo></mrow><annotation encoding="application/x-tex">\\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">×</span></span></span></span> 100</strong>。<br><em>解释：因为他只有 1% 的几率出现，所以我一旦抓住了他，我就默认还有 99 个像他一样的人没被抓到。所以我把他的钱乘以 100，让他代表那 100 个隐形的人。</em></p></li></ol><hr><h3 id="总结-horvitz-thompson-到底是什么" tabindex="-1"><a class="header-anchor" href="#总结-horvitz-thompson-到底是什么"><span>总结：Horvitz-Thompson 到底是什么？</span></a></h3><ol><li><strong>定义：</strong> 它是在<strong>不等概率抽样</strong>（Unequal Probability Sampling）下，用来估计总体总量（Total）或均值的一种方法。</li><li><strong>做法：</strong> 每一个样本的观测值，都要除以它<strong>被选中的概率</strong>。</li><li><strong>性质：</strong> 它是<strong>无偏</strong>（Unbiased）的。意思就是，只要你知道每个样本被选中的确切概率，用这个公式算出来的结果，长期来看是准确命中靶心的，不会偏左也不会偏右。</li></ol>',25)])])}const o=a(e,[["render",l]]),c=JSON.parse(`{"path":"/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%2012/Horvitz-Thompson%20estimators%E6%98%AF%E4%BB%80%E4%B9%88_.html","title":"Horvitz-Thompson estimators是什么？","lang":"en-US","frontmatter":{"title":"Horvitz-Thompson estimators是什么？","category":"Causal inference","tags":["Chapter 12","What-if book reading notes"],"description":"第一步：为什么要发明这个东西？（发现问题） 想象你要调查一个村子里所有人的总收入。 情况 A（简单模式）： 你搞了一个大抽奖箱，把村里每个人的名字写在一样大的纸条上。你闭着眼睛随便摸出 10 个人。 这时候，每个人被抽到的概率是一样的（比如都是 10%）。 那你只需要把这 10 个人的钱加起来，再乘以 10，大概就是全村的钱了。这叫简单随机抽样。 情况...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Horvitz-Thompson estimators是什么？\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-11-24T07:00:50.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Aaron L\\",\\"url\\":\\"https://aaronlzm.github.io\\",\\"email\\":\\"lzm_aaron@outlook.com\\"}]}"],["meta",{"property":"og:url","content":"https://aaronlzm.github.io/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%2012/Horvitz-Thompson%20estimators%E6%98%AF%E4%BB%80%E4%B9%88_.html"}],["meta",{"property":"og:site_name","content":"Aaron's Blog"}],["meta",{"property":"og:title","content":"Horvitz-Thompson estimators是什么？"}],["meta",{"property":"og:description","content":"第一步：为什么要发明这个东西？（发现问题） 想象你要调查一个村子里所有人的总收入。 情况 A（简单模式）： 你搞了一个大抽奖箱，把村里每个人的名字写在一样大的纸条上。你闭着眼睛随便摸出 10 个人。 这时候，每个人被抽到的概率是一样的（比如都是 10%）。 那你只需要把这 10 个人的钱加起来，再乘以 10，大概就是全村的钱了。这叫简单随机抽样。 情况..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-11-24T07:00:50.000Z"}],["meta",{"property":"article:tag","content":"What-if book reading notes"}],["meta",{"property":"article:tag","content":"Chapter 12"}],["meta",{"property":"article:modified_time","content":"2025-11-24T07:00:50.000Z"}]]},"git":{"createdTime":1763967650000,"updatedTime":1763967650000,"contributors":[{"name":"lizhimou","username":"lizhimou","email":"lizhimou@bytedance.com","commits":1,"url":"https://github.com/lizhimou"}]},"readingTime":{"minutes":3.33,"words":999},"filePathRelative":"posts/Causal inference/What-if book reading notes/Chapter 12/Horvitz-Thompson estimators是什么?.md","excerpt":"<h3>第一步：为什么要发明这个东西？（发现问题）</h3>\\n<p>想象你要调查一个村子里所有人的<strong>总收入</strong>。</p>\\n<p><strong>情况 A（简单模式）：</strong><br>\\n你搞了一个大抽奖箱，把村里每个人的名字写在一样大的纸条上。你闭着眼睛随便摸出 10 个人。<br>\\n这时候，每个人被抽到的概率是一样的（比如都是 10%）。<br>\\n那你只需要把这 10 个人的钱加起来，再乘以 10，大概就是全村的钱了。这叫简单随机抽样。</p>","autoDesc":true}`);export{o as comp,c as data};
