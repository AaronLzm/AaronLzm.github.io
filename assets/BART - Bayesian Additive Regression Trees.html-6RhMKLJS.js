import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as p,f as a,a as e,r as m,b as l}from"./app-ZrqzkeZK.js";const i={};function r(o,s){const t=m("Mermaid");return l(),p("div",null,[s[0]||(s[0]=a('<p>让我们分步拆解**贝叶斯加性回归树（BART, Bayesian Additive Regression Trees）**的核心机制与应用逻辑。以下解释将结合技术原理、数学表达和实际案例，尽可能还原其本质。</p><hr><h3 id="step-1-基础定义——bart是什么" tabindex="-1"><a class="header-anchor" href="#step-1-基础定义——bart是什么"><span><strong>Step 1: 基础定义——BART是什么？</strong></span></a></h3><blockquote><p><strong>核心定位</strong>：一种非参数贝叶斯回归方法，通过集成大量弱学习树（weak-learner trees）提升预测鲁棒性，特别适合处理非线性关系与异方差数据。</p></blockquote><p><strong>关键特性</strong>：</p><table><thead><tr><th>维度</th><th>说明</th></tr></thead><tbody><tr><td><strong>加性 (Additive)</strong></td><td>最终预测由M棵回归树的输出<strong>求和</strong>构成：<br> ( Y = \\sum_{m=1}^M g_m(\\mathbf{X}; \\mathcal{T}_m, \\mathcal{M}_m) + \\epsilon )<br> ➠ 每棵树(g_m)捕捉数据的不同模式</td></tr><tr><td><strong>贝叶斯 (Bayesian)</strong></td><td>为每棵树的<strong>结构</strong>（(\\mathcal{T}_m)）和<strong>叶节点参数</strong>（(\\mathcal{M}_m)）赋予先验分布，通过后验抽样拟合</td></tr><tr><td><strong>回归树 (Regression Trees)</strong></td><td>每棵树是CART（分类回归树）结构，但通过概率框架控制复杂度</td></tr></tbody></table><hr><h3 id="step-2-技术拆解——bart如何工作" tabindex="-1"><a class="header-anchor" href="#step-2-技术拆解——bart如何工作"><span><strong>Step 2: 技术拆解——BART如何工作？</strong></span></a></h3><h4 id="_2-1-单棵树的生成规则" tabindex="-1"><a class="header-anchor" href="#_2-1-单棵树的生成规则"><span><strong>2.1 单棵树的生成规则</strong></span></a></h4><p>一棵回归树(g_m)可表示为：<br> ( g_m(\\mathbf{X}) = \\mu_{m,l} )，其中 ( l ) 是输入 (\\mathbf{X}) 落入的叶节点<br> 叶节点值 (\\mu_{m,l}) 服从<strong>正态先验</strong>： (\\mu_{m,l} \\sim \\mathcal{N}(0, \\sigma_\\mu^2))</p><p><strong>复杂度控制</strong>（防过拟合）：</p><ul><li>树深度先验：P(分裂) ∝ α(1+d)^{-β} （d=当前深度）</li><li>默认设置：α=0.95, β=2 → 倾向生成浅树</li></ul><h4 id="_2-2-加性集成机制" tabindex="-1"><a class="header-anchor" href="#_2-2-加性集成机制"><span><strong>2.2 加性集成机制</strong></span></a></h4><p>对于M棵树（通常M=200），预测值为：<br> [ \\hat{Y} = \\sum_{m=1}^M g_m(\\mathbf{X}) ]<br><em>注：与随机森林（Random Forest）的区别——</em></p><table><thead><tr><th>BART</th><th>随机森林</th></tr></thead><tbody><tr><td><strong>贝叶斯平均</strong>：后验推断权重</td><td><strong>投票平均</strong>：等权重集成</td></tr><tr><td>树间<strong>强正则化</strong>（小(\\mu)先验）</td><td>树独立生长（无强约束）</td></tr></tbody></table><h4 id="_2-3-完整的概率图模型" tabindex="-1"><a class="header-anchor" href="#_2-3-完整的概率图模型"><span><strong>2.3 完整的概率图模型</strong></span></a></h4>',16)),e(t,{code:"eJxLL0osyFAIceFSAIJIjcgXy5uebe1+2rBHU0FX167m2drFzxoan+zZ87xlW43C+WaN882aYKXnm8HyT1s7Xq7qAcnEFxRl5hdpvGxoe9q78Nm0nU872p7ugCqOhJi1senppJ4n++a+2DqtRiGkKDXVUOPZgomGSGrAor4gUV+IaHFpEsSFz9esyX22eCtQBiwOAiC18bkQbfG5Gs93T342rwXIguhEU+ELVPG0f9uLrqbnTTvP7UFRBVEC90sI1CvR5zbqnNsUi1AINANFIdAYqEoDHWAAnNsDVZual8IFALORih8="}),s[1]||(s[1]=a('<hr><h3 id="step-3-贝叶斯推断——如何训练bart" tabindex="-1"><a class="header-anchor" href="#step-3-贝叶斯推断——如何训练bart"><span><strong>Step 3: 贝叶斯推断——如何训练BART？</strong></span></a></h3><p>采用<strong>MCMC算法</strong>（具体为Gibbs抽样），交替更新以下变量：</p><ol><li><strong>树结构(\\mathcal{T}_m)</strong>： <ul><li>通过&quot;生长-剪枝-交换-旋转&quot;操作扰动树形</li><li>接受概率由贝叶斯因子决定：<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi>P</mi><mo stretchy="false">(</mo><msubsup><mi mathvariant="script">T</mi><mi>m</mi><mtext>new</mtext></msubsup><mo>∣</mo><mi mathvariant="bold">Y</mi><mo stretchy="false">)</mo></mrow><mrow><mi>P</mi><mo stretchy="false">(</mo><msubsup><mi mathvariant="script">T</mi><mi>m</mi><mtext>old</mtext></msubsup><mo>∣</mo><mi mathvariant="bold">Y</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>P</mi><mo stretchy="false">(</mo><mi mathvariant="bold">Y</mi><mo>∣</mo><msubsup><mi mathvariant="script">T</mi><mi>m</mi><mtext>new</mtext></msubsup><mo stretchy="false">)</mo><mo>⋅</mo><mi>P</mi><mo stretchy="false">(</mo><msubsup><mi mathvariant="script">T</mi><mi>m</mi><mtext>new</mtext></msubsup><mo stretchy="false">)</mo></mrow><mrow><mi>P</mi><mo stretchy="false">(</mo><mi mathvariant="bold">Y</mi><mo>∣</mo><msubsup><mi mathvariant="script">T</mi><mi>m</mi><mtext>old</mtext></msubsup><mo stretchy="false">)</mo><mo>⋅</mo><mi>P</mi><mo stretchy="false">(</mo><msubsup><mi mathvariant="script">T</mi><mi>m</mi><mtext>old</mtext></msubsup><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex"> \\frac{P(\\mathcal{T}_m^{\\text{new}} \\mid \\mathbf{Y})}{P(\\mathcal{T}_m^{\\text{old}} \\mid \\mathbf{Y})} = \\frac{P(\\mathbf{Y} \\mid \\mathcal{T}_m^{\\text{new}}) \\cdot P(\\mathcal{T}_m^{\\text{new}})}{P(\\mathbf{Y} \\mid \\mathcal{T}_m^{\\text{old}}) \\cdot P(\\mathcal{T}_m^{\\text{old}})} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7751em;"><span style="top:-2.453em;margin-left:-0.2542em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">old</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbf" style="margin-right:0.02875em;">Y</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.453em;margin-left:-0.2542em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">new</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbf" style="margin-right:0.02875em;">Y</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.02875em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7751em;"><span style="top:-2.453em;margin-left:-0.2542em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">old</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7751em;"><span style="top:-2.453em;margin-left:-0.2542em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">old</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.02875em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.453em;margin-left:-0.2542em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">new</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.453em;margin-left:-0.2542em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">new</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p></li></ul></li><li><strong>叶节点值(\\mu_{m,l})</strong>：<br> 固定树结构时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mrow><mi>m</mi><mo separator="true">,</mo><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\\mu_{m,l}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> 的<strong>后验也是正态分布</strong>：<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>μ</mi><mrow><mi>m</mi><mo separator="true">,</mo><mi>l</mi></mrow></msub><mo>∣</mo><mo>⋯</mo><mo>∼</mo><mi mathvariant="script">N</mi><mrow><mo fence="true">(</mo><mfrac><mrow><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><msub><mi>S</mi><mi>l</mi></msub></mrow></munder><msub><mi>r</mi><mi>i</mi></msub></mrow><mrow><msup><mi>σ</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup><mo>+</mo><msub><mi>n</mi><mi>l</mi></msub><mo>⋅</mo><msubsup><mi>σ</mi><mi>μ</mi><mrow><mo>−</mo><mn>2</mn></mrow></msubsup></mrow></mfrac><mo separator="true">,</mo><mfrac><mn>1</mn><mrow><msup><mi>σ</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup><mo>+</mo><msubsup><mi>σ</mi><mi>μ</mi><mrow><mo>−</mo><mn>2</mn></mrow></msubsup></mrow></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\\mu_{m,l} \\mid \\cdots \\sim \\mathcal{N}\\left( \\frac{\\sum_{i \\in S_l} r_i}{\\sigma^{-2} + n_l \\cdot \\sigma_\\mu^{-2}}, \\frac{1}{\\sigma^{-2} + \\sigma_\\mu^{-2}} \\right) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.6147em;vertical-align:-1.0691em;"></span><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5456em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">μ</span></span></span><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.7956em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1786em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0576em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4056em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0691em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">μ</span></span></span><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0691em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span></span></p> （(S_l)=叶节点l的样本集，(r_i = Y_i - \\sum_{k \\neq m} g_k(\\mathbf{X}_i))为残差）</li><li><strong>噪声方差(\\sigma^2)</strong>：<br> 更新公式： (\\sigma^2 \\mid \\cdots \\sim \\text{Inv-Gamma}\\left( \\frac{\\nu_0 + n}{2}, \\frac{\\nu_0 \\lambda_0 + \\text{RSS}}{2} \\right))<br> （RSS = 残差平方和）</li></ol><blockquote><p><strong>为什么高效？</strong></p><ul><li>残差拟合：每棵树仅拟合其他树的<strong>残差</strong>（类似Boosting）</li><li>并行化：MCMC中可批量更新多棵树（软件如<code>bartMachine</code>实现此优化）</li></ul></blockquote><hr><h3 id="step-4-为什么bart适合因果推断-关联论文核心" tabindex="-1"><a class="header-anchor" href="#step-4-为什么bart适合因果推断-关联论文核心"><span><strong>Step 4: 为什么BART适合因果推断？</strong> （关联论文核心）</span></a></h3><h4 id="案例-估计处理效应-tau-e-y-1-y-0" tabindex="-1"><a class="header-anchor" href="#案例-估计处理效应-tau-e-y-1-y-0"><span><strong>案例：估计处理效应(\\tau = E[Y(1) - Y(0)])</strong></span></a></h4><p>假设数据：( \\mathbf{X} )为协变量，( Z )为处理指示（0/1），观测(Y = Z \\cdot Y(1) + (1-Z) \\cdot Y(0))</p><p><strong>BART实施步骤</strong>：</p><ol><li>分别拟合两个模型： <ul><li>处理组模型： ( Y \\mid \\mathbf{X}, Z=1 \\sim \\text{BART}_1(\\mathbf{X}) )</li><li>控制组模型： ( Y \\mid \\mathbf{X}, Z=0 \\sim \\text{BART}_0(\\mathbf{X}) )</li></ul></li><li>预测潜在结果： <ul><li>( \\hat{Y}_i(1) = \\text{BART}_1(\\mathbf{X}_i) )</li><li>( \\hat{Y}_i(0) = \\text{BART}_0(\\mathbf{X}_i) )</li></ul></li><li>计算个体处理效应：<br> [ \\hat{\\tau}_i = \\hat{Y}_i(1) - \\hat{Y}_i(0) ]</li></ol><p><strong>优势</strong>：</p><ul><li>自动捕获协变量与处理的<strong>复杂交互</strong>（如非线性/异质性效应）</li><li>通过后验分布给出<strong>不确定性量化</strong>：<br> ( P(\\tau &gt; 0 \\mid \\mathbf{X}) ) 直接由MCMC样本计算</li><li><strong>倾向得分作为输入</strong>：在(\\mathbf{X})中加入(\\hat{e}(\\mathbf{X}) = P(Z=1 \\mid \\mathbf{X}))，缓解混杂偏倚</li></ul><h4 id="论文关键例证-example-4-1" tabindex="-1"><a class="header-anchor" href="#论文关键例证-example-4-1"><span><strong>论文关键例证（Example 4.1）</strong></span></a></h4><ul><li><strong>问题</strong>：当协变量分布存在<strong>低重叠区</strong>（poor overlap，如X&lt;40），传统线性模型失效</li><li><strong>BART表现</strong>： <ol><li>在重叠区（40≤X≤50）给出无偏估计</li><li>在低重叠区（X&lt;40）可信区间（CrI）<strong>过窄</strong> → 低估不确定性（论文Fig.1）<br><em>启示：BART需与协变量平衡技术结合使用</em></li></ol></li></ul><hr><h3 id="step-5-bart的局限与改进方向" tabindex="-1"><a class="header-anchor" href="#step-5-bart的局限与改进方向"><span><strong>Step 5: BART的局限与改进方向</strong></span></a></h3><p>基于论文§4的批判：</p><ol><li><strong>正则化依赖先验</strong>： <ul><li>小(\\mu)先验迫使预测平滑 → 在极端区域（如协变量外推）预测偏差</li></ul></li><li><strong>不确定性低估问题</strong>： <ul><li>MCMC未考虑模型不确定性 → 可扩展为<strong>贝叶斯模型平均</strong>（BMA-BART）</li></ul></li><li><strong>计算开销</strong>： <ul><li>MCMC比boosting/RF慢 → 使用变分推断或GPU加速（如<code>XGBART</code>）</li></ul></li></ol><blockquote><p><strong>最新进展</strong>：</p><ul><li><strong>稀疏BART</strong>（Sparse BART）：引入变量选择先验</li><li><strong>半参数BART</strong>：混合参数模型（如处理效应线性）与非参数部分</li></ul></blockquote><hr><h3 id="本质总结" tabindex="-1"><a class="header-anchor" href="#本质总结"><span><strong>本质总结</strong></span></a></h3><p>BART是将<strong>集成学习</strong>（加法树）与<strong>贝叶斯推断</strong>（概率正则化）融合的框架：</p><ul><li><strong>预测</strong>：通过加性树结构逼近复杂函数</li><li><strong>推断</strong>：利用贝叶斯后验量化不确定性</li><li><strong>因果应用</strong>：双模型结构天然适配潜在结果框架，但需警惕<strong>协变量平衡</strong>要求</li></ul><p>它的强大在于：<strong>以概率语言包裹非参数模型</strong>，既保留灵活性又提供统计严谨性——这正是现代因果推断亟需的特性。</p><blockquote><p>详细解释：<a href="https://zhuanlan.zhihu.com/p/444501704" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/444501704</a></p></blockquote>',26))])}const g=n(i,[["render",r]]),d=JSON.parse(`{"path":"/posts/Causal%20inference/BART%20-%20Bayesian%20Additive%20Regression%20Trees.html","title":"BART - Bayesian Additive Regression Trees","lang":"en-US","frontmatter":{"title":"BART - Bayesian Additive Regression Trees","category":"Causal inference","tags":["Causal inference","posts"],"description":"让我们分步拆解**贝叶斯加性回归树（BART, Bayesian Additive Regression Trees）**的核心机制与应用逻辑。以下解释将结合技术原理、数学表达和实际案例，尽可能还原其本质。 Step 1: 基础定义——BART是什么？ 核心定位：一种非参数贝叶斯回归方法，通过集成大量弱学习树（weak-learner trees）提升...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"BART - Bayesian Additive Regression Trees\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-09-17T03:25:58.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Aaron L\\",\\"url\\":\\"https://aaronlzm.github.io\\",\\"email\\":\\"lzm_aaron@outlook.com\\"}]}"],["meta",{"property":"og:url","content":"https://aaronlzm.github.io/posts/Causal%20inference/BART%20-%20Bayesian%20Additive%20Regression%20Trees.html"}],["meta",{"property":"og:site_name","content":"Aaron's Blog"}],["meta",{"property":"og:title","content":"BART - Bayesian Additive Regression Trees"}],["meta",{"property":"og:description","content":"让我们分步拆解**贝叶斯加性回归树（BART, Bayesian Additive Regression Trees）**的核心机制与应用逻辑。以下解释将结合技术原理、数学表达和实际案例，尽可能还原其本质。 Step 1: 基础定义——BART是什么？ 核心定位：一种非参数贝叶斯回归方法，通过集成大量弱学习树（weak-learner trees）提升..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-09-17T03:25:58.000Z"}],["meta",{"property":"article:tag","content":"posts"}],["meta",{"property":"article:tag","content":"Causal inference"}],["meta",{"property":"article:modified_time","content":"2025-09-17T03:25:58.000Z"}]]},"git":{"createdTime":1758079145000,"updatedTime":1758079558000,"contributors":[{"name":"lizhimou","username":"lizhimou","email":"lizhimou@bytedance.com","commits":2,"url":"https://github.com/lizhimou"}]},"readingTime":{"minutes":4.73,"words":1418},"filePathRelative":"posts/Causal inference/BART - Bayesian Additive Regression Trees.md","excerpt":"<p>让我们分步拆解**贝叶斯加性回归树（BART, Bayesian Additive Regression Trees）**的核心机制与应用逻辑。以下解释将结合技术原理、数学表达和实际案例，尽可能还原其本质。</p>\\n<hr>\\n<h3><strong>Step 1: 基础定义——BART是什么？</strong></h3>\\n<blockquote>\\n<p><strong>核心定位</strong>：一种非参数贝叶斯回归方法，通过集成大量弱学习树（weak-learner trees）提升预测鲁棒性，特别适合处理非线性关系与异方差数据。</p>\\n</blockquote>","autoDesc":true}`);export{g as comp,d as data};
