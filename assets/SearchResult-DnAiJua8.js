import{h as N,u as Y,j as X,k as Z,l as ee,t as se,m as ae,n as w,p as W,q as e,s as te,v as ne,x as re,R as x,y as oe,z as ie,A as le,B as pe,C as he,D as Q,E as T,F as ce,G as me,H as de,o as ue,L as fe,I as Ce,J as ge,K as _e,M as z,N as ke,O as v}from"./app-BpbOdWWS.js";const Ee=["/","/intro.html","/zh/","/zh/intro.html","/posts/machine_learning/Resources.html","/posts/Causal%20inference/BART%20-%20Bayesian%20Additive%20Regression%20Trees.html","/posts/Causal%20inference/Bayesian%20causal%20inference_%20a%20critical%20review.html","/posts/Causal%20inference/%E5%9B%A0%E6%9E%9C%E6%8E%A8%E6%96%AD(Causal%20Inference)%E4%B8%8E%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0(Machine%20Learning).html","/zh/posts/notice.html","/posts/machine_learning/Bayesian/All%20bayesian%20inference%20methods.html","/posts/machine_learning/Bayesian/Bayes%20by%20backprop%20-%20naive%20variational%20inference.html","/posts/machine_learning/Bayesian/Difference%20between%20MCMC%20and%20VI(SVI).html","/posts/machine_learning/Bayesian/Laplace%20Approximation.html","/posts/machine_learning/Bayesian/Markov%20Chain%20Monte%20Carlo(MCMC).html","/posts/machine_learning/Bayesian/Prior%20Uncertainty%20-%20A%20Key%20Hurdle%20in%20Advancing%20Bayesian%20Machine%20Learning.html","/posts/machine_learning/Bayesian/Stochastic%20Variational%20Inference.html","/posts/machine_learning/Bayesian/What%20is%20uncertainty%20in%20neural%20networks.html","/posts/machine_learning/Bayesian/Why%20we%20are%20assuming%20all%20weight%20distributions%20are%20Gaussian.html","/posts/machine_learning/Bayesian/reparameter%20trick.html","/posts/machine_learning/CV/ViT.html","/posts/machine_learning/EBM/How%20to%20build%20EBMs.html","/posts/machine_learning/diffusers/How%20does%20diffusion%20model%20work.html","/posts/machine_learning/diffusers/What%20does%20the%20U-net%20do%20in%20diffusion%20models_.html","/posts/machine_learning/mathematics/KL%20Divergence%20in%20Variational%20Inference..html","/posts/machine_learning/mathematics/KL%20and%20JS%20divergence.html","/posts/machine_learning/mathematics/Norm%20%E8%8C%83%E6%95%B0.html","/posts/machine_learning/mathematics/Regularization%20for%20Deep%20Learning.html","/posts/machine_learning/mathematics/SVD.html","/posts/machine_learning/papers%20read/Bayesian%20LSTM.html","/posts/machine_learning/papers%20read/Global%20sparse%20momentum%20SGD.html","/posts/machine_learning/papers%20read/How%20to%20write%20%20literature%20review.html","/posts/machine_learning/reinforcement%20learning/RL%E7%9A%84%E4%B8%BB%E8%A6%81%E7%BB%93%E6%9E%84%E7%A7%8D%E7%B1%BB.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/%E5%9B%A0%E6%9E%9C%E6%8E%A8%E6%96%AD%E6%96%B9%E6%B3%95.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/%E5%9B%A0%E6%9E%9C%E6%8E%A8%E6%96%AD%E7%9B%AE%E5%89%8D%E6%A6%82%E5%BF%B5.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/%E6%B7%B7%E6%9D%82%E5%9B%A0%E5%AD%90.html","/posts/machine_learning/CV/DETR/Generally_%20DETR.html","/posts/machine_learning/CV/JEPA/I-JEPA%20and%20ViT.html","/posts/machine_learning/reinforcement%20learning/actor-critic/Mode%20Collapse_.html","/posts/machine_learning/reinforcement%20learning/actor-critic/How%20PPO%20improved%20on%20mode%20collapsing.html","/posts/machine_learning/trick_layers/Attention/mamba%E7%AE%97%E6%B3%95.html","/posts/machine_learning/trick_layers/Attention/multi%20head%20attention.html","/posts/machine_learning/trick_layers/Attention/self-attention%20%E8%87%AA%E6%B3%A8%E6%84%8F%E5%8A%9B.html","/posts/machine_learning/trick_layers/Attention/self-attention%E8%AF%A6%E7%BB%86%E8%AE%A1%E7%AE%97%E6%96%B9%E6%B3%95.html","/posts/machine_learning/trick_layers/Attention/%E5%8D%95%E5%A4%B4%20single%20head%20attention.html","/posts/machine_learning/trick_layers/Attention/%E5%8D%95%E5%A4%B4attention%20back%20propagation.html","/posts/machine_learning/trick_layers/transformers/Transformer%20it%20self.html","/posts/machine_learning/trick_layers/tricks/RMSNorm%E4%B8%BA%E4%BB%80%E4%B9%88%E6%9C%89%E6%95%88.html","/posts/machine_learning/trick_layers/tricks/layer%20normalization%20-%20batch%20normalization.html","/posts/machine_learning/trick_layers/tricks/%E6%97%8B%E8%BD%AC%E4%BD%8D%E7%BD%AE%E7%BC%96%E7%A0%81RoPE%E8%AF%A6%E8%A7%A3.html","/posts/machine_learning/trick_layers/tricks/%E7%9F%A5%E8%AF%86%E8%92%B8%E9%A6%8FKnowledge%20Distillation.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%201/Chapter%201%20by%20o3%20mini.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%201/Chapter%201.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%2012/Chapter%2012.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%2012/Horvitz-Thompson%20estimators%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%2013/Chapter%2013.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%2013/%E8%AF%A6%E7%BB%86%E8%A7%A3%E9%87%8A%E4%B8%80%E4%B8%8B%E6%A0%87%E5%87%86%E5%8C%96%E6%96%B9%E6%B3%95%20%E5%92%8C%E5%8F%82%E6%95%B0%E5%8C%96g%E5%85%AC%E5%BC%8F%E7%9A%84%E5%8E%9F%E7%90%86%E5%92%8C%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%E5%8F%8A%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%2014/Chapter%2014%20%E7%BB%93%E6%9E%84%E5%B5%8C%E5%A5%97%E6%A8%A1%E5%9E%8B(structural%20nested%20models).html","/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%2014/G%E4%BC%B0%E8%AE%A1%E6%AD%A5%E9%AA%A4.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%2014/%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3SNM%E4%B8%ADL%E7%9A%84%E4%BD%9C%E7%94%A8.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%2015/Chapter%2015.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%2016/Chapter%2016.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%2017/Chapter%2017.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%202/Chapter%202.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%202/%E6%AD%A3%E6%80%A7%E5%81%87%E8%AE%BE(Positivity%20Assumption)%20%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%203/Chapter%203%20summary.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%203/Chapter%203.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_1.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_10.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_11.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_12.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_13.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_14.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_15.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_16.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_17.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_18.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_19.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_2.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_20.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_21.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_22.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_23.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_3.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_4.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_5.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_6.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_7.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_8.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/Chapter_9.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/Chapter_1.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/Chapter_10.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/Chapter_11.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/Chapter_12.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/Chapter_13.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/Chapter_14.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/Chapter_15.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/Chapter_16.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/Chapter_17.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/Chapter_18.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/Chapter_19.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/Chapter_2.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/Chapter_20.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/Chapter_21.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/Chapter_22.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/Chapter_23.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/Chapter_3.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/Chapter_4.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/Chapter_5.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/Chapter_6.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/Chapter_7.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/Chapter_8.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/Chapter_9.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/Chapter_1.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/Chapter_10.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/Chapter_11.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/Chapter_12.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/Chapter_13.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/Chapter_14.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/Chapter_15.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/Chapter_16.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/Chapter_17.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/Chapter_18.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/Chapter_19.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/Chapter_2.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/Chapter_20.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/Chapter_21.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/Chapter_22.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/Chapter_23.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/Chapter_3.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/Chapter_4.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/Chapter_5.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/Chapter_6.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/Chapter_7.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/Chapter_8.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/Chapter_9.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/gpt-4.1/Chapter_1.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/gpt-4.1/Chapter_10.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/gpt-4.1/Chapter_11.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/gpt-4.1/Chapter_12.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/gpt-4.1/Chapter_13.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/gpt-4.1/Chapter_14.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/gpt-4.1/Chapter_15.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/gpt-4.1/Chapter_16.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/gpt-4.1/Chapter_17.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/gpt-4.1/Chapter_18.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/gpt-4.1/Chapter_19.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/gpt-4.1/Chapter_2.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/gpt-4.1/Chapter_20.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/gpt-4.1/Chapter_21.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/gpt-4.1/Chapter_22.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/gpt-4.1/Chapter_23.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/gpt-4.1/Chapter_3.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/gpt-4.1/Chapter_4.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/gpt-4.1/Chapter_5.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/gpt-4.1/Chapter_6.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/gpt-4.1/Chapter_7.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/gpt-4.1/Chapter_8.html","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/gpt-4.1/Chapter_9.html","/404.html","/posts/machine_learning/","/posts/","/posts/Causal%20inference/","/zh/posts/","/posts/machine_learning/Bayesian/","/posts/machine_learning/CV/","/posts/machine_learning/EBM/","/posts/machine_learning/diffusers/","/posts/machine_learning/mathematics/","/posts/machine_learning/papers%20read/","/posts/machine_learning/reinforcement%20learning/","/posts/Causal%20inference/What-if%20book%20reading%20notes/","/posts/machine_learning/CV/DETR/","/posts/machine_learning/CV/JEPA/","/posts/machine_learning/reinforcement%20learning/actor-critic/","/posts/machine_learning/trick_layers/Attention/","/posts/machine_learning/trick_layers/","/posts/machine_learning/trick_layers/transformers/","/posts/machine_learning/trick_layers/tricks/","/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%201/","/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%2012/","/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%2013/","/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%2014/","/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%2015/","/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%2016/","/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%2017/","/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%202/","/posts/Causal%20inference/What-if%20book%20reading%20notes/Chapter%203/","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528/","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-1st/","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/DeepSeek-R1-0528-2nd/","/posts/Causal%20inference/What-if%20book%20reading%20notes/response_md/gpt-4.1/","/category/","/category/machine-learning/","/category/causal-inference/","/zh/category/","/tag/","/tag/machine-learning/","/tag/causal-inference/","/tag/posts/","/tag/bayesian/","/tag/cv/","/tag/ebm/","/tag/diffusers/","/tag/mathematics/","/tag/papers-read/","/tag/reinforcement-learning/","/tag/what-if-book-reading-notes/","/tag/detr/","/tag/jepa/","/tag/actor-critic/","/tag/attention/","/tag/transformers/","/tag/tricks/","/tag/chapter-1/","/tag/chapter-12/","/tag/chapter-13/","/tag/chapter-14/","/tag/chapter-15/","/tag/chapter-16/","/tag/chapter-17/","/tag/chapter-2/","/tag/chapter-3/","/tag/deepseek-r1-0528/","/tag/response-md/","/tag/deepseek-r1-0528-1st/","/tag/deepseek-r1-0528-2nd/","/tag/gpt-4.1/","/zh/tag/","/article/","/zh/article/","/star/","/zh/star/","/timeline/","/zh/timeline/"],be="SLIMSEARCH_QUERY_HISTORY",g=z(be,[]),We=()=>{const{queryHistoryCount:n}=v;return{enabled:n>0,queryHistories:g,addQueryHistory:l=>{g.value=Array.from(new Set([l,...g.value.slice(0,n-1)]))},removeQueryHistory:l=>{g.value=[...g.value.slice(0,l),...g.value.slice(l+1)]}}},H=n=>Ee[n.id]+("anchor"in n?`#${n.anchor}`:""),ve="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:q}=v,_=z(ve,[]),ye=()=>({enabled:q>0,resultHistories:_,addResultHistory:i=>{{const l={link:H(i),display:i.display};"header"in i&&(l.header=i.header),_.value=[l,..._.value.slice(0,q-1)]}},removeResultHistory:i=>{_.value=[..._.value.slice(0,i),..._.value.slice(i+1)]}}),De=n=>{const{page:i,routeLocale:l}=ce(),y=me(),r=w(0),k=W(()=>r.value>0),c=de([]);return ue(()=>{const{search:D,terminate:u}=fe(),E=ge(f=>{const{resultsFilter:A=t=>t,querySplitter:C,suggestionsFilter:F,...o}=y.value;f?(r.value+=1,D(f,l.value,o).then(t=>A(t,f,l.value,i.value)).then(t=>{r.value-=1,c.value=t}).catch(t=>{console.warn(t),r.value-=1,r.value||(c.value=[])})):c.value=[]},v.searchDelay-v.suggestDelay,{maxWait:5e3});Ce([n,l],([f])=>E(f.join(" "))),_e(()=>{u()})}),{isSearching:k,results:c}};var Be=N({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(n,{emit:i}){const l=Y(),y=X(),r=Z(ee),{addQueryHistory:k,queryHistories:c,removeQueryHistory:D}=We(),{resultHistories:u,addResultHistory:E,removeResultHistory:f}=ye(),A=se(n,"queries"),{results:C,isSearching:F}=De(A),o=ae({isQuery:!0,index:0}),t=w(0),m=w(0),L=W(()=>c.value.length>0||u.value.length>0),B=W(()=>C.value.length>0),R=W(()=>C.value[t.value]||null),V=()=>{const{isQuery:s,index:a}=o;a===0?(o.isQuery=!s,o.index=s?u.value.length-1:c.value.length-1):o.index=a-1},I=()=>{const{isQuery:s,index:a}=o;a===(s?c.value.length-1:u.value.length-1)?(o.isQuery=!s,o.index=0):o.index=a+1},P=()=>{t.value=t.value>0?t.value-1:C.value.length-1,m.value=R.value.contents.length-1},$=()=>{t.value=t.value<C.value.length-1?t.value+1:0,m.value=0},j=()=>{m.value<R.value.contents.length-1?m.value+=1:$()},G=()=>{m.value>0?m.value-=1:P()},S=s=>s.map(a=>ke(a)?a:e(a[0],a[1])),U=s=>{if(s.type==="customField"){const a=pe[s.index]||"$content",[d,p=""]=he(a)?a[y.value].split("$content"):a.split("$content");return s.display.map(h=>e("div",S([d,...h,p])))}return s.display.map(a=>e("div",S(a)))},b=()=>{t.value=0,m.value=0,i("updateQuery",""),i("close")},J=()=>e("div",{class:"slimsearch-records"},e("div",{class:"slimsearch-record"},[e("div",{class:"slimsearch-record-title"},r.value.queryHistory),e("ul",{class:"slimsearch-record-contents",role:"listbox"},c.value.map((s,a)=>{const d=o.isQuery&&o.index===a;return e("li",{class:["slimsearch-record-matches",{active:d}],role:"option","aria-selected":d,onClick:()=>{i("updateQuery",s)}},e("div",[e(Q,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},s),e("button",{type:"button",class:"slimsearch-remove-icon",title:r.value.remove,"aria-label":r.value.remove,innerHTML:T,onClick:p=>{p.preventDefault(),p.stopPropagation(),D(a)}})]))}))])),K=()=>e("ul",{class:"slimsearch-records"},e("li",{class:"slimsearch-record"},[e("div",{class:"slimsearch-record-title"},r.value.resultHistory),e("ul",{class:"slimsearch-record-contents",role:"listbox"},u.value.map((s,a)=>{const d=!o.isQuery&&o.index===a;return e("li",{class:["slimsearch-record-matches",{active:d}],role:"option","aria-selected":d},e(x,{to:s.link,onClick:()=>{b()}},()=>[e(Q,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},[s.header?e("div",{class:"slimsearch-record-content-header"},s.header):null,e("div",s.display.map(p=>S(p)).flat())]),e("button",{type:"button",class:"slimsearch-remove-icon",title:r.value.remove,"aria-label":r.value.remove,innerHTML:T,onClick:p=>{p.preventDefault(),p.stopPropagation(),f(a)}})]))}))]));return te("keydown",s=>{if(n.isFocusing){if(B.value){if(s.key==="ArrowUp")G();else if(s.key==="ArrowDown")j();else if(s.key==="Enter"){const a=R.value.contents[m.value];k(n.queries.join(" ")),E(a),l.push(H(a)),b()}}else if(s.key==="ArrowUp")V();else if(s.key==="ArrowDown")I();else if(s.key==="Enter"){const{index:a}=o;o.isQuery?(s.preventDefault(),i("updateQuery",c.value[a])):(l.push(u.value[a].link),b())}}}),ne([t,m],()=>{document.querySelector(".slimsearch-record.active .slimsearch-record-matches.active")?.scrollIntoView(!1)},{flush:"post"}),()=>e("div",{id:"slimsearch-results",class:["slimsearch-result-wrapper",{empty:n.queries.length?!B.value:!L.value}]},n.queries.length?F.value?e(re,{hint:r.value.searching}):B.value?e("div",{class:"slimsearch-records",role:"listbox","aria-labeledby":"slimsearch-label"},C.value.map(({title:s,contents:a},d)=>{const p=t.value===d;return e("div",{class:["slimsearch-record",{active:p}],role:"group","aria-selected":p},[e("div",{class:"slimsearch-record-title"},s||r.value.defaultTitle),e("ul",{class:"slimsearch-record-contents"},a.map((h,O)=>{const M=p&&m.value===O;return e("li",{class:["slimsearch-record-matches",{active:M}],role:"option","aria-selected":M},e(x,{to:H(h),onClick:()=>{k(n.queries.join(" ")),E(h),b()}},()=>[h.type==="text"?null:e(h.type==="title"?oe:h.type==="heading"?ie:le,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},[h.type==="text"&&h.header?e("div",{class:"slimsearch-record-content-header"},h.header):null,e("div",U(h))])]))}))])})):r.value.emptyResult:L.value?[J(),K()]:r.value.emptyHistory)}});export{Be as default};
